{"remainingRequest":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ponnipa/Documents/GitHub/fda-frontend/src/components/ReportTax.vue?vue&type=style&index=0&id=7ba41430&scoped=true&lang=css&","dependencies":[{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/src/components/ReportTax.vue","mtime":1678265048654},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/css-loader/dist/cjs.js","mtime":1687492401554},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1687492401892},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/postcss-loader/src/index.js","mtime":1687492401651},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1687492401267},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/vue-loader/lib/index.js","mtime":1687492401738}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaDMgewogIG1hcmdpbjogNDBweCAwIDA7Cn0KdWwgewogIGxpc3Qtc3R5bGUtdHlwZTogbm9uZTsKICBwYWRkaW5nOiAwOwp9CmxpIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgbWFyZ2luOiAwIDEwcHg7Cn0KYSB7CiAgY29sb3I6ICM0MmI5ODM7Cn0K"},{"version":3,"sources":["ReportTax.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4kBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReportTax.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"hello mt-5\">\n    <div class=\"row\">\n      <div class=\"col-6\">\n        <label for=\"exampleInputEmail1\" class=\"form-label\">วันเริ่มต้น</label>\n        <input id=\"start_date\" class=\"form-control\" />\n        <!-- <input\n          @change=\"changeyearstart\"\n          v-model=\"startdate\"\n          type=\"date\"\n          class=\"form-control\"\n          id=\"exampleInputEmail1\"\n          aria-describedby=\"emailHelp\"\n        /> -->\n      </div>\n      <div class=\"col-6\">\n        <label for=\"exampleInputEmail1\" class=\"form-label\">วันสิ้นสุด</label>\n        <input id=\"end_date\" class=\"form-control\" />\n        <!-- <input\n          @change=\"changeyearend\"\n          v-model=\"enddate\"\n          type=\"date\"\n          class=\"form-control\"\n          id=\"exampleInputEmail1\"\n          aria-describedby=\"emailHelp\"\n        /> -->\n      </div>\n      <div class=\"col-12 mb-3\" align=\"center\">\n        <button\n          @click=\"search()\"\n          type=\"submit\"\n          class=\"btn btn-success\"\n          style=\"margin-top: 10px; text-align: right\"\n        >\n          ค้นหา\n        </button>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <table class=\"table table-bordered\">\n          <thead>\n            <tr>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                วันที่\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                รายการสินค้า\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                ดีกรี\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                ขนาดบรรจุ (ลิตร)\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                จำนวน (ดวง)\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                ปริมาณน้ำสุรา (ลิตร)\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                ราคาขายปลีกแนะนำ\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                ภาษีสุรา (บาท)\n              </th>\n              <th\n                scope=\"col\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #deebf7;\n                \"\n              >\n                ภาษีสุทธิ (บาท)\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(l, i) in list\" :key=\"i\">\n              <td style=\"text-align: center; background-color: #eaeef7\">\n                {{ l.tax_payment_date }}\n              </td>\n              <td style=\"text-align: center; background-color: #eaeef7\">\n                {{ l.brand_name }}\n              </td>\n              <td style=\"text-align: right; background-color: #eaeef7\">\n                {{ l.degree }}\n              </td>\n              <td style=\"text-align: right; background-color: #eaeef7\">\n                {{ l.size }}\n              </td>\n              <td style=\"text-align: right; background-color: #eaeef7\">\n                {{ l.number }}\n              </td>\n              <td style=\"text-align: right; background-color: #eaeef7\">\n                {{ l.volume_liquor }}\n              </td>\n              <td style=\"text-align: right; background-color: #eaeef7\">\n                {{ l.per_each }}\n              </td>\n              <td style=\"text-align: right; background-color: #eaeef7\">\n                {{ numberWithCommas(l.net) + \".00\" }}\n              </td>\n              <td\n                v-if=\"l.net_tax\"\n                style=\"text-align: right; background-color: #eaeef7\"\n              >\n                {{ numberWithCommas(l.net_tax) + \".00\" }}\n              </td>\n              <td\n                v-if=\"!l.net_tax\"\n                style=\"text-align: right; background-color: #eaeef7\"\n              ></td>\n            </tr>\n            <tr>\n              <td\n                colspan=\"4\"\n                style=\"\n                  font-weight: bold;\n                  text-align: center;\n                  background-color: #eaeef7;\n                \"\n              >\n                รวมทั้งสิ้น\n              </td>\n              <td\n                style=\"\n                  font-weight: bold;\n                  text-align: right;\n                  background-color: #eaeef7;\n                \"\n              >\n                {{ numberWithCommas(sumnumber) }}\n              </td>\n              <td\n                style=\"\n                  font-weight: bold;\n                  text-align: right;\n                  background-color: #eaeef7;\n                \"\n              >\n                {{ numberWithCommas(sumvolume) }}\n              </td>\n              <td\n                style=\"\n                  font-weight: bold;\n                  text-align: right;\n                  background-color: #eaeef7;\n                \"\n              >\n                <!-- {{ numberWithCommas(sumpereach) }} -->\n              </td>\n              <td\n                style=\"\n                  font-weight: bold;\n                  text-align: right;\n                  background-color: #eaeef7;\n                \"\n              >\n                {{ numberWithCommas(sumtax) }}\n              </td>\n              <td\n                style=\"\n                  font-weight: bold;\n                  text-align: right;\n                  background-color: #eaeef7;\n                \"\n              >\n                {{ numberWithCommas(sumnettax) + \".00\" }}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n  <script src=\"https://api-sbpacdb.ponnipa.in.th/picker_date.js\"></script>\n\n<script>\nimport MergeLiquorReportService from \"../services/MergeLiquorReportService.js\";\n\nexport default {\n  name: \"HelloWorld\",\n  data() {\n    return {\n      sumnumber: 0,\n      sumvolume: 0,\n      sumtax: 0,\n      list: [],\n      itemPreviewImage: \"\",\n      id: \"\",\n      item: [],\n      img: \"\",\n      image: \"\",\n      net_tax: [],\n      startdate: \"\",\n      enddate: \"\",\n      factory_code: \"\",\n      monthcurrent: \"\",\n      yearcurrent: \"\",\n      sumpereach: 0,\n      sumnettax: 0,\n    };\n  },\n  computed: {},\n  mounted() {\n    const d = new Date();\n    this.monthcurrent = parseInt(d.getMonth());\n    this.yearcurrent = parseInt(d.getFullYear() + 543);\n    picker_date(document.getElementById(\"start_date\"), { year_range: \"-12:+10\" });\n    picker_date(document.getElementById(\"end_date\"), { year_range: \"-12:+10\" });\n    // console.log(this.$route.params.id);\n    this.factory_code = this.$route.params.id;\n    this.loaddata();\n    const now = new Date();\n    const lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n\n    this.startdate = this.yearcurrent-1 + \"-10-01\";\n    if ((this.monthcurrent + 1).toString().length == 1) {\n      this.enddate =\n        this.yearcurrent +\n        \"-0\" +\n        parseInt(this.monthcurrent + 1) +\n        \"-\" +\n        lastDay.getDate();\n    } else {\n      this.enddate =\n        this.yearcurrent +\n        \"-\" +\n        parseInt(this.monthcurrent + 1) +\n        \"-\" +\n        lastDay.getDate();\n    }\n      document.getElementById(\"start_date\").value = this.getdate(this.startdate)\n      document.getElementById(\"end_date\").value = this.getdate(this.enddate)\n\n  },\n  methods: {\n     getdate(value) {      \n    var date = new Date(value);\n    // console.log(date);\n    var day = date.getDate();\n    var month = date.getMonth() + 1;\n    var year = date.getFullYear();\n    // console.log(day,month,year);\n    if (day.toString().length == 1) {\n      day = \"0\" + day;\n    }\n    if (month.toString().length == 1) {\n      month = \"0\" + month;\n    }\n    return  day+ \"/\"+month + \"/\" + year;\n  },\n    changeyearend() {\n      var m = this.enddate.substring(0, 2);\n      if (m == 20) {\n        var end = new Date(this.enddate);\n        var year = this.enddate.substring(0, 4);\n        var day = end.getDate();\n        var month = end.getMonth() + 1;\n        if (day.toString().length == 1) {\n          day = \"0\" + day;\n        }\n        if (month.toString().length == 1) {\n          month = \"0\" + month;\n        }\n        var c = parseInt(year) + 543 + \"-\" + month + \"-\" + day;\n        // console.log(c);\n        this.enddate = c;\n      }\n    },\n    changeyearstart() {\n      var m = this.startdate.substring(0, 2);\n      if (m == 20) {\n        var start = new Date(this.startdate);\n        var years = this.startdate.substring(0, 4);\n        var days = start.getDate();\n        var months = start.getMonth() + 1;\n        if (days.toString().length == 1) {\n          days = \"0\" + days;\n        }\n        if (months.toString().length == 1) {\n          months = \"0\" + months;\n        }\n        var cu = parseInt(years) + 543 + \"-\" + months + \"-\" + days;\n        this.startdate = cu;\n      }\n    },\n    createddate(value) {   \n  var streetaddress = String(value);\n    var d = streetaddress.substring(0, streetaddress.indexOf(\"/\"));\n    var m = streetaddress.substring(5, streetaddress.indexOf(\"/\"));\n    m = m.substring(1, 3);\n    var y = streetaddress.substring(5);\n    var full = m + \"/\" + d + y;\n    // console.log(full);\n    var date = new Date(full);\n    // console.log(date);\n    var day = date.getDate();\n    var month = date.getMonth()+1;\n    var year = date.getFullYear();\n    if (day.toString().length == 1) {\n      day = \"0\" + day;\n    }\n    if (month.toString().length == 1) {\n      month = \"0\" + month;\n    }\n    return  year + \"-\" + month + \"-\" + day;\n  },\n    search() {\n      this.startdate = this.createddate(document.getElementById(\"start_date\").value);\n      this.enddate = this.createddate(document.getElementById(\"end_date\").value);\n      // console.log(this.enddate);\n      // console.log(this.startdate);\n      // var startdate = this.convertdatesort(this.startdate);\n      // var enddate = this.convertdatesort(this.enddate);\n      MergeLiquorReportService.getMergeLiquorReportByCode(\n        this.factory_code,\n        this.startdate,\n        this.enddate\n      ).then((res) => {\n        this.list = [];\n        // console.log(res.data);\n        for (let i = 0; i < res.data.length; i++) {\n          // if (res.data[i].factory_code == res.data[i - 1].factory_code) {\n          // sum_net_tax = res.data[i].net + res.data[i - 1].net;\n          // }\n          this.list.push({\n            tax_payment_date: this.convertdatetothai(\n              res.data[i].tax_payment_date\n            ),\n            no: res.data[i].no,\n            factory_code: res.data[i].factory_code,\n            brand_name: res.data[i].brand_name + '-'+res.data[i].degree+ '-'+res.data[i].size,\n            number: res.data[i].number,\n            degree: res.data[i].degree,\n            size: res.data[i].size,\n            per_each: res.data[i].per_each,\n            volume_liquor: res.data[i].volume_liquor,\n            net: this.cal(\n              res.data[i].factory_code,\n              res.data[i].number,\n              res.data[i].per_each,\n              res.data[i].degree,\n              res.data[i].size\n            ),\n            net_tax: res.data[i].net_tax,\n            colour: \"table-success\",\n          });\n        }\n        this.cal_net_tax();\n      });\n    },\n    convertdatesort(date) {\n      var streetaddress = String(date);\n      // console.log(streetaddress);\n      var y = streetaddress.substring(0, streetaddress.indexOf(\"-\"));\n      var m = streetaddress.substring(7, streetaddress.indexOf(\"-\"));\n      m = m.substring(1, 3);\n      var d = streetaddress.substring(8, 10);\n      y = parseInt(y) + 543;\n      var full = y + \"-\" + m + \"-\" + d;\n      // console.log(d)\n      // console.log(m)\n      // console.log(y);\n      // console.log(full);\n      // var timestamp = Date.parse(full);\n      // var dateObject = new Date(timestamp);\n      // dateObject.setDate(dateObject.getDate() + 1);\n      // console.log(dateObject);\n      // const result = dateObject.toLocaleDateString(\"en-EN\");\n      // console.log(result);\n      return full;\n    },\n    loaddata() {\n      const now = new Date();\n      const lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n      MergeLiquorReportService.getMergeLiquorReportByCode(\n        this.factory_code,\n        String(this.yearcurrent-1 + \"-10-01\"),\n        String(\n          this.yearcurrent +\n            \"-\" +\n            parseInt(this.monthcurrent + 1) +\n            \"-\" +\n            lastDay.getDate()\n        )\n      )\n        .then((res) => {\n          // console.log(res.data);\n          // this.list = res.data;\n          // var sum_net_tax = 0;\n          for (let i = 0; i < res.data.length; i++) {\n            // if (res.data[i].factory_code == res.data[i - 1].factory_code) {\n            // sum_net_tax = res.data[i].net + res.data[i - 1].net;\n            // }\n            this.list.push({\n              tax_payment_date: this.convertdatetothai(\n                res.data[i].tax_payment_date\n              ),\n              no: res.data[i].no,\n              factory_code: res.data[i].factory_code,\n              brand_name: res.data[i].brand_name + '-'+res.data[i].degree+ '-'+res.data[i].size,\n              number: res.data[i].number,\n              degree: res.data[i].degree,\n              size: res.data[i].size,\n              per_each: res.data[i].per_each,\n              volume_liquor: res.data[i].volume_liquor,\n              net: this.cal(\n                res.data[i].factory_code,\n                res.data[i].number,\n                res.data[i].per_each,\n                res.data[i].degree,\n                res.data[i].size\n              ),\n              net_tax: res.data[i].net_tax,\n              colour: \"table-success\",\n              type: res.data[i].type,\n            });\n          }\n          this.cal_net_tax();\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n    },\n    cal_net_tax() {\n      // for (let i = 0; i < this.list.length; i++) {\n      //   if (i != 0) {\n      //     if (\n      //       this.list[i].tax_payment_date == this.list[i - 1].tax_payment_date\n      //     ) {\n      //       // console.log(\"i\", this.list[i].net);\n      //       // console.log(this.list[i -1].net);\n      //       this.list[i - 1].net_tax = Math.floor(\n      //         parseFloat(this.list[i].net) + parseFloat(this.list[i - 1].net)\n      //       ).toFixed(2);\n      //     } else {\n      //       this.list[i].net_tax = Math.floor(\n      //         parseFloat(this.list[i].net)\n      //       ).toFixed(2);\n      //     }\n      //   } else {\n      //     this.list[i].net_tax = Math.floor(\n      //       parseFloat(this.list[i].net)\n      //     ).toFixed(2);\n      //   }\n      // }\n\n      this.total();\n    },\n    cal(factory_code, number, per_each, degree, size) {\n      var x1 = 0;\n      var x2 = 0;\n      var x3 = 0;\n      var x4 = 0;\n      if (factory_code == 540002) {\n        x1 = ((10 * number) / 100) * per_each;\n        // console.log(x1);\n        // var x2 = ((155*30)/100)*0.63*1500;\n        x2 = ((150 * degree) / 100) * size * number;\n        // console.log(x2);\n        return (x1 + x2).toFixed(2);\n      } else {\n        x3 = ((2 * number) / 100) * per_each;\n        // console.log(x1);\n        // var x2 = ((155*30)/100)*0.63*1500;\n        x4 = ((155 * degree) / 100) * size * number;\n        // console.log(x2);\n        return (x3 + x4).toFixed(2);\n      }\n    },\n    convertdatetothai(datetimes) {\n      if (datetimes) {\n        var d = new Date(datetimes);\n        var mm = d.getMonth() + 1;\n        var dd = d.getDate();\n        var yy = d.getFullYear();\n\n        var myDateString = dd + \"/\" + mm + \"/\" + yy; //(US)\n        // console.log(myDateString);\n        return myDateString;\n      }\n    },\n    numberWithCommas(x) {\n      var r = 0;\n      x = parseInt(x);\n      if (isNaN(x)) {\n        r = \"\";\n      } else {\n        r = x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n      }\n      return r;\n    },\n    groupBy(array, key) {\n      const result = {};\n      array.forEach((item) => {\n        if (!result[item[key]]) {\n          result[item[key]] = [];\n        }\n        result[item[key]].push(item);\n      });\n      return result;\n    },\n    total() {\n      \n      this.sumnumber = 0\nthis.sumvolume = 0\nthis.sumpereach = 0\nthis.sumtax = 0\nthis.sumnettax = 0\n      // console.log(this.list);\n      for (let l = 0; l < this.list.length; l++) {\n        this.sumnumber = this.sumnumber + this.list[l].number;\n        this.sumvolume = this.sumvolume + this.list[l].volume_liquor;\n        this.sumpereach = this.sumvolume + this.list[l].per_each;\n        this.sumtax = this.sumtax + parseInt(this.list[l].net);\n        if (this.list[l].net_tax) {\n          this.sumnettax = this.sumnettax + parseFloat(this.list[l].net_tax);\n        }\n      }\n    },\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh3 {\n  margin: 40px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n</style>\n"]}]}