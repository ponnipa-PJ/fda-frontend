{"remainingRequest":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ponnipa/Documents/GitHub/fda-frontend/src/components/product.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/src/components/product.vue","mtime":1701154765696},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1687492401267},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/babel-loader/lib/index.js","mtime":1687492401655},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1687492401267},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/vue-loader/lib/index.js","mtime":1687492401738}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7Ci8vIGltcG9ydCBQcm9kdWN0c1NlcnZpY2UgZnJvbSAnLi4vc2VydmljZXMvUHJvZHVjdHNTZXJ2aWNlLmpzJwppbXBvcnQgRGljdFNlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvRGljdFNlcnZpY2UiOwppbXBvcnQgUnVsZUJhc2VkU2VydmljZSBmcm9tICIuLi9zZXJ2aWNlcy9SdWxlQmFzZWRTZXJ2aWNlIjsKaW1wb3J0IE1hcFJ1bGVCYXNlZFNlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvTWFwUnVsZUJhc2VkU2VydmljZSI7CmltcG9ydCBMaW5rU2VydmljZSBmcm9tICIuLi9zZXJ2aWNlcy9MaW5rU2VydmljZSI7CmltcG9ydCBBZHZlcnRpc2VTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL0FkdmVydGlzZVNlcnZpY2UiOwppbXBvcnQgS2V5d29yZFNlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvS2V5d29yZFNlcnZpY2UiOwppbXBvcnQgRkRBVHlwZXNTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL0ZEQVR5cGVzU2VydmljZSI7CmltcG9ydCBQcm9kdWN0c1NlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvUHJvZHVjdHNTZXJ2aWNlIjsKaW1wb3J0IENsaXBMb2FkZXIgZnJvbSAndnVlLXNwaW5uZXIvc3JjL0NsaXBMb2FkZXIudnVlJwppbXBvcnQgTWFwUnVsZUJhc2VkVXNlclNlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvTWFwUnVsZUJhc2VkVXNlclNlcnZpY2UiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBcHAiLAogIGNvbXBvbmVudHM6IHsKICAgIENsaXBMb2FkZXIKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzdGF0dXNwcm9jaGVjazpmYWxzZSwKICAgICAgc3RhdHVzbGlzdDpmYWxzZSwKICAgICAgc3RhdHVzcHJvZHVjdDpmYWxzZSwKICAgICAgc3RhdHVzcHJvY2hlY2tvbmU6ZmFsc2UsCiAgICAgIGNvbG9yOiAnIzViYzBkZScsCiAgICAgIHNpemU6ICc1MHB4JywKICAgICAgbWFyZ2luOiAnMnB4JywKICAgICAgcmFkaXVzOiAnMnB4JywKICAgICAgbG9hZGluZzp0cnVlLAogICAgICBsaXN0OiBbXSwKICAgICAgdXJsOiAiIiwKICAgICAgZmlsZTogIiIsCiAgICAgIHN0YXR1czogZmFsc2UsCiAgICAgIHVybFBhdGg6ICIiLAogICAgICBpbWFnZWxpc3RzOiAiIiwKICAgICAgdG9rZW5pemU6ICIiLAogICAgICBtYXRjaG5hbWU6ICIiLAogICAgICBtYXRjaGNhdGVnb3J5OiAiIiwKICAgICAgdHlwZTogIiIsCiAgICAgIG1hdGNobmFtZXN1bTogIiIsCiAgICAgIHN0YXR1c25hbWU6IDAsCiAgICAgIHN0YXR1c2NhdDogMCwKICAgICAgc3RhdHVzZmRhOiAwLAogICAgICBjb2xvcm5hbWU6ICJiYWNrZ3JvdW5kLWNvbG9yOiNmOWJkYmIiLAogICAgICBjb2xvcmZkYTogImJhY2tncm91bmQtY29sb3I6I2Y5YmRiYiIsCiAgICAgIGNvbG9yY2F0OiAiYmFja2dyb3VuZC1jb2xvcjojZjliZGJiIiwKICAgICAgaWQ6ICIiLAogICAgICBrZXl3b3JkOiBbXSwKICAgICAgY29sb3JrZXk6ICJiYWNrZ3JvdW5kLWNvbG9yOiNmOWJkYmIiLAogICAgICBkZXNjOiAiIiwKICAgICAgYXJyTGlzdDogW10sCiAgICAgIGFsbGRhdGE6IDAsCiAgICAgIGJhY2s6IDAsCiAgICAgIG5leHQ6IDAsCiAgICAgIGRhdGE6IHt9LAogICAgICBwcm9kdWN0X3Rva2VuOiAwLAogICAgICB0aXRsZTogIuC5gOC4nuC4tOC5iOC4oSBrZXl3b3JkIiwKICAgICAga2V5OiB7fSwKICAgICAgZmRhOiAiIiwKICAgICAgcHJvZHVjdDogW10sCiAgICAgIHByb2NoZWNrOiBbXSwKICAgICAgYW5zd2VyOicnLAogICAgICB0eXBlSWQ6MCwKICAgICAgcHJvY2hlY2t0ZXh0OicnLAogICAgICBkZXRhaWw6e30KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgY3VycmVudFVzZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnVzZXI7CiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgZ2V0c2VudGVudChkYXRhKXsKICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSkKICAgICAgLy8gdmFyIHRleHQgPSAnJwogICAgICB2YXIgYXJyID1bXQogICAgICBmb3IgKGxldCBkID0gMDsgZCA8IGRhdGEubGVuZ3RoOyBkKyspIHsKICAgICAgICAvLyB0ZXh0ICs9IGRhdGFbZF0KICAgICAgICBhcnIucHVzaChkYXRhW2RdKQogICAgICB9CiAgICAgIC8vIGNvbnNvbGUubG9nKGFycik7CiAgICAgIHZhciBhcnJ0eHQgPSBTdHJpbmcoYXJyKQogICAgICAvLyBjb25zb2xlLmxvZyhhcnJ0eHQpOwogICAgICBhcnJ0eHQgPSBhcnJ0eHQucmVwbGFjZUFsbCgiLCIsIjxzcGFuIHN0eWxlPSdjb2xvcjpyZWQ7Jz4gfCA8L3NwYW4+IikKICAgICAgLy8gY29uc29sZS5sb2coYXJydHh0KTsKcmV0dXJuIGFycnR4dAogICAgfSwKICAgIGdldHN0YXR1c2NoZWNrKHQsZil7CiAgICAgIC8vIGNvbnNvbGUubG9nKHQsZik7CiAgICAgIHZhciB0ZXh0ID0gJycKaWYgKHQgPT0gZikgewogIHRleHQgPSAn4LmA4LiB4Li04LiZ4LiI4Lij4Li04LiHJwp9ZWxzZSBpZiAodCA+IGYpIHsKICB0ZXh0ID0gJ+C5gOC4geC4tOC4meC4iOC4o+C4tOC4hycKfWVsc2UgaWYgKGYgPiB0KSB7CiAgdGV4dCA9ICfguYTguKHguYjguYDguIHguLTguJnguIjguKPguLTguIcnCn0KcmV0dXJuIHRleHQKICAgIH0sCiAgICBjbGVhcigpIHsKICAgICAgdGhpcy5kYXRhID0gW107CiAgICAgIHRoaXMucHJvZHVjdCA9IFtdOwogICAgICB0aGlzLnByb2NoZWNrID0gW107CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB0aGlzLnN0YXR1cyA9IGZhbHNlCiAgICB9LAogICAgY3V0KGRhdGEpIHsKICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7CiAgICAgIHZhciBtYXBuYW1lID0gJycKICAgICAgaWYgKGRhdGEgIT0gJy0nICYmIGRhdGEgIT0gJycpIHsKICAgICAgICBkYXRhID0gZGF0YS5maWx0ZXIoKGxldHRlcikgPT4gbGV0dGVyICE9PSAiICIpOwogICAgICBtYXBuYW1lID0gZGF0YS50b1N0cmluZygpOwoKICAgICAgbWFwbmFtZSA9IG1hcG5hbWUucmVwbGFjZUFsbCgiLCIsICIgfCAiKTsKICAgICAgfWVsc2V7CiAgICAgICAgbWFwbmFtZSA9IGRhdGEKICAgICAgfQogICAgICAKICAgICAgcmV0dXJuIG1hcG5hbWU7CiAgICB9LAogICAgc2F2ZSgpIHsKICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLmtleSk7CiAgICAgIGlmICh0aGlzLmtleS5uYW1lID09IG51bGwgfHwgdGhpcy5rZXkubmFtZSA9PSAiIikgewogICAgICAgIGFsZXJ0KCLguIHguKPguLjguJPguLLguIHguKPguK3guIHguILguYnguK3guITguKfguLLguKEiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcHJvZGF0YSA9IHsKICAgICAgICAgIG5hbWU6IHRoaXMua2V5Lm5hbWUsCiAgICAgICAgICBzdGF0dXM6IDEsCiAgICAgICAgfTsKICAgICAgICAvL2NvbnNvbGUubG9nKHByb2RhdGEpOwogICAgICAgIEtleXdvcmRTZXJ2aWNlLmNyZWF0ZWtleXdvcmQocHJvZGF0YSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgICAgIGlmIChyZXMuZGF0YS5lcnIgPT0gMTA2MikgewogICAgICAgICAgICBhbGVydCgi4Lih4Li14LiE4Liz4LiZ4Li14LmJ4LmD4LiZ4Lij4Liw4Lia4Lia4LmB4Lil4LmJ4LinIik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBEaWN0U2VydmljZS5jcmVhdGVkaWN0KHByb2RhdGEpLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmVzLmRhdGEgKTsKICAgICAgICAgICAgICAvLyBSdWxlQmFzZWRTZXJ2aWNlLmNyZWF0ZWRjb2x1bW5ydWxlX2Jhc2VkKHJlcy5kYXRhLmlkKS50aGVuKCgpID0+IHsKCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNsb3NlZGNhdGVnb3J5IikuY2xpY2soKTsKICAgICAgICAgICAgICBhbGVydCgi4Lia4Lix4LiZ4LiX4Li24LiB4Liq4Liz4LmA4Lij4LmH4LiIIik7CiAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRwZXJjZW50YWdlKGRhdGEpIHsKICAgICAgLy8gdmFyIGRpY3QgPSBKU09OLnBhcnNlKGRhdGEuZGljdF9pZCkKICAgICAgLy8gdmFyIHJ1bGVfYmFzZWRfaWQgPSBKU09OLnBhcnNlKGRhdGEucnVsZV9iYXNlZF9pZCkKICAgICAgLy8gdmFyIHJlID0gKDEwMCAqIGRhdGEuY291bnRfcnVsZWJhc2VkKS8gKHJ1bGVfYmFzZWRfaWQubGVuZ3RoKQogICAgICByZXR1cm4gZGF0YS5jb3VudF9ydWxlYmFzZWQ7CiAgICB9LAogICAgc2F2ZXRvcnVsZShzZW4sIGFuc3dlcikgewogICAgICAvLyBjb25zb2xlLmxvZyhhbnN3ZXIpOwogICAgICB2YXIgaWRkYXRhID0gW107CgogICAgICBmb3IgKGxldCBkID0gMDsgZCA8IHNlbi5sZW5ndGg7IGQrKykgewogICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGFzcGxpdFtkXSk7CiAgICAgICAgRGljdFNlcnZpY2UuZ2V0ZGljdHMoIiIsIHNlbltkXSkudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YVswXS5pZCk7CiAgICAgICAgICAgIGlkZGF0YS5wdXNoKHJlcy5kYXRhWzBdLmlkKTsKICAgICAgICAgIH0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGQrMSAsIHNlbi5sZW5ndGgpOwogICAgICAgICAgLy8gY29uc29sZS5sb2coaWRkYXRhKTsKICAgICAgICAgIGlmIChkICsgMSA9PSBzZW4ubGVuZ3RoKSB7CiAgICAgICAgICAgIHZhciBzcWwgPSBgU0VMRUNUIHIuKiBGUk9NIG1hcF9ydWxlX2Jhc2VkIG0gam9pbiBydWxlX2Jhc2VkIHIgb24gbS5ydWxlX2Jhc2VkX2lkID0gci5pZCBXSEVSRSBtLnN0YXR1cyA9IDEgYW5kIGRpY3RfaWQgPSAnWyR7aWRkYXRhfV0nYDsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc3FsKTsKCiAgICAgICAgICAgIGF3YWl0IFJ1bGVCYXNlZFNlcnZpY2UuZ2V0YnlkaWN0KHNxbCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgICAgICBsZXQgdGV4dCA9ICIiOwogICAgICAgICAgICAgICAgdGV4dCArPSAieyI7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpZGRhdGFbaV0pOwogICAgICAgICAgICAgICAgICB0ZXh0ICs9ICciZGljdCcgKyBpZGRhdGFbaV0gKyAnIicgKyAiOiIgKyAxICsgIiwiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGV4dCArPSAnImFuc3dlcicgKyAnIicgKyAiOiIgKyBhbnN3ZXIgKyAiLCI7CiAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZSgwLCAtMSk7CiAgICAgICAgICAgICAgICB0ZXh0ICs9ICJ9IjsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRleHQpOwogICAgICAgICAgICAgICAgbGV0IGpzb25EYXRhID0gSlNPTi5wYXJzZSh0ZXh0KTsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGpzb25EYXRhKTsKICAgICAgICAgICAgICAgIFJ1bGVCYXNlZFNlcnZpY2UuY3JlYXRlcnVsZV9iYXNlZChqc29uRGF0YSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgIHZhciBtYXBydWxlID0gewogICAgICAgICAgICAgICAgICAgIHJ1bGVfYmFzZWRfaWQ6IHJlcy5kYXRhLmlkLAogICAgICAgICAgICAgICAgICAgIGRpY3RfaWQ6IGlkZGF0YSwKICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDEsCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuY3JlYXRlbWFwX3J1bGVfYmFzZWQobWFwcnVsZSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgICAgICAgICAgICAgIC8vIHZhciBwcm8gPSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICBtYXBfcnVsZV9iYXNlZDpyZXMuZGF0YS5pZAogICAgICAgICAgICAgICAgICAgIC8vIH0KICAgICAgICAgICAgICAgICAgICAvLyBQcm9kdWN0c1NlcnZpY2UubWFwX3J1bGVfYmFzZWQoaWQscHJvKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBhbGVydCgi4Lia4Lix4LiZ4LiX4Li24LiB4Liq4Liz4LmA4Lij4LmH4LiIIik7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0ZGF0YSgpOwogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICAvLyB9LCA1MDApOwogICAgICAgICAgICAgICAgICAgIC8vIH0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlbWFwcnVsZSA9IHsKICAgICAgICAgICAgICAgICAgYW5zd2VyOiBhbnN3ZXIsCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgUnVsZUJhc2VkU2VydmljZS51cGRhdGVydWxlX2Jhc2VkKAogICAgICAgICAgICAgICAgICByZXMuZGF0YVswXS5pZCwKICAgICAgICAgICAgICAgICAgdXBkYXRlbWFwcnVsZQogICAgICAgICAgICAgICAgKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgYWxlcnQoIuC4muC4seC4meC4l+C4tuC4geC4quC4s+C5gOC4o+C5h+C4iCIpOwoKICAgICAgICAgICAgICAgICAgdGhpcy5nZXRkYXRhKCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgc2F2ZXRvcnVsZV9iYXNlZChkYXRhLCBhbnN3ZXIpIHsKICAgICAgdGhpcy5hbnN3ZXIgPSBhbnN3ZXIKICAgICAgLy8gY29uc29sZS5sb2coc2VuLmxlbmd0aCk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCdhbnN3ZXInLGFuc3dlcik7CiAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICB2YXIgZGF0YXMgPSB7CiAgICAgICAgbmFtZSA6ZGF0YS5ydWxlX2Jhc2VkX2lkLAogICAgICAgIHR5cGVJZDp0aGlzLnR5cGVJZCwKICAgICAgICBhZHZlcnRpc2VJZDpkYXRhLmlkCiAgICAgIH0KICAgICAgCiAgICAgIC8vIGlmICghZGF0YS5tYXBJZCkgewogICAgICAgIGF3YWl0IE1hcFJ1bGVCYXNlZFNlcnZpY2UuY2hlY2tpbnRiKGRhdGEuZGljdF9pZCkudGhlbihhc3luYyAoY2hlY2spID0+IHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGNoZWNrLmRhdGEpOwogICAgICAgICAgdmFyIHN0YXR1c2ZhbHNlID0gMAogICAgICAgICAgdmFyIHN0YXR1c3RydWUgPSAwCiAgICAgICAgICB2YXIgd2VpZ2h0ID0gMAogICAgICAgICAgdmFyIGFkdmVydGlzZV9pZCA9IFtdCiAgICAgICAgICBpZiAoY2hlY2suZGF0YSkgewogICAgICAgICAgICBhZHZlcnRpc2VfaWQgPSBKU09OLnBhcnNlKGNoZWNrLmRhdGEubWFwX2FkdmVydGlzZSkKICAgICAgICAgIHN0YXR1c2ZhbHNlID0gY2hlY2suZGF0YS5zdGF0dXNmYWxzZQogICAgICAgICAgc3RhdHVzdHJ1ZSA9IGNoZWNrLmRhdGEuc3RhdHVzdHJ1ZQogICAgICAgICAgZGF0YXMucnVsZWJhc2VkSWQgPSBjaGVjay5kYXRhLmlkCiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYW5zd2VyID09IDEpIHsKICAgICAgICAgICAgc3RhdHVzdHJ1ZSA9IHN0YXR1c3RydWUrIHBhcnNlSW50KDEpCiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYW5zd2VyID09IDkpIHsKICAgICAgICAgICAgc3RhdHVzZmFsc2UgPSBzdGF0dXNmYWxzZSArIHBhcnNlSW50KDEpCiAgICAgICAgICB9CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhZHZlcnRpc2VfaWQpOwogICAgICAgICAgYWR2ZXJ0aXNlX2lkLnB1c2goZGF0YS5pZCkKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGFkdmVydGlzZV9pZCk7CiAgICAgICAgICB3ZWlnaHQgPSBzdGF0dXNmYWxzZStzdGF0dXN0cnVlCiAgICAgICAgICB2YXIgbWFwcnVsZSA9IHsKICAgICAgICBrZXl3b3JkX2lkOiAxLAogICAgICAgIGFkdmVydGlzZV9pZDogZGF0YS5pZCwKICAgICAgICBzdGF0dXM6IDksCiAgICAgICAgYW5zd2VyOiBhbnN3ZXIsCiAgICAgICAgdXNlcjogdGhpcy5jdXJyZW50VXNlci5pZCwKICAgICAgICBtYXBfZGljdDogSlNPTi5wYXJzZShkYXRhLmRpY3RfaWQpLAogICAgICAgIHN0YXR1c2ZhbHNlOnN0YXR1c2ZhbHNlLAogICAgICAgIHN0YXR1c3RydWU6c3RhdHVzdHJ1ZSwKICAgICAgICB3ZWlnaHQ6d2VpZ2h0LAogICAgICAgIG1hcF9hZHZlcnRpc2U6IGFkdmVydGlzZV9pZCwKICAgICAgfTsKICAgICAgdmFyIG1hcHJ1bGV1c2VyID0gewogICAgICAgIGFkdmVydGlzZUlkOiBkYXRhLmlkLAogICAgICAgIG1hcF9ydWxlX2Jhc2VkSWQ6IGNoZWNrLmRhdGEuaWQsCiAgICAgICAgYW5zd2VyOiBhbnN3ZXIsCiAgICAgICAgdXNlcklkOiB0aGlzLmN1cnJlbnRVc2VyLmlkLAogICAgICB9OwogICAgICAgICAgaWYgKGNoZWNrLmRhdGEpIHsKICAgICAgICAgICAgaWYgKGRhdGEubWFwX3J1bGVfYmFzZWRfdXNlcklkKSB7CiAgTWFwUnVsZUJhc2VkVXNlclNlcnZpY2UudXBkYXRlbWFwX3J1bGVfYmFzZWRfdXNlcihkYXRhLm1hcF9ydWxlX2Jhc2VkX3VzZXJJZCxtYXBydWxldXNlcikudGhlbigKICAgICAgICAgIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgLy8gYXdhaXQgdGhpcy5nZXRkZXRhaWwoKTsKICAgICAgICAgICAgLy8gYWxlcnQoIuC4muC4seC4meC4l+C4tuC4geC4quC4s+C5gOC4o+C5h+C4iCIpOwogICAgICAgICAgfSk7Cn1lbHNlewogIE1hcFJ1bGVCYXNlZFVzZXJTZXJ2aWNlLmNyZWF0ZW1hcF9ydWxlX2Jhc2VkX3VzZXIobWFwcnVsZXVzZXIpLnRoZW4oCiAgICAgICAgICBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgCiAgICAgICAgICB9KTsKfQphd2FpdCBNYXBSdWxlQmFzZWRTZXJ2aWNlLnVwZGF0ZWFuc3dlcihjaGVjay5kYXRhLmlkLCBtYXBydWxlKS50aGVuKAogICAgICAgICAgYXN5bmMgKCkgPT4gewogICAgIGF3YWl0IEtleXdvcmRTZXJ2aWNlLnVwZGF0ZXdlaWdodCgxLGRhdGFzKS50aGVuKGFzeW5jICgpPT57CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0ZGV0YWlsKCk7CiAgICAgICAgICAgIGFsZXJ0KCLguJrguLHguJnguJfguLbguIHguKrguLPguYDguKPguYfguIgiKTsKICAgICAgICAgIH0pCiAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBNYXBSdWxlQmFzZWRTZXJ2aWNlLmNyZWF0ZW1hcF9ydWxlX2Jhc2VkKG1hcHJ1bGUpLnRoZW4oCiAgICAgICAgICAgICAgYXN5bmMgKHJlcykgPT4gewogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgICAgICAgICAgdmFyIG1hcF9pZCA9IHJlcy5kYXRhLmlkOwogICAgICAgICAgICAgICAgdmFyIG1hcHJ1bGV1c2VyY3JlYXRlID0gewogICAgICAgIGFkdmVydGlzZUlkOiBkYXRhLmlkLAogICAgICAgIG1hcF9ydWxlX2Jhc2VkSWQ6IG1hcF9pZCwKICAgICAgICBhbnN3ZXI6IGFuc3dlciwKICAgICAgICB1c2VySWQ6IHRoaXMuY3VycmVudFVzZXIuaWQsCiAgICAgIH07CiAgICAgICAgICAgICAgICBNYXBSdWxlQmFzZWRVc2VyU2VydmljZS5jcmVhdGVtYXBfcnVsZV9iYXNlZF91c2VyKG1hcHJ1bGV1c2VyY3JlYXRlKS50aGVuKAogICAgICAgICAgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgZGF0YXMucnVsZWJhc2VkSWQgPSBtYXBfaWQKICAgICAgICAgICAgICAgIHZhciBzZW5kYXRhID0gSlNPTi5wYXJzZShkYXRhLmRpY3RfaWQpOwogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2VuZGF0YSk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkaWN0X25hbWUpOwogICAgICAgICAgICAgICAgZm9yIChsZXQgZCA9IDA7IGQgPCBzZW5kYXRhLmxlbmd0aDsgZCsrKSB7CiAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNlbmRhdGFbZF0pOwogICAgICAgICAgICAgICAgICBpZiAoc2VuZGF0YVtkXSkgewogICAgICAgICAgICAgICAgICAgIGF3YWl0IERpY3RTZXJ2aWNlLmdldGRpY3Qoc2VuZGF0YVtkXSkudGhlbihhc3luYyAoc2VuKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2VuLmRhdGEpOwogICAgICAgICAgICAgICAgICAgIHZhciBydWxlID0gewogICAgICAgICAgICAgICAgICAgICAgbWFwX3J1bGVfYmFzZWRfaWQ6IG1hcF9pZCwKICAgICAgICAgICAgICAgICAgICAgIGRpY3RfaWQ6IHNlbmRhdGFbZF0sCiAgICAgICAgICAgICAgICAgICAgICBkaWN0X25hbWU6IHNlbi5kYXRhLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICBubzogZCArIDEsCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhydWxlKTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBSdWxlQmFzZWRTZXJ2aWNlLmNyZWF0ZXJ1bGVfYmFzZWQocnVsZSkudGhlbihhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoZCArIDEgPT0gc2VuZGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgS2V5d29yZFNlcnZpY2UudXBkYXRld2VpZ2h0KDEsZGF0YXMpLnRoZW4oYXN5bmMgKHJlcyk9PnsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRkZXRhaWwoKTsKICAgICAgICAgICAgYWxlcnQoIuC4muC4seC4meC4l+C4tuC4geC4quC4s+C5gOC4o+C5h+C4iCIpOwogICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgICAKICAgICAgICB9KTsKICAgICAKICAgICAgICAvLyB9IGVsc2UgewogICAgICAvLyAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuZGVsZXRlbWFwX3J1bGVfYmFzZWQoZGF0YS5tYXBJZCwgbWFwcnVsZSkudGhlbigKICAgICAgLy8gICAgIGFzeW5jICgpID0+IHsKICAgICAgLy8gICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAvLyAgICAgICB0aGlzLmdldGRldGFpbCgpOwogICAgICAvLyAgICAgICBhbGVydCgi4Lia4Lix4LiZ4LiX4Li24LiB4Liq4Liz4LmA4Lij4LmH4LiIIik7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgKTsKICAgICAgLy8gfQogICAgfSwKICAgIGNoZWNra2V5d29yZChuYW1lKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKG5hbWUpOwogICAgICAvLyAgIGF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MDgxL2FwaS9rZXl3b3JkX2RpY3RzP25hbWU9MScpLnRoZW4oKHJlcykgPT4gewogICAgICAvLyAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAvLyBmb3IgKGxldCByID0gMDsgciA8IHJlcy5kYXRhLmxlbmd0aDsgcisrKSB7CiAgICAgIC8vIG5hbWUgPSBuYW1lLnJlcGxhY2VBbGwoLyhbXHVFMDAwLVx1RjhGRl18XHVEODNDW1x1REYwMC1cdURGRkZdfFx1RDgzRFtcdURDMDAtXHVEREZGXSkvZywgJycpCiAgICAgIC8vICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2VBbGwoLyg/OltcdTI3MDAtXHUyN2JmXXwoPzpcdWQ4M2NbXHVkZGU2LVx1ZGRmZl0pezJ9fFtcdWQ4MDAtXHVkYmZmXVtcdWRjMDAtXHVkZmZmXXxbXHUwMDIzLVx1MDAzOV1cdWZlMGY/XHUyMGUzfFx1MzI5OXxcdTMyOTd8XHUzMDNkfFx1MzAzMHxcdTI0YzJ8XHVkODNjW1x1ZGQ3MC1cdWRkNzFdfFx1ZDgzY1tcdWRkN2UtXHVkZDdmXXxcdWQ4M2NcdWRkOGV8XHVkODNjW1x1ZGQ5MS1cdWRkOWFdfFx1ZDgzY1tcdWRkZTYtXHVkZGZmXXxcdWQ4M2NbXHVkZTAxLVx1ZGUwMl18XHVkODNjXHVkZTFhfFx1ZDgzY1x1ZGUyZnxcdWQ4M2NbXHVkZTMyLVx1ZGUzYV18XHVkODNjW1x1ZGU1MC1cdWRlNTFdfFx1MjAzY3xcdTIwNDl8W1x1MjVhYS1cdTI1YWJdfFx1MjViNnxcdTI1YzB8W1x1MjVmYi1cdTI1ZmVdfFx1MDBhOXxcdTAwYWV8XHUyMTIyfFx1MjEzOXxcdWQ4M2NcdWRjMDR8W1x1MjYwMC1cdTI2RkZdfFx1MmIwNXxcdTJiMDZ8XHUyYjA3fFx1MmIxYnxcdTJiMWN8XHUyYjUwfFx1MmI1NXxcdTIzMWF8XHUyMzFifFx1MjMyOHxcdTIzY2Z8W1x1MjNlOS1cdTIzZjNdfFtcdTIzZjgtXHUyM2ZhXXxcdWQ4M2NcdWRjY2Z8XHUyOTM0fFx1MjkzNXxbXHUyMTkwLVx1MjFmZl0pL2csICcnKTsKICAgICAgLy8gICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZUFsbCgvKFxyXG58XG58XHIpL2dtLCAiIik7CiAgICAgIC8vICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2VBbGwoIl8iLCAiIik7CiAgICAgIC8vICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2VBbGwoIiEiLCAiIik7CiAgICAgIC8vICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2VBbGwoIioiLCAiIik7CiAgICAgIC8vIG5hbWUgPSBuYW1lLnJlcGxhY2VBbGwoYF8vbFxfYCwgIiIpOy8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgICAgLy8gY29uc29sZS5sb2coJ2h0dHA6Ly8xMjcuMC4wLjE6NTAwMC9jaGVja2tleXdvcmQ/dGV4dD0nICsgbmFtZSk7CiAgICAgIHZhciBkZXNjID0gdGhpcy5maW5kZGVzY3JpcHRpb24obmFtZSk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCdodHRwOi8vMTI3LjAuMC4xOjUwMDAvd29ya3Rva2VuZGVzYz90ZXh0PScrZGVzYyk7CiAgICAgIGF4aW9zCiAgICAgICAgLmdldChMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkgKyAiL3dvcmt0b2tlbmRlc2M/dGV4dD0iICsgZGVzYykKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICB0aGlzLmRlc2MgPSByZXMuZGF0YTsKICAgICAgICB9KTsKICAgICAgLy8gbmFtZSA9ICfguILguYnguK3guKHguLnguKXguIjguLPguYDguJ7guLLguLDguILguK3guIfguKrguLTguJnguITguYnguLIg4Lir4Lih4Lin4LiU4Lir4Lih4Li54LmIIFNob3BlZSDguIHguKXguLjguYjguKHguJzguKXguLTguJXguKDguLHguJPguJHguYzguYDguJ7guLfguYjguK3guKrguLjguILguKDguLLguJ4g4Lit4Liy4Lir4Liy4Lij4LmA4Liq4Lij4Li04Lih4LmA4Lie4Li34LmI4Lit4LiE4Lin4Liy4Lih4LiH4Liy4LihIOC4nOC4tOC4pyDguKLguLXguYjguKvguYnguK0gQmx1ZWJpcmQo4Lia4Lil4Li54LmA4Lia4Li04Lij4LmM4LiUKSBTdG9yYWdlIENvbmRpdGlvbiBOb3JtYWwg4Lib4Lij4Liw4LmA4Lig4LiX4Liq4Liy4Lij4Lit4Liy4Lir4Liy4LijIOC4quC4suC4o+C4leC5ieC4suC4meC4reC4meC4uOC4oeC4ueC4peC4reC4tOC4quC4o+C4sCwg4Lin4Li04LiV4Liy4Lih4Li04LiZ4LiL4Li1IOC4m+C4o+C4sOC5gOC4l+C4qOC4leC5ieC4meC4geC4s+C5gOC4meC4tOC4lOC4quC4tOC4meC4hOC5ieC4siDguYTguJfguKIg4Lir4LiZ4LmJ4Liy4LiX4Li14LmI4LiC4Lit4LiH4Lit4Liy4Lir4Liy4Lij4LmA4Liq4Lij4Li04Lih4Liq4Liz4Lir4Lij4Lix4Lia4LiE4Lin4Liy4Lih4LiH4Liy4LihIOC4lOC4ueC5geC4peC4quC4tOC4pywg4Lib4LmJ4Lit4LiH4LiB4Lix4LiZ4Lij4Li04LmJ4Lin4Lij4Lit4LiiIOC4m+C4o+C4sOC5gOC4oOC4l+C4geC4suC4o+C4q+C5iOC4rSDguKvguYjguK3guKPguKfguKHguIHguLHguJkg4LmA4Lie4LioIOC4l+C4seC5ieC4h+C4quC4reC4h+C5gOC4nuC4qCDguK3guLLguKLguLjguIHguLLguKPguYDguIHguYfguJrguKPguLHguIHguKnguLIgMTIg4LmA4LiU4Li34Lit4LiZIOC4m+C4o+C4sOC5gOC4oOC4l+C4guC4reC4h+C4nOC4peC4tOC4leC4oOC4seC4k+C4keC5jOC4ouC4siDguYHguITguJvguIvguLnguKUg4Lir4Lih4Liy4Lii4LmA4Lil4LiC4LmD4Lia4Lit4LiZ4Li44LiN4Liy4LiVL+C4reC4oi4gMzAtMS0yNjc2NC01LTAwNTEg4LiI4Liz4LiZ4Lin4LiZ4Liq4Li04LiZ4LiE4LmJ4LiyIDE3OTAxIOC4quC5iOC4h+C4iOC4suC4gSDguIjguLHguIfguKvguKfguLHguJTguJnguITguKPguKPguLLguIrguKrguLXguKHguLIg4Lij4Liy4Lii4Lil4Liw4LmA4Lit4Li14Lii4LiU4Liq4Li04LiZ4LiE4LmJ4LiyIOC4p+C4tOC4leC4suC4oeC4tOC4meC4i+C4tSDguJ7guKXguLHguKog4LiV4Lij4LiyIOC4muC4peC4ueC5gOC4muC4tOC4o+C5jOC4lCDguJXguKPguLIg4Lia4Lil4Li54LmA4Lia4Li04Lij4LmM4LiUIOC4guC4meC4suC4lCAxMDAwIOC4oeC4tOC4peC4peC4tOC4geC4o+C4seC4oSA2MCDguYHguITguJvguIvguLnguKUg4LmA4Lij4LiX4LiC4Liy4Lii4Liq4LmI4LiHIOC4iuC5iOC4p+C4h+C4o+C4suC4hOC4suC4l+C4teC5iCAxIOC4quC4seC5iOC4h+C4i+C4t+C5ieC4reC4leC4seC5ieC4h+C5geC4leC5iCA1IOC4geC4o+C4sOC4m+C4uOC4geC4guC4tuC5ieC4meC5hOC4myDguJbguLbguIcgMjAg4LiB4Lij4Liw4Lib4Li44LiBIOC4o+C4suC4hOC4suC4geC4o+C4sOC4m+C4uOC4geC4peC4sCA5MyDguJrguLLguJcg4LiK4LmI4Lin4LiH4Lij4Liy4LiE4Liy4LiX4Li14LmIIDIg4Liq4Lix4LmI4LiH4LiL4Li34LmJ4Lit4LiV4Lix4LmJ4LiH4LmB4LiV4LmIIDIxIOC4geC4o+C4sOC4m+C4uOC4geC4guC4tuC5ieC4meC5hOC4myDguJbguLbguIcgNTAg4LiB4Lij4Liw4Lib4Li44LiBIOC4o+C4suC4hOC4suC4geC4o+C4sOC4m+C4uOC4geC4peC4sCA5MCDguJrguLLguJcg4LiK4LmI4Lin4LiH4Lij4Liy4LiE4Liy4LiX4Li14LmIIDMg4Liq4Lix4LmI4LiH4LiL4Li34LmJ4Lit4LiV4Lix4LmJ4LiH4LmB4LiV4LmIIDUxIOC4geC4o+C4sOC4m+C4uOC4geC4guC4tuC5ieC4meC5hOC4myDguJbguLbguIcgMTAwIOC4geC4o+C4sOC4m+C4uOC4gSDguKPguLLguITguLLguIHguKPguLDguJvguLjguIHguKXguLAgODcg4Lia4Liy4LiXIOC4iuC5iOC4p+C4h+C4o+C4suC4hOC4suC4l+C4teC5iCA0IOC4quC4seC5iOC4h+C4i+C4t+C5ieC4reC4leC4seC5ieC4h+C5geC4leC5iCAxMDAg4LiB4Lij4Liw4Lib4Li44LiB4LiC4Li24LmJ4LiZ4LmE4LibIC4uLi4uLi4uLi4uLi4uLi4uLi4uLiDguKPguLLguITguLLguIHguKPguLDguJvguLjguIHguKXguLAgODUg4Lia4Liy4LiXIFZpdGFtaW4gQyBQbHVzIERpZXRhcnkgU3VwcGxlbWVudCBQcm9kdWN0IEJsdWViaXJkIEJyYW5kIOC4nOC4peC4tOC4leC4oOC4seC4k+C4keC5jOC5gOC4quC4o+C4tOC4oeC4reC4suC4q+C4suC4o+C4p+C4tOC4leC4suC4oeC4tOC4meC4i+C4tSDguJ7guKXguLHguKog4LiV4Lij4LiyIOC4muC4peC4ueC5gOC4muC4tOC4o+C5jOC4lCDguKrguYjguKfguJnguJvguKPguLDguIHguK3guJrguJfguLHguYnguIfguKvguKHguJTguYPguJkgMSDguYHguITguJvguIvguLnguKUg4Liq4LmI4Lin4LiZ4Lib4Lij4Liw4LiB4Lit4Lia4LiX4Li14LmI4Liq4Liz4LiE4Lix4LiNIChBY3RpdmUgSW5ncmVkaWVudCkgVklUQU1JTiBDICgxMDAlKSAtIDYwIOC4oeC4tOC4peC4peC4tOC4geC4o+C4seC4oSBDSVRSVVMgQklPRkxBVk9OT0lEIFBPV0RFUiAtIDYzMCDguKHguLTguKXguKXguLTguIHguKPguLHguKEgQkFSQkFET1NDSEVSUlkgUE9XREVSL0FDRVJPTEEgQ0hFUlJZIFBPV0RFUiAo4Lic4LiH4Lia4Liy4Lij4LmM4LmA4Lia4LmC4LiU4Liq4LmA4LiK4Lit4Lij4LmM4Lij4Li1L+C4nOC4h+C4reC4sOC5gOC4i+C5guC4o+C4peC4suC5gOC4iuC4reC4o+C5jOC4o+C4tSkgKE1BTFBJR0hJQSBHTEFCUkEgTC4pIOC4nOC4pSAtIDYwIOC4oeC4tOC4peC4peC4tOC4geC4o+C4seC4oSBST1NFSElQIFBPV0RFUiAo4Lic4LiH4LmC4Lij4Liq4Liu4Li04Lib4Liq4LmMKSAoUk9TQSBDQU5JTkEgTC4pIOC4nOC4pSAtIDYwIOC4oeC4tOC4peC4peC4tOC4geC4o+C4seC4oSBSdXRpbiAtIDMwIOC4oeC4tOC4peC4peC4tOC4geC4o+C4seC4oSBJTkRJQU4gR09PU0VCRVJSWSBQT1dERVIgKOC4nOC4h+C4oeC4sOC4guC4suC4oeC4m+C5ieC4reC4oSkgKFBIWUxMQU5USFVTIEVNQkxJQ0EgTC4gKSDguJzguKUgLSA2MCDguKHguLTguKXguKXguLTguIHguKPguLHguKEg4Liq4LmI4Lin4LiZ4Lib4Lij4Liw4LiB4Lit4Lia4LiX4Li14LmI4LmE4Lih4LmI4Liq4Liz4LiE4Lix4LiNIChJbmFjdGl2ZSBJbmdyZWRpZW50KSBFRElCTEUgR0VMQVRJTiA0MjggLSA5OC41IOC4oeC4tOC4peC4peC4tOC4geC4o+C4seC4oSBUSVRBTklVTSBESU9YSURFIDE3MSAtMS45NSDguKHguLTguKXguKXguLTguIHguKPguLHguKEg4Lin4Li04LiY4Li14Lij4Lix4Lia4Lib4Lij4Liw4LiX4Liy4LiZIOC4hOC4o+C4seC5ieC4h+C4peC4sCAxLTIg4LmB4LiE4Lib4LiL4Li54LilIOC4q+C4peC4seC4h+C4reC4suC4q+C4suC4o+C5gOC4iuC5ieC4siDguYDguKXguILguJfguLXguYgg4LitLuC4oi4gMzAtMS0yNjc2NC01LTAwNTEg4LiE4Liz4LmA4LiV4Li34Lit4LiZIOC4hOC4p+C4o+C5gOC4geC5h+C4muC5g+C4q+C5ieC4nuC5ieC4meC5geC4quC4h+C5geC4lOC4h+C5geC4peC4sOC4hOC4p+C4suC4oeC4iuC4t+C5ieC4mSDguYDguJTguYfguIEg4Liq4LiV4Lij4Li14Lih4Li14LiE4Lij4Lij4Lig4LmMIOC5geC4peC4sOC4quC4leC4o+C4teC5g+C4q+C5ieC4meC4oeC4muC4uOC4leC4o+C5hOC4oeC5iOC4hOC4p+C4o+C4o+C4seC4muC4m+C4o+C4sOC4l+C4suC4mSDguITguKfguKPguIHguLTguJnguK3guLLguKvguLLguKPguKvguKXguLLguIHguKvguKXguLLguKLguYPguKvguYnguITguKPguJogNSDguKvguKHguLnguYgg4LmD4LiZ4Liq4Lix4LiU4Liq4LmI4Lin4LiZ4LiX4Li14LmI4LmA4Lir4Lih4Liy4Liw4Liq4Lih4LmA4Lib4LmH4LiZ4Lib4Lij4Liw4LiI4LizIOC5hOC4oeC5iOC4oeC4teC4nOC4peC5g+C4meC4geC4suC4o+C4m+C5ieC4reC4h+C4geC4seC4meC4q+C4o+C4t+C4reC4o+C4seC4geC4qeC4suC5guC4o+C4hCDguKrguKPguKPguJ7guITguLjguJMg4Lib4Lij4Liw4LmC4Lii4LiK4LiZ4LmM4LiC4Lit4LiH4LiB4Liy4Lij4LiB4Li04LiZ4Lin4Li04LiV4Liy4Lih4Li04LiZ4LiL4Li1IO+4j+C4l+C4s+C5g+C4q+C5ieC4q+C4meC5ieC4suC5hOC4oeC5iOC5guC4l+C4o+C4oSDguKvguJnguYnguLLguJXguLLguKrguJTguYPguKog77iP4LiK4LmI4Lin4Lii4Lif4Li34LmJ4LiZ4Lif4Li54Lic4Li04Lin4Lir4LiZ4LmJ4LiyIOC4quC4tOC4pyDguJ3guYnguLIg4LiB4Lij4LiwIOC4o+C4tOC5ieC4p+C4o+C4reC4oiDguJTguLnguIjguLLguIfguKXguIcg77iP4Lic4Li04Lin4Lie4Lij4Lij4LiT4LiZ4Li44LmI4Lih4LmA4Lij4Li14Lii4Lia4LmA4LiZ4Li14Lii4LiaIOC4iuC4uOC5iOC4oeC4iuC4t+C5iOC4mSDvuI/guKvguJnguYnguLLguJXguLLguJTguLnguYDguJTguYfguIHguYHguKXguLDguYDguJTguYnguIfguILguLbguYnguJkg77iP4Lic4Li04Lin4Lir4LiZ4LmJ4Liy4LiC4Liy4Lin4Lit4Lih4LiK4Lih4Lie4Li5IOC4quC4tOC4meC4hOC5ieC4suC4leC4seC4lOC4o+C4reC4muC4l+C4uOC4geC4p+C4seC4meC5gOC4p+C4peC4siDguJXguLHguJTguKPguK3guJrguYDguKfguKXguLIgMTIuMDAg4LiZIOC4guC4reC4h+C4l+C4uOC4geC4p+C4seC4mSDguYHguIjguYnguIfguYLguK3guJnguYDguIHguLTguJnguYDguKfguKXguLIg4Liq4LmI4LiH4Lij4Lit4Lia4Lin4Lix4LiZ4LiW4Lix4LiU4LmE4Lib4LiZ4Liw4LiI4LmK4LiwIOC4quC5iOC4h+C4nuC4seC4quC4lOC4uOC4l+C4uOC4geC4p+C4seC4mSDguYDguKfguYnguJnguKfguLHguJnguK3guLLguJfguLTguJXguKLguYwg4LmB4Lil4Liw4Lin4Lix4LiZ4Lir4Lii4Li44LiU4LiZ4Lix4LiB4LiC4Lix4LiV4Lik4LiB4Lip4LmMIOC4guC4reC4muC4nuC4o+C4sOC4hOC4uOC4k+C4peC4ueC4geC4hOC5ieC4suC4l+C4uOC4geC4l+C5iOC4suC4mSDguJfguLXguYjguYTguKfguYnguKfguLLguIfguYPguIjguJzguKXguLTguJXguKDguLHguJPguJHguYzguILguK3guIfguYDguKPguLLguYDguKrguKHguK3guKHguLJfL2xcXycKICAgICAgLy8gY29uc29sZS5sb2coJ2h0dHA6Ly8xMjcuMC4wLjE6NTAwMC9jaGVja2tleXdvcmQ/dGV4dD0nICsgZGVzYyk7CiAgICAgIHZhciBjb24gPSB7CiAgICAgICAgY29udGVudDogZGVzYywKICAgICAgfTsKICAgICAgYXhpb3MKICAgICAgICAucG9zdChMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkgKyAiL2NoZWNra2V5d29yZD90ZXh0PSIsIGNvbikKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICBpZiAocmVzLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgICAvLyB0aGlzLmtleXdvcmQucHVzaChyZXMuZGF0YSkKICAgICAgICAgICAgdGhpcy5rZXl3b3JkID0gcmVzLmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIC8vICAgICB9CgogICAgICAvLyB9KTsKICAgICAgLy8gICAgICAgdmFyIGxpc3RrZXl3b3JkcyA9IFtdCiAgICAgIC8vICAgICAgIHZhciBuYW1lc3BsaXQgPSBuYW1lLnNwbGl0KCIgIikKICAgICAgLy8gICAgICAgLy8gY29uc29sZS5sb2cobmFtZXNwbGl0KTsKICAgICAgLy8gICAgICAgYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjgwODEvYXBpL2tleXdvcmRfZGljdHM/bmFtZT0xJykudGhlbigocmVzKSA9PiB7CiAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAvLyAgICAgICAgIHZhciBrZXlsaXN0ID0gW10KICAgICAgLy8gICAgICAgICBmb3IgKGxldCByID0gMDsgciA8IHJlcy5kYXRhLmxlbmd0aDsgcisrKSB7CiAgICAgIC8vICAgICAgICAgICByZXMuZGF0YVtyXS5uYW1lID0gcmVzLmRhdGFbcl0ubmFtZS5yZXBsYWNlQWxsKCIuIiwiIikKICAgICAgLy8gICAgICAgICAgIHZhciBrayA9IHJlcy5kYXRhW3JdLm5hbWUuc3BsaXQoIiAiKQogICAgICAvLyAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBray5sZW5ndGg7IGsrKykgewogICAgICAvLyAgICAgICAgICAgICBrZXlsaXN0LnB1c2goa2tba10pCiAgICAgIC8vICAgICAgICAgICB9CiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgICAgIGZvciAobGV0IGtleSA9IDA7IGtleSA8IGtleWxpc3QubGVuZ3RoOyBrZXkrKykgewogICAgICAvLyAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBuYW1lc3BsaXQubGVuZ3RoOyBuKyspIHsKICAgICAgLy8gICAgICAgICAgICAgaWYgKG5hbWVzcGxpdFtuXSA9PSBrZXlsaXN0W2tleV0gJiYga2V5bGlzdFtrZXldICE9ICcnICYmIGlzTmFOKGtleWxpc3Rba2V5XSkpIHsKICAgICAgLy8gICAgICAgICAgICAgICBsaXN0a2V5d29yZHMucHVzaChrZXlsaXN0W2tleV0pCiAgICAgIC8vICAgICAgICAgICAgIH0KCiAgICAgIC8vICAgICAgICAgICB9CiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKGtleWxpc3QpOwogICAgICAvLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKGxpc3RrZXl3b3Jkcyk7CgogICAgICAvLyAgICAgICBjb25zb2xlLmxvZyhsaXN0a2V5d29yZHMubGVuZ3RoKTsKICAgICAgLy8gICAgICAgICBpZiAobGlzdGtleXdvcmRzLmxlbmd0aCA9PSAwKSB7CgogICAgICAvLyAgICAgICAgICAgdGhpcy5jb2xvcmtleSA9ICJiYWNrZ3JvdW5kLWNvbG9yOiNhM2U5YTQiCiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgLy8gICAgICAgICBsaXN0a2V5d29yZHMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CiAgICAgIC8vICAgICAgaWYocmVzdWx0LmluZGV4T2YoaXRlbSkgPCAwKSB7CiAgICAgIC8vICAgICAgICAgIHJlc3VsdC5wdXNoKGl0ZW0pOwogICAgICAvLyAgICAgIH0KICAgICAgLy8gfSk7CiAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgIC8vIGxpc3RrZXl3b3JkcyA9IHJlc3VsdAogICAgICAvLyAgICAgICAgIGZvciAobGV0IGwgPSAwOyBsIDwgbGlzdGtleXdvcmRzLmxlbmd0aDsgbCsrKSB7CiAgICAgIC8vICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnaHR0cDovLzEyNy4wLjAuMTo1MDAwL2NoZWNra2V5d29yZD9uYW1lPScgKyBuYW1lKycmJm5hbWVfcmVhbD0nKTsKICAgICAgLy8gICAgICAgICAgIGF4aW9zLmdldCgnaHR0cDovLzEyNy4wLjAuMTo1MDAwL2NoZWNra2V5d29yZD9uYW1lPScgKyBuYW1lKycmJm5hbWVfcmVhbD0nICsgbGlzdGtleXdvcmRzW2xdKS50aGVuKChyZXMpID0+IHsKICAgICAgLy8gICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAvLyAgICAgICAgIHRoaXMua2V5d29yZC5wdXNoKHJlcy5kYXRhKQogICAgICAvLyAgICAgICB9KTsKCiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgICB9KTsKICAgIH0sCiAgICBmaW5kKCl7CnZhciB0eXBlID0gdGhpcy5maW5kdHlwZXByb2R1Y3QodGhpcy5kYXRhLmNvbnRlbnQpCmNvbnNvbGUubG9nKHR5cGUpOwp2YXIgc3BsaXQgPSB0eXBlLnNwbGl0KCJcbiIpCmNvbnNvbGUubG9nKHNwbGl0WzNdKTsKICAgICAgdmFyIGNvbnRlbnQgPSAiIjsKICAgICAgICBjb250ZW50ID0gdGhpcy5kYXRhLmNvbnRlbnQucmVwbGFjZUFsbCgKICAgICAgICAgIC8oW1x1RTAwMC1cdUY4RkZdfFx1RDgzQ1tcdURGMDAtXHVERkZGXXxcdUQ4M0RbXHVEQzAwLVx1RERGRl0pL2csCiAgICAgICAgICAiIgogICAgICAgICk7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgKICAgICAgICAgIC8oPzpbXHUyNzAwLVx1MjdiZl18KD86XHVkODNjW1x1ZGRlNi1cdWRkZmZdKXsyfXxbXHVkODAwLVx1ZGJmZl1bXHVkYzAwLVx1ZGZmZl18W1x1MDAyMy1cdTAwMzldXHVmZTBmP1x1MjBlM3xcdTMyOTl8XHUzMjk3fFx1MzAzZHxcdTMwMzB8XHUyNGMyfFx1ZDgzY1tcdWRkNzAtXHVkZDcxXXxcdWQ4M2NbXHVkZDdlLVx1ZGQ3Zl18XHVkODNjXHVkZDhlfFx1ZDgzY1tcdWRkOTEtXHVkZDlhXXxcdWQ4M2NbXHVkZGU2LVx1ZGRmZl18XHVkODNjW1x1ZGUwMS1cdWRlMDJdfFx1ZDgzY1x1ZGUxYXxcdWQ4M2NcdWRlMmZ8XHVkODNjW1x1ZGUzMi1cdWRlM2FdfFx1ZDgzY1tcdWRlNTAtXHVkZTUxXXxcdTIwM2N8XHUyMDQ5fFtcdTI1YWEtXHUyNWFiXXxcdTI1YjZ8XHUyNWMwfFtcdTI1ZmItXHUyNWZlXXxcdTAwYTl8XHUwMGFlfFx1MjEyMnxcdTIxMzl8XHVkODNjXHVkYzA0fFtcdTI2MDAtXHUyNkZGXXxcdTJiMDV8XHUyYjA2fFx1MmIwN3xcdTJiMWJ8XHUyYjFjfFx1MmI1MHxcdTJiNTV8XHUyMzFhfFx1MjMxYnxcdTIzMjh8XHUyM2NmfFtcdTIzZTktXHUyM2YzXXxbXHUyM2Y4LVx1MjNmYV18XHVkODNjXHVkY2NmfFx1MjkzNHxcdTI5MzV8W1x1MjE5MC1cdTIxZmZdKS9nLAogICAgICAgICAgIiAiCiAgICAgICAgKTsKCiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXHVkODNkW1x1ZGUwMC1cdWRlNGZdL2csICIgIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvKFxyXG58XG58XHIpL2dtLCAiICIpOwogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIl8iLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiISIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCIqIiwgIiIpOwogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIiYiLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiIyIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCLigKIiLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiKyIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKGBfL2xcX2AsICIiKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoCiAgICAgICAgICAvKFtcdTI3MDAtXHUyN0JGXXxbXHVFMDAwLVx1RjhGRl18XHVEODNDW1x1REMwMC1cdURGRkZdfFx1RDgzRFtcdURDMDAtXHVERkZGXXxbXHUyMDExLVx1MjZGRl18XHVEODNFW1x1REQxMC1cdURERkZdKS9nLAogICAgICAgICAgIiAiCiAgICAgICAgKTsKY29uc29sZS5sb2codGhpcy5maW5kZGVzY3JpcHRpb24oY29udGVudCkpOwogICAgfSwKICAgIGFzeW5jIGNoZWNra2V5KCl7CiAgICAgIGF3YWl0IHRoaXMubG9hZGRpY3QoKTsKICAgICAgdmFyIGNvbnRlbnQgPSAiIjsKICAgICAgICBjb250ZW50ID0gdGhpcy5kYXRhLmNvbnRlbnQucmVwbGFjZUFsbCgKICAgICAgICAgIC8oW1x1RTAwMC1cdUY4RkZdfFx1RDgzQ1tcdURGMDAtXHVERkZGXXxcdUQ4M0RbXHVEQzAwLVx1RERGRl0pL2csCiAgICAgICAgICAiIgogICAgICAgICk7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgKICAgICAgICAgIC8oPzpbXHUyNzAwLVx1MjdiZl18KD86XHVkODNjW1x1ZGRlNi1cdWRkZmZdKXsyfXxbXHVkODAwLVx1ZGJmZl1bXHVkYzAwLVx1ZGZmZl18W1x1MDAyMy1cdTAwMzldXHVmZTBmP1x1MjBlM3xcdTMyOTl8XHUzMjk3fFx1MzAzZHxcdTMwMzB8XHUyNGMyfFx1ZDgzY1tcdWRkNzAtXHVkZDcxXXxcdWQ4M2NbXHVkZDdlLVx1ZGQ3Zl18XHVkODNjXHVkZDhlfFx1ZDgzY1tcdWRkOTEtXHVkZDlhXXxcdWQ4M2NbXHVkZGU2LVx1ZGRmZl18XHVkODNjW1x1ZGUwMS1cdWRlMDJdfFx1ZDgzY1x1ZGUxYXxcdWQ4M2NcdWRlMmZ8XHVkODNjW1x1ZGUzMi1cdWRlM2FdfFx1ZDgzY1tcdWRlNTAtXHVkZTUxXXxcdTIwM2N8XHUyMDQ5fFtcdTI1YWEtXHUyNWFiXXxcdTI1YjZ8XHUyNWMwfFtcdTI1ZmItXHUyNWZlXXxcdTAwYTl8XHUwMGFlfFx1MjEyMnxcdTIxMzl8XHVkODNjXHVkYzA0fFtcdTI2MDAtXHUyNkZGXXxcdTJiMDV8XHUyYjA2fFx1MmIwN3xcdTJiMWJ8XHUyYjFjfFx1MmI1MHxcdTJiNTV8XHUyMzFhfFx1MjMxYnxcdTIzMjh8XHUyM2NmfFtcdTIzZTktXHUyM2YzXXxbXHUyM2Y4LVx1MjNmYV18XHVkODNjXHVkY2NmfFx1MjkzNHxcdTI5MzV8W1x1MjE5MC1cdTIxZmZdKS9nLAogICAgICAgICAgIiAiCiAgICAgICAgKTsKCiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXHVkODNkW1x1ZGUwMC1cdWRlNGZdL2csICIgIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvKFxyXG58XG58XHIpL2dtLCAiICIpOwogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIl8iLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiISIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCIqIiwgIiIpOwogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIiYiLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiIyIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCLigKIiLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiKyIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKGBfL2xcX2AsICIiKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoCiAgICAgICAgICAvKFtcdTI3MDAtXHUyN0JGXXxbXHVFMDAwLVx1RjhGRl18XHVEODNDW1x1REMwMC1cdURGRkZdfFx1RDgzRFtcdURDMDAtXHVERkZGXXxbXHUyMDExLVx1MjZGRl18XHVEODNFW1x1REQxMC1cdURERkZdKS9nLAogICAgICAgICAgIiAiCiAgICAgICAgKTsKICAgICAgICB2YXIgZGVzYyA9IHRoaXMuZmluZGRlc2NyaXB0aW9uKGNvbnRlbnQpCmNvbnNvbGUubG9nKGRlc2MpOwp2YXIgY29uID0gewogICAgICAgICAgICAgICAgICAgICAgY29udGVudDogZGVzYywKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgYXhpb3MKICAgICAgICAgICAgICAgICAgICAgIC5wb3N0KExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSArICIvY2hlY2trZXl3b3JkIiwgY29uKQogICAgICAgICAgICAgICAgICAgICAgLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgIH0sCiAgICBmaW5kdHlwZXByb2R1Y3QoZGF0YSkgewogICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgdmFyIHRleHQgPSBbIuC4q+C4oeC4p+C4lOC4q+C4oeC4ueC5iCJdOwogICAgICB2YXIgZmluZGZkYSA9IGRhdGE7CiAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgdGV4dC5sZW5ndGg7IHQrKykgewogICAgICAgIGlmIChmaW5kZmRhLmluZGV4T2YodGV4dFt0XSkgIT0gLTEpIHsKICAgICAgICAgIGZpbmRmZGEgPSBmaW5kZmRhLnN1YnN0cmluZyhmaW5kZmRhLmluZGV4T2YodGV4dFt0XSkpOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyBpZiAoZmluZGZkYSA9PSAn4Lit4Liy4Lir4Liy4LijJykgewogICAgICAvLyAgIGZpbmRmZGEgPSBmaW5kZmRhKyBmaW5kZmRhKyfguYDguKrguKPguLTguKEnCiAgICAgIC8vIH0KICAgICAgLy8gY29uc29sZS5sb2coZmluZGZkYSk7CiAgICAgIHJldHVybiBmaW5kZmRhOwogICAgfSwKICAgIGZpbmRkZXNjcmlwdGlvbihkYXRhKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICB2YXIgdGV4dCA9IFsi4Lij4Liy4Lii4Lil4Liw4LmA4Lit4Li14Lii4LiU4Liq4Li04LiZ4LiE4LmJ4LiyIl07CiAgICAgIHZhciBmaW5kZmRhID0gZGF0YTsKICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCB0ZXh0Lmxlbmd0aDsgdCsrKSB7CiAgICAgICAgaWYgKGZpbmRmZGEuaW5kZXhPZih0ZXh0W3RdKSAhPSAtMSkgewogICAgICAgICAgZmluZGZkYSA9IGZpbmRmZGEuc3Vic3RyaW5nKGZpbmRmZGEuaW5kZXhPZih0ZXh0W3RdKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIC8vIGlmIChmaW5kZmRhID09ICfguK3guLLguKvguLLguKMnKSB7CiAgICAgIC8vICAgZmluZGZkYSA9IGZpbmRmZGErIGZpbmRmZGErJ+C5gOC4quC4o+C4tOC4oScKICAgICAgLy8gfQogICAgICAvLyBjb25zb2xlLmxvZyhmaW5kZmRhKTsKICAgICAgZmluZGZkYSA9IGZpbmRmZGEucmVwbGFjZSgn4Lij4Liy4Lii4Lil4Liw4LmA4Lit4Li14Lii4LiU4Liq4Li04LiZ4LiE4LmJ4LiyJywnJykKICAgICAgcmV0dXJuIGZpbmRmZGE7CiAgICB9LAogICAgCiAgICBmaW5kc3BlY2lmaWMoZGF0YSkgewogICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgdmFyIHRleHQgPSBbIuC4guC5ieC4reC4oeC4ueC4peC4iOC4s+C5gOC4nuC4suC4sOC4guC4reC4h+C4quC4tOC4meC4hOC5ieC4siJdOwogICAgICB2YXIgZW5kID0gWyLguKPguLLguKLguKXguLDguYDguK3guLXguKLguJTguKrguLTguJnguITguYnguLIiXTsKICAgICAgdmFyIGZpbmRmZGEgPSBkYXRhOwogICAgICB2YXIgZW5kaW5kZXggPSBmaW5kZmRhLmluZGV4T2YoZW5kKTsKICAgICAgLy8gY29uc29sZS5sb2coZW5kaW5kZXgpOwogICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHRleHQubGVuZ3RoOyB0KyspIHsKICAgICAgICBpZiAoZmluZGZkYS5pbmRleE9mKHRleHRbdF0pICE9IC0xKSB7CiAgICAgICAgICBmaW5kZmRhID0gZmluZGZkYS5zdWJzdHJpbmcoZmluZGZkYS5pbmRleE9mKHRleHRbdF0pLGVuZGluZGV4KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gaWYgKGZpbmRmZGEgPT0gJ+C4reC4suC4q+C4suC4oycpIHsKICAgICAgLy8gICBmaW5kZmRhID0gZmluZGZkYSsgZmluZGZkYSsn4LmA4Liq4Lij4Li04LihJwogICAgICAvLyB9CiAgICAgIC8vIGNvbnNvbGUubG9nKGZpbmRmZGEpOwogICAgICBmaW5kZmRhID0gZmluZGZkYS5yZXBsYWNlKCfguILguYnguK3guKHguLnguKXguIjguLPguYDguJ7guLLguLDguILguK3guIfguKrguLTguJnguITguYnguLInLCcnKQogICAgICByZXR1cm4gZmluZGZkYTsKICAgIH0sCiAgICBmaW5kc3BlY2lmaWNsaXN0KGRhdGEpIHsKICAgICAgdmFyIGxpc3QgPSBbXQogICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgdmFyIHRleHQgPSBbIuC4q+C4oeC4p+C4lOC4q+C4oeC4ueC5iCIsIuC5gOC4nuC4qCIsIuC4q+C4meC5ieC4suC4l+C4teC5iOC4guC4reC4h+C4reC4suC4q+C4suC4o+C5gOC4quC4o+C4tOC4oeC4hOC4p+C4muC4hOC4uOC4oeC4meC5ieC4s+C4q+C4meC4seC4gSIsIuC4o+C4quC4iuC4suC4leC4tCIsIuC4q+C4oeC4suC4ouC5gOC4peC4guC5g+C4muC4reC4meC4uOC4jeC4suC4lS/guK3guKIuIiwi4Liq4LmI4Lin4LiZ4Lib4Lij4Liw4LiB4Lit4LiaIiwi4LiI4Liz4LiZ4Lin4LiZ4Liq4Li04LiZ4LiE4LmJ4LiyIiwi4Liq4LmI4LiH4LiI4Liy4LiBIl07CgogICAgICAvLyB2YXIgZmluZGZkYSA9IGRhdGEuc3BsaXQoJ+C4q+C4oeC4p+C4lOC4q+C4oeC4ueC5iCcpCiAgICAgIC8vIGNvbnNvbGUubG9nKGZpbmRmZGEpOwogICAgICAvLyB2YXIgZW5kID0gWyLguKPguLLguKLguKXguLDguYDguK3guLXguKLguJTguKrguLTguJnguITguYnguLIiXTsKICAgICAgLy8gdmFyIGVuZGluZGV4ID0gZmluZGZkYS5pbmRleE9mKGVuZCk7CiAgICAgIC8vIC8vIGNvbnNvbGUubG9nKGVuZGluZGV4KTsKICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCB0ZXh0Lmxlbmd0aDsgdCsrKSB7CgogICAgICB2YXIgZmluZGZkYSA9IGRhdGE7CiAgICAgICAgaWYgKGZpbmRmZGEuaW5kZXhPZih0ZXh0W3RdKSAhPSAtMSkgewogICAgICAgICAgdmFyIHNwbGl0ID0gJycKICAgICAgICAgIGlmICh0KzEgIT0gdGV4dC5sZW5ndGgpIHsKICAgICAgICAgICAgdmFyIGVuZGluZGV4ID0gZmluZGZkYS5pbmRleE9mKHRleHRbdCsxXSk7CiAgICAgICAgICAgIHNwbGl0ID0gZmluZGZkYS5zdWJzdHJpbmcoZmluZGZkYS5pbmRleE9mKHRleHRbdF0pLGVuZGluZGV4KTsKICAgICAgICAgIH1lbHNlewogICAgICAgICAgICBzcGxpdCA9IGZpbmRmZGEuc3Vic3RyaW5nKGZpbmRmZGEuaW5kZXhPZih0ZXh0W3RdKSk7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZyhmaW5kZmRhKTsKICAgICAgICAgIGNvbnNvbGUubG9nKHNwbGl0KTsKICAgICAgICAgIGNvbnNvbGUubG9nKHRleHRbdF0pOwogICAgICAgICAgY29uc29sZS5sb2coZW5kaW5kZXgpOwogICAgICAgICAgbGlzdC5wdXNoKHNwbGl0KQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbGlzdDsKICAgIH0sCiAgICBsb2FkZGljdCgpIHsKICAgICAgYXhpb3MuZ2V0KExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSArICIvbG9hZGRpY3QiKS50aGVuKGFzeW5jICgpID0+IHt9KTsKICAgIH0sCiAgICBnZXRkZXRhaWwoKSB7CiAgICAgIC8vIHZhciB1cmwgPSB0aGlzLmRhdGEudXJsLnNwbGl0KCItaS4iKTsKICAgICAgLy8gdmFyIHVybCA9IHRoaXMuZGF0YS51cmwuc3BsaXQoIi1pLiIpOwogICAgICAvLyB0aGlzLmRhdGEudXJsID0gdXJsWzBdOwogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnByb2R1Y3RfdG9rZW4pOwogICAgICB2YXIgc2VsZWN0cHJvID0gewogICAgICAgIC8vIHVybDogdGhpcy5kYXRhLnVybCwKICAgICAgICBpZDogdGhpcy5pZCwKICAgICAgICBmZGFfc3RhdHVzOiB0aGlzLmN1cnJlbnRVc2VyLmlkCiAgICAgIH07CiAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuZ2V0cHJvZHVjdF90b2tlbihzZWxlY3Rwcm8pLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgICAvLyB2YXIgYmVzdCA9IHRoaXMuZ2V0TWF4KHJlcy5kYXRhLmtleXdvcmQsJ2NvdW50X3J1bGViYXNlZCcpCiAgICAgICAgLy9jb25zb2xlLmxvZyhiZXN0KTsKICAgICAgICB0aGlzLmxpc3QgPSByZXMuZGF0YTsKICAgICAgICB0aGlzLnN0YXR1c2xpc3QgPSB0cnVlCiAgICAgICAgdGhpcy5zdGF0dXMgPSB0cnVlOwogICAgICAgIC8vIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgLy8gdmFyIGRhdGEgPSB7CiAgICAgICAgLy8gICBhZHZlcnRpc2VfaWQ6IHJlcy5kYXRhLmtleXdvcmRbMF0ucHJvZHVjdF90b2tlbl9pZCwKICAgICAgICAvLyB9OwogICAgICAgIC8vIE1hcFJ1bGVCYXNlZFNlcnZpY2UudXBkYXRld2VpZ2h0KAogICAgICAgIC8vICAgcmVzLmRhdGEua2V5d29yZFswXS5tYXBfcnVsZV9iYXNlZF9pZCwKICAgICAgICAvLyAgIGRhdGEKICAgICAgICAvLyApLnRoZW4oKCkgPT4ge30pOwogICAgICAgIC8vIHRoaXMubGlzdC5rZXl3b3JkID0gW2Jlc3RdCiAgICAgICAgLy8gdGhpcy5zdGF0dXMgPSB0cnVlCiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHNlYXJjaCgpIHsKICAgICAgLy8gdmFyIHVybCA9IHRoaXMuZGF0YS51cmwucmVwbGFjZUFsbCgiLiIsJycpOwogICAgICAvLyB1cmwgPSB1cmwuc3BsaXQoIi1pIik7CiAgICAgIC8vIHRoaXMuZGF0YS51cmwgPSB1cmxbMF07CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZGF0YS51cmwpOwogICAgICB0aGlzLnByb2R1Y3QgPSBbXTsKICAgICAgdGhpcy5wcm9jaGVjayA9IFtdOwogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5zdGF0dXMgPSBmYWxzZQogICAgICB0aGlzLnN0YXR1c3Byb2NoZWNrID0gZmFsc2UKICAgICAgdGhpcy5zdGF0dXNwcm9kdWN0ID0gZmFsc2UKICAgICAgdGhpcy5zdGF0dXNsaXN0ID0gZmFsc2UKICAgICAgdGhpcy5wcm9kdWN0X3Rva2VuID0gMDsKICAgICAgdmFyIGNvbiA9IHt9OwogICAgICBhd2FpdCB0aGlzLmxvYWRkaWN0KCk7CiAgICAgIC8vIGlmICh0aGlzLmRhdGEudXJsID09IG51bGwgfHwgdGhpcy5kYXRhLnVybCA9PSAiIikgewogICAgICAvLyAgIGFsZXJ0KCLguIHguKPguLjguJPguLLguIHguKPguK3guIEgVVJMIik7CiAgICAgIC8vIH0gZWxzZSAKICAgICAgaWYgKHRoaXMuZGF0YS5jb250ZW50ID09IG51bGwgfHwgdGhpcy5kYXRhLmNvbnRlbnQgPT0gIiIpIHsKICAgICAgICBhbGVydCgi4LiB4Lij4Li44LiT4Liy4LiB4Lij4Lit4LiB4LiC4LmJ4Lit4LiE4Lin4Liy4Lih4LmC4LiG4Lip4LiT4LiyIik7CiAgICAgIH0gZWxzZSB7CgogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgICB2YXIgZmluZHR5cGUgPSB0aGlzLmZpbmR0eXBlcHJvZHVjdCh0aGlzLmRhdGEuY29udGVudCkKLy8gY29uc29sZS5sb2codHlwZSk7CnZhciBzcGxpdCA9IGZpbmR0eXBlLnNwbGl0KCJcbiIpCnZhciB0eXBlID0gc3BsaXRbM10KLy8gY29uc29sZS5sb2codHlwZSk7CmF3YWl0IEZEQVR5cGVzU2VydmljZS5nZXRmZGF0eXBlcyh0eXBlKS50aGVuKGFzeW5jIChyZXMpPT57CiAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogIGlmIChyZXMuZGF0YS5sZW5ndGggPiAwKSB7CiAgICB0aGlzLnR5cGVJZCA9IHJlcy5kYXRhWzBdLmlkCiAgfWVsc2V7CiAgICB2YXIgbmFtZSA9IHsKICAgICAgbmFtZSA6IHR5cGUKICAgIH0KICAgIGF3YWl0IEZEQVR5cGVzU2VydmljZS5jcmVhdGVmZGF0eXBlKG5hbWUpLnRoZW4oKHJlcyk9PnsKICAgICAgdGhpcy50eXBlSWQgPSByZXMuZGF0YS5pZAogICAgfSk7CiAgfQp9KQovLyBjb25zb2xlLmxvZyh0aGlzLnR5cGVJZCk7CiAgICAgICAgdmFyIGNvbnRlbnQgPSAiIjsKICAgICAgICBjb250ZW50ID0gdGhpcy5kYXRhLmNvbnRlbnQucmVwbGFjZUFsbCgKICAgICAgICAgIC8oW1x1RTAwMC1cdUY4RkZdfFx1RDgzQ1tcdURGMDAtXHVERkZGXXxcdUQ4M0RbXHVEQzAwLVx1RERGRl0pL2csCiAgICAgICAgICAiIgogICAgICAgICk7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgKICAgICAgICAgIC8oPzpbXHUyNzAwLVx1MjdiZl18KD86XHVkODNjW1x1ZGRlNi1cdWRkZmZdKXsyfXxbXHVkODAwLVx1ZGJmZl1bXHVkYzAwLVx1ZGZmZl18W1x1MDAyMy1cdTAwMzldXHVmZTBmP1x1MjBlM3xcdTMyOTl8XHUzMjk3fFx1MzAzZHxcdTMwMzB8XHUyNGMyfFx1ZDgzY1tcdWRkNzAtXHVkZDcxXXxcdWQ4M2NbXHVkZDdlLVx1ZGQ3Zl18XHVkODNjXHVkZDhlfFx1ZDgzY1tcdWRkOTEtXHVkZDlhXXxcdWQ4M2NbXHVkZGU2LVx1ZGRmZl18XHVkODNjW1x1ZGUwMS1cdWRlMDJdfFx1ZDgzY1x1ZGUxYXxcdWQ4M2NcdWRlMmZ8XHVkODNjW1x1ZGUzMi1cdWRlM2FdfFx1ZDgzY1tcdWRlNTAtXHVkZTUxXXxcdTIwM2N8XHUyMDQ5fFtcdTI1YWEtXHUyNWFiXXxcdTI1YjZ8XHUyNWMwfFtcdTI1ZmItXHUyNWZlXXxcdTAwYTl8XHUwMGFlfFx1MjEyMnxcdTIxMzl8XHVkODNjXHVkYzA0fFtcdTI2MDAtXHUyNkZGXXxcdTJiMDV8XHUyYjA2fFx1MmIwN3xcdTJiMWJ8XHUyYjFjfFx1MmI1MHxcdTJiNTV8XHUyMzFhfFx1MjMxYnxcdTIzMjh8XHUyM2NmfFtcdTIzZTktXHUyM2YzXXxbXHUyM2Y4LVx1MjNmYV18XHVkODNjXHVkY2NmfFx1MjkzNHxcdTI5MzV8W1x1MjE5MC1cdTIxZmZdKS9nLAogICAgICAgICAgIiAiCiAgICAgICAgKTsKCiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXHVkODNkW1x1ZGUwMC1cdWRlNGZdL2csICIgIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvKFxyXG58XG58XHIpL2dtLCAiICIpOwogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIl8iLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiISIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCIqIiwgIiIpOwogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIiYiLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiIyIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCLigKIiLCAiIik7CiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiKyIsICIiKTsKICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKGBfL2xcX2AsICIiKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoCiAgICAgICAgICAvKFtcdTI3MDAtXHUyN0JGXXxbXHVFMDAwLVx1RjhGRl18XHVEODNDW1x1REMwMC1cdURGRkZdfFx1RDgzRFtcdURDMDAtXHVERkZGXXxbXHUyMDExLVx1MjZGRl18XHVEODNFW1x1REQxMC1cdURERkZdKS9nLAogICAgICAgICAgIiAiCiAgICAgICAgKTsKCiAgICAgICAgLy8gdGhpcy5mZGEgPSBhd2FpdCB0aGlzLmZpbmRmZGEoY29udGVudCk7Cgp2YXIgZGVzYyA9IHRoaXMuZmluZGRlc2NyaXB0aW9uKGNvbnRlbnQpCiAgICAgICAgdGhpcy5mZGEgPSBhd2FpdCB0aGlzLmdldGZkYShjb250ZW50KVswXQogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZmRhKTsKICAgICAgICAgIGNvbiA9IHsKICAgICAgICAgICAgY29udGVudDogZGVzYywKICAgICAgICAgIH07CiAgICAgICAgICBhd2FpdCBheGlvcwogICAgICAgICAgICAucG9zdChMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkgKyAiL3dvcmR0b2tlbmRlc2MiLCBjb24pCiAgICAgICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgLy8gdmFyIHNlbnRlbmNlID0gcmVzLmRhdGEuc2VudGVudC5yZXBsYWNlQWxsKCI8c3BhbnN0eWxlIiwgIjxzcGFuIHN0eWxlIik7CiAgICAgICAgICAgICAgdmFyIGRlcyA9IHsKICAgICAgICAgICAgICAgIHVybDogdGhpcy5kYXRhLnVybCwKICAgICAgICAgICAgICAgIHNlbnRlbmNlOiBkZXNjLAogICAgICAgICAgICAgICAgc2VudGVuY2Vfa2V5d29yZDogcmVzLmRhdGEuc2VudGVudCwKICAgICAgICAgICAgICAgIGtleXdvcmRfaWQ6IHJlcy5kYXRhLmtleXdvcmRJZCwKICAgICAgICAgICAgICAgIHN0YXR1czogMSwKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRlcyk7CiAgICAgICAgICAgICAgaWYgKHRoaXMucHJvZHVjdF90b2tlbiA9PSAwKSB7CiAgICAgICAgICAgICAgICBhd2FpdCBNYXBSdWxlQmFzZWRTZXJ2aWNlLmNyZWF0ZXByb2R1Y3RfdG9rZW4oZGVzKS50aGVuKAogICAgICAgICAgICAgICAgICBhc3luYyAocHJvZHVjdHRva2VuKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvZHVjdHRva2VuKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3RfdG9rZW4gPSBwcm9kdWN0dG9rZW4uZGF0YS5pZDsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZmRhKGNvbnRlbnQsIHRoaXMucHJvZHVjdF90b2tlbik7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvZHVjdHRva2VuKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3RfdG9rZW4gPSBwcm9kdWN0dG9rZW4uZGF0YS5pZDsKICAgICAgICAgICAgICAgICAgICBjb24gPSB7CiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBkZXNjLAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjb24pOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IGF4aW9zCiAgICAgICAgICAgICAgICAgICAgICAucG9zdChMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkgKyAiL2NoZWNra2V5d29yZCIsIGNvbikKICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgcmVzLmRhdGEubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZW50ZW5jZXRva2VuID0gcmVzLmRhdGFbcl0uc2VudGVudC5yZXBsYWNlQWxsKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW50ZW5jZXRva2VuID0gc2VudGVuY2V0b2tlbi5yZXBsYWNlQWxsKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPHNwYW5zdHlsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8c3BhbiBzdHlsZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VudGVuY2V0b2tlbiA9IHNlbnRlbmNldG9rZW4ucmVwbGFjZUFsbCgnImNvbG9yOnJlZFwiJywnImNvbG9yOnJlZCInKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFkdmVydGlzZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF90b2tlbl9pZDogdGhpcy5wcm9kdWN0X3Rva2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXl3b3JkX2RpY3RfaWQ6IHJlcy5kYXRhW3JdLmtleXdvcmRfZGljdF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGljdF9pZDogcmVzLmRhdGFbcl0uZGljdF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGljdF9uYW1lOiByZXMuZGF0YVtyXS5kaWN0X25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRlbnQ6IHNlbnRlbmNldG9rZW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbjogcmVzLmRhdGFbcl0uc2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucHJvZHVjdF90b2tlbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBBZHZlcnRpc2VTZXJ2aWNlLmNyZWF0ZWFkdmVydGlzZShhZHZlcnRpc2UpLnRoZW4oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAociArIDEgPT0gcmVzLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0cHJvdG9rZW4gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdGhpcy5wcm9kdWN0X3Rva2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IE1hcFJ1bGVCYXNlZFNlcnZpY2UuZ2V0cHJvZHVjdGtleXdvcmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldHByb3Rva2VuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLnRoZW4oYXN5bmMgKHBybykgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm8uZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy50b2tlbmRhdGEocHJvLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmdldGRldGFpbCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYXdhaXQgQWR2ZXJ0aXNlU2VydmljZS5kZWxldGVhZHZlcnRpc2UodGhpcy5wcm9kdWN0X3Rva2VuKS50aGVuKAogICAgICAgICAgICAgICAgICBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgTWFwUnVsZUJhc2VkU2VydmljZS51cGRhdHByb2R1Y3RfdG9rZW4oCiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3RfdG9rZW4sCiAgICAgICAgICAgICAgICAgICAgICBkZXMKICAgICAgICAgICAgICAgICAgICApLnRoZW4oYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgLy8gYXdhaXQgQWR2ZXJ0aXNlU2VydmljZS5kZWxldGVhZHZlcnRpc2UodGhpcy5wcm9kdWN0X3Rva2VuKS50aGVuKGFzeW5jICgpPT57CiAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkZWwpOwogICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2ZkYShjb250ZW50LCB0aGlzLnByb2R1Y3RfdG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgY29uID0gewogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBkZXNjLAogICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coY29uKTsKICAgICAgICAgICAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSArICIvY2hlY2trZXl3b3JkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBjb24KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgcmVzLmRhdGEubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbnRlbmNldG9rZW4gPSByZXMuZGF0YVsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uc2VudGVudC5yZXBsYWNlQWxsKCciJywgIiIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRlbmNldG9rZW4gPSBzZW50ZW5jZXRva2VuLnJlcGxhY2VBbGwoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxzcGFuc3R5bGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8c3BhbiBzdHlsZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbnRlbmNldG9rZW4gPSBzZW50ZW5jZXRva2VuLnJlcGxhY2VBbGwoJyJjb2xvcjpyZWRcIicsJyJjb2xvcjpyZWQiJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFkdmVydGlzZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3Rva2VuX2lkOiB0aGlzLnByb2R1Y3RfdG9rZW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5d29yZF9kaWN0X2lkOiByZXMuZGF0YVtyXS5rZXl3b3JkX2RpY3RfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGljdF9pZDogcmVzLmRhdGFbcl0uZGljdF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWN0X25hbWU6IHJlcy5kYXRhW3JdLmRpY3RfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW50ZW50OiBzZW50ZW5jZXRva2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbjogcmVzLmRhdGFbcl0uc2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5wcm9kdWN0X3Rva2VuKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWR2ZXJ0aXNlU2VydmljZS5jcmVhdGVhZHZlcnRpc2UoYWR2ZXJ0aXNlKS50aGVuKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyICsgMSA9PSByZXMuZGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldHByb3Rva2VuID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdGhpcy5wcm9kdWN0X3Rva2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXBSdWxlQmFzZWRTZXJ2aWNlLmdldHByb2R1Y3RrZXl3b3JkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldHByb3Rva2VuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkudGhlbigocHJvKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9rZW5kYXRhKHByby5kYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAvLyB9KTsKICAgICAgfQogICAgfSwKICAgIGdldE1heChhcnIsIHByb3ApIHsKICAgICAgdmFyIG1heDsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAobWF4ID09IG51bGwgfHwgcGFyc2VJbnQoYXJyW2ldW3Byb3BdKSA+IHBhcnNlSW50KG1heFtwcm9wXSkpCiAgICAgICAgICBtYXggPSBhcnJbaV07CiAgICAgIH0KICAgICAgcmV0dXJuIG1heDsKICAgIH0sCiAgICBnZXRNYXhsZW5ndGgoYXJyLCBwcm9wKSB7CiAgICAgIHZhciBtYXg7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKG1heCA9PSBudWxsIHx8IHBhcnNlSW50KGFycltpXVtwcm9wXSkgPiBwYXJzZUludChtYXhbcHJvcF0pKQogICAgICAgICAgbWF4ID0gYXJyW2ldOwogICAgICB9CiAgICAgIHJldHVybiBtYXg7CiAgICB9LAogICAgZ2V0QWxsTWF4QXJyYXkoYXJyLCB2YWx1ZSkgewogICAgICB2YXIgYXJyYXkgPSBbXTsKICAgICAgYXJyLm1hcChmdW5jdGlvbiAobnVtLCBpZHgpIHsKICAgICAgICBpZiAobnVtLmFsbGNvdW50ID09IHZhbHVlKSB7CiAgICAgICAgICBhcnJheS5wdXNoKGFycltpZHhdKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gYXJyYXk7CiAgICB9LAogICAgYXN5bmMgdG9rZW5kYXRhKGxpc3QpIHsKICAgICAgLy9jb25zb2xlLmxvZyhsaXN0KTsKICAgICAgaWYgKGxpc3Qua2V5d29yZC5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yIChsZXQgbCA9IDA7IGwgPCBsaXN0LmtleXdvcmQubGVuZ3RoOyBsKyspIHsKICAgICAgICAgIC8vY29uc29sZS5sb2cobGlzdC5rZXl3b3JkW2xdLmtleXdvcmRfZGljdF9pZCk7CiAgICAgICAgICBpZiAobGlzdC5rZXl3b3JkW2xdLmtleXdvcmRfZGljdF9pZCkgewogICAgICAgICAgICB2YXIgbWFwID0gewogICAgICAgICAgICAgIGlkOiBsaXN0LmtleXdvcmRbbF0uaWQsCiAgICAgICAgICAgICAgdXJsOiBsaXN0LmtleXdvcmRbbF0ua2V5d29yZF9kaWN0X2lkLAogICAgICAgICAgICAgIGtleXdvcmRfaWQ6IGxpc3Qua2V5d29yZFtsXS5kaWN0X2lkLAogICAgICAgICAgICB9OwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhtYXApOwogICAgICAgICAgICBhd2FpdCBNYXBSdWxlQmFzZWRTZXJ2aWNlLmdldG1hcHByb2R1Y3QobWFwKS50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgdmFyIG1heHZhbHVlID0gdGhpcy5nZXRNYXgocmVzLmRhdGEsICJhbGxjb3VudCIpOwogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG1heHZhbHVlLmFsbGNvdW50KTsKICAgICAgICAgICAgICB2YXIgaSA9IHRoaXMuZ2V0QWxsTWF4QXJyYXkocmVzLmRhdGEsIG1heHZhbHVlLmFsbGNvdW50KTsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpKTsKICAgICAgICAgICAgICB2YXIgYmVzdGRhdGEgPSB0aGlzLmdldE1heChpLCAibGVuZ3RoIik7CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYmVzdGRhdGEpOwogICAgICAgICAgICAgIC8vIGdldEFsbEluZGV4ZXMKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhiZXN0ZGF0YSk7CiAgICAgICAgICAgICAgdmFyIGJlc3QgPSB7CiAgICAgICAgICAgICAgICBpZDogbGlzdC5rZXl3b3JkW2xdLmlkLAogICAgICAgICAgICAgICAgc2VudGVuY2U6IGJlc3RkYXRhLAogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYmVzdCk7CiAgICAgICAgICAgICAgdmFyIHJ1bGVfYmFzZWRfbmFtZSA9IGJlc3RkYXRhLm5hbWUudG9TdHJpbmcoKTsKICAgICAgICAgICAgICBydWxlX2Jhc2VkX25hbWUgPSBydWxlX2Jhc2VkX25hbWUucmVwbGFjZUFsbCgiLCIsICIiKTsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhydWxlX2Jhc2VkX25hbWUpOwogICAgICAgICAgICAgIGF3YWl0IGF4aW9zCiAgICAgICAgICAgICAgICAuZ2V0KAogICAgICAgICAgICAgICAgICBMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkgKwogICAgICAgICAgICAgICAgICAgICIvbG9hZGRpY3Q/d29yZD0iICsKICAgICAgICAgICAgICAgICAgICBydWxlX2Jhc2VkX25hbWUKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgYXdhaXQgTWFwUnVsZUJhc2VkU2VydmljZS5nZXRiZXN0cnVsZWJhc2VkKGJlc3QpLnRoZW4oCiAgICAgICAgICAgICAgICAgICAgYXN5bmMgKHJlcykgPT4gewogICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgIHZhciBydWxlYmFzZWQgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50X3J1bGViYXNlZDogcmVzLmRhdGEuY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRlbmNlX3J1bGViYXNlOiByZXMuZGF0YS5zZW50ZW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgcnVsZV9iYXNlZF9pZDogcmVzLmRhdGEucnVsZV9iYXNlZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgcnVsZV9iYXNlZF9uYW1lOiByZXMuZGF0YS5ydWxlX2Jhc2VkX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcF9ydWxlX2Jhc2VkX2lkOiByZXMuZGF0YS5tYXBfaWQsCiAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocnVsZWJhc2VkKTsKICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGxpc3Qua2V5d29yZFtsXS5pZCk7CiAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYXBSdWxlQmFzZWRTZXJ2aWNlLnVwZGF0ZXJ1bGViYXNlZCgKICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5rZXl3b3JkW2xdLmlkLAogICAgICAgICAgICAgICAgICAgICAgICBydWxlYmFzZWQKICAgICAgICAgICAgICAgICAgICAgICkudGhlbihhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsICsgMSA9PSBsaXN0LmtleXdvcmQubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRkZXRhaWwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgLy8gbGlzdC5rZXl3b3JkW2xdLnJ1bGViYXNlID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgLy8gaWYgKGwgKyAxID09IGxpc3Qua2V5d29yZC5sZW5ndGgpIHsKICAgICAgICAgICAgICAvLyAgIHRoaXMuY29tcGFyZShsaXN0KTsKICAgICAgICAgICAgICAvLyB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXdhaXQgdGhpcy5nZXRkZXRhaWwoKTsKICAgICAgfQogICAgfSwKICAgIGNvbXBhcmUobGlzdCkgewogICAgICBmb3IgKGxldCBrID0gMDsgayA8IGxpc3Qua2V5d29yZC5sZW5ndGg7IGsrKykgewogICAgICAgIC8vIGNvbnNvbGUubG9nKGxpc3Qua2V5d29yZFtrXSk7CiAgICAgICAgdmFyIGRpY3RfaWQgPSBKU09OLnBhcnNlKGxpc3Qua2V5d29yZFtrXS5kaWN0X2lkKTsKICAgICAgICAvLyB2YXIgcnVsZWJhc2VkID0gSlNPTi5wYXJzZShsaXN0LmtleXdvcmRba10ucnVsZWJhc2UpCiAgICAgICAgLy8gY29uc29sZS5sb2cobGlzdC5rZXl3b3JkW2tdLnJ1bGViYXNlZCk7CiAgICAgICAgaWYgKGxpc3Qua2V5d29yZFtrXS5ydWxlYmFzZSkgewogICAgICAgICAgbGV0IHVuaXF1ZUNoYXJzcnVsZSA9IGxpc3Qua2V5d29yZFtrXS5ydWxlYmFzZS5maWx0ZXIoKGMsIGluZGV4KSA9PiB7CiAgICAgICAgICAgIHJldHVybiBsaXN0LmtleXdvcmRba10ucnVsZWJhc2UuaW5kZXhPZihjKSA9PT0gaW5kZXg7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBmaWx0ZXJlZEFycmF5ID0gZGljdF9pZC5maWx0ZXIoZnVuY3Rpb24gKG4pIHsKICAgICAgICAgICAgcmV0dXJuIHVuaXF1ZUNoYXJzcnVsZS5pbmRleE9mKG4pICE9PSAtMTsKICAgICAgICAgIH0pOwogICAgICAgICAgLy8gY29uc29sZS5sb2coZmlsdGVyZWRBcnJheSk7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZmlsdGVyZWRBcnJheScsZmlsdGVyZWRBcnJheSk7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZGljdF9pZCcsZGljdF9pZC5sZW5ndGgpOwogICAgICAgICAgLy8gY29uc29sZS5sb2coc3VtZGljdElkLmxlbmd0aCk7CiAgICAgICAgICB2YXIgcGVyY2VudGFnZSA9CiAgICAgICAgICAgICgxMDAgKiBwYXJzZUludChmaWx0ZXJlZEFycmF5Lmxlbmd0aCkpIC8gcGFyc2VJbnQoZGljdF9pZC5sZW5ndGgpOwogICAgICAgICAgLy8gY29uc29sZS5sb2cocGVyY2VudGFnZSk7CiAgICAgICAgICBsaXN0LmtleXdvcmRba10ucGVyY2VudGFnZSA9IHBlcmNlbnRhZ2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxpc3Qua2V5d29yZFtrXS5wZXJjZW50YWdlID0gMDsKICAgICAgICB9CiAgICAgICAgaWYgKGsgKyAxID09IGxpc3Qua2V5d29yZC5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMubGlzdCA9IGxpc3Q7CiAgICAgICAgICAvLyB0aGlzLnN0YXR1cyA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZ2V0QWxsSW5kZXhlcyhhcnIsIHZhbCkgewogICAgICB2YXIgaW5kZXhlcyA9IFtdLAogICAgICAgIGkgPSAtMTsKICAgICAgd2hpbGUgKChpID0gYXJyLmluZGV4T2YodmFsLCBpICsgMSkpICE9IC0xKSB7CiAgICAgICAgaW5kZXhlcy5wdXNoKGkpOwogICAgICB9CiAgICAgIHJldHVybiBpbmRleGVzOwogICAgfSwKICAgIGZpbmRmZGEoZGF0YSkgewogICAgICB2YXIgdGV4dCA9IFsi4Lir4Lih4Liy4Lii4LmA4Lil4LiC4LmD4Lia4Lit4LiZ4Li44LiN4Liy4LiVL+C4reC4oi4iLCLguK3guKIuIl07CiAgICAgIC8vIHZhciBlbmQgPSBbJyddCiAgICAgIHZhciBmaW5kZmRhID0gZGF0YTsKICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCB0ZXh0Lmxlbmd0aDsgdCsrKSB7CiAgICAgICAgZmluZGZkYSA9IGZpbmRmZGEuc3Vic3RyaW5nKGZpbmRmZGEuaW5kZXhPZih0ZXh0W3RdKSwgZGF0YS5sZW5ndGgpOwogICAgICAgIHZhciBlbmRpbmRleCA9IHRoaXMuZ2V0QWxsSW5kZXhlcyhmaW5kZmRhLCAiICIpOwogICAgICAgIGZpbmRmZGEgPSBmaW5kZmRhLnN1YnN0cmluZyhmaW5kZmRhLmluZGV4T2YodGV4dFt0XSksIGVuZGluZGV4WzFdKTsKICAgICAgfQogICAgICAvLyBjb25zb2xlLmxvZyhmaW5kZmRhKTsKCiAgICAgIGZvciAobGV0IHYgPSAwOyB2IDwgdGV4dC5sZW5ndGg7IHYrKykgewogICAgICBmaW5kZmRhID0gZmluZGZkYS5yZXBsYWNlQWxsKHRleHRbdl0sICIiKTsKICAgICAgfQogICAgICBmaW5kZmRhID0gZmluZGZkYS5yZXBsYWNlQWxsKC9bXlxkLi1dL2csICcnKTsKICAgICAgZmluZGZkYSA9IGZpbmRmZGEucmVwbGFjZUFsbCgiLSIsICIiKTsKICAgICAgZmluZGZkYSA9IGZpbmRmZGEucmVwbGFjZUFsbCgi4oCTIiwgIiIpOwogICAgICBmaW5kZmRhID0gZmluZGZkYS5yZXBsYWNlQWxsKCIgIiwgIiIpOwogICAgICAvLyBjb25zb2xlLmxvZyhmaW5kZmRhKTsKICAgICAgLy8gdmFyIHJlZ2V4ID0gL1xkKy9nOwogICAgICAvLyB2YXIgbWF0Y2hlcyA9IGZpbmRmZGEubWF0Y2gocmVnZXgpOyAgLy8gY3JlYXRlcyBhcnJheSBmcm9tIG1hdGNoZXMKICAgICAgLy8gY29uc29sZS5sb2cobWF0Y2hlc1swXSk7CiAgICAgIHJldHVybiBmaW5kZmRhOwogICAgfSwKICAgIGFzeW5jIGNoZWNrZmRhKGNvbnRlbnQsIGlkKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZmRhKTsKICAgICAgaWYgKHRoaXMuZmRhKSB7CiAgICAgICAgdmFyIGZkYSA9IHRoaXMuZmRhOwogICAgICAgIHZhciBwcm9kdWN0X3N0YXR1cyA9IDA7CiAgICAgICAgY29uc3QgdXJsID0gImh0dHBzOi8vdGF3YWlmb3JoZWFsdGgub3JnL2FwaS9vcnlvci9jaGVjay1wcm9kdWN0IjsKICAgICAgICBjb25zdCBkYXRhID0geyBudW1iZXJfc3JjOiBmZGEgfTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEFjY2VwdDogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOCIsCiAgICAgICAgICB9LAogICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksCiAgICAgICAgfTsKCiAgICAgICAgYXdhaXQgZmV0Y2godXJsLCBvcHRpb25zKQogICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpCiAgICAgICAgICAudGhlbihhc3luYyAoZGF0YSkgPT4gewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICAgICAgaWYgKGRhdGEubWVzc2FnZSB8fCBkYXRhLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICB0aGlzLnByb2R1Y3QucHVzaCh7CiAgICAgICAgICAgICAgICBuYW1lOiAiLSIsCiAgICAgICAgICAgICAgICBkZXRhaWw6IGNvbnRlbnQsCiAgICAgICAgICAgICAgICBmZGE6IHRoaXMuZmRhLAogICAgICAgICAgICAgICAgY25jbm06ICItIiwKICAgICAgICAgICAgICAgIHR5cGVwcm86ICItIiwKICAgICAgICAgICAgICAgIGxjbm5vOiAiLSIsCiAgICAgICAgICAgICAgICBwcm9kdWN0aGE6ICItIiwKICAgICAgICAgICAgICAgIHByb2R1Y2VuZzogIi0iLAogICAgICAgICAgICAgICAgbGljZW46ICItIiwKICAgICAgICAgICAgICAgIEFkZHI6ICItIiwKICAgICAgICAgICAgICAgIE5ld2NvZGU6ICItIiwKICAgICAgICAgICAgICAgIHN0YXR1czogIi0iLAogICAgICAgICAgICAgICAgdG9rZW46ICItIiwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLnByb2NoZWNrLnB1c2goewogICAgICAgICAgICAgICAgZmRhOiB0aGlzLmZkYSwKICAgICAgICAgICAgICAgIG1hcGZkYTogIi0iLAogICAgICAgICAgICAgICAgY25jbm06ICItIiwKICAgICAgICAgICAgICAgIHByb2R1Y3RoYTogIi0iLAogICAgICAgICAgICAgICAgcHJvZHVjZW5nOiAiLSIsCiAgICAgICAgICAgICAgICBuYW1lOiAiLSIsCiAgICAgICAgICAgICAgICBwcm9kdWN0X3N0YXR1czogMCwKICAgICAgICAgICAgICAgIGNhdF9zdGF0dXM6IDAsCiAgICAgICAgICAgICAgICBmZGFfc3RhdHVzOiAwLAogICAgICAgICAgICAgICAgbmFtZV9zdGF0dXM6IDAsCiAgICAgICAgICAgICAgICB0eXBlcHJvOiAiLSIsCiAgICAgICAgICAgICAgICB0eXBlOiAiLSIsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5zdGF0dXNwcm9jaGVjayA9IHRydWUKICAgICAgICAgICAgICAvLyB0aGlzLnN0YXR1cyA9IHRydWUKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhLmNuY25tLmluY2x1ZGVzKCLguITguIfguK3guKLguLnguYgiKSkKICAgICAgICAgICAgICBpZiAoZGF0YS5jbmNubS5pbmNsdWRlcygi4Lii4LiB4LmA4Lil4Li04LiBIikgfHwgZGF0YS5jbmNubS5pbmNsdWRlcygi4LmA4Lie4Li04LiB4LiW4Lit4LiZIikpIHsKICAgICAgICAgICAgICAgIHByb2R1Y3Rfc3RhdHVzID0gMzsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcHJvZHVjdF9zdGF0dXMgPSAxOwogICAgICAgICAgICAgICAgdGhpcy5jb2xvcmZkYSA9ICJiYWNrZ3JvdW5kLWNvbG9yOiNhM2U5YTQiOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmNvbG9yZmRhKTsKICAgICAgICAgICAgICB2YXIgY29uID0gewogICAgICAgICAgICAgICAgZmRhOiBmZGEsCiAgICAgICAgICAgICAgICBwcm9kdWN0aGE6IGRhdGEucHJvZHVjdGhhLAogICAgICAgICAgICAgICAgcHJvZHVjZW5nOiBkYXRhLnByb2R1Y2VuZywKICAgICAgICAgICAgICAgIHR5cGVwcm86IGRhdGEudHlwZXBybywKICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBhd2FpdCBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoTGlua1NlcnZpY2UuZ2V0cHl0aG9ubGluaygpICsgIi9jaGVja2ZkYSIsIGNvbikKICAgICAgICAgICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgICAgICAgICAgICB2YXIgcHJvID0gewogICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlcy5kYXRhLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgZmRhOiBmZGEsCiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF9zdGF0dXM6IHByb2R1Y3Rfc3RhdHVzLAogICAgICAgICAgICAgICAgICAgIGNhdF9zdGF0dXM6IHJlcy5kYXRhLm1hcGNhdHN0YXR1cywKICAgICAgICAgICAgICAgICAgICBmZGFfc3RhdHVzOiBwcm9kdWN0X3N0YXR1cywKICAgICAgICAgICAgICAgICAgICBuYW1lX3N0YXR1czogcmVzLmRhdGEubWFwbmFtZXN0YXR1cywKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvKTsKICAgICAgICAgICAgICAgICAgYXdhaXQgTWFwUnVsZUJhc2VkU2VydmljZS51cGRhdGVtYXAoaWQsIHBybykudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEucHJvZHVjdGhhICsgIiAiICsgZGF0YS5wcm9kdWNlbmcsCiAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IGNvbnRlbnQsCiAgICAgICAgICAgICAgICAgICAgICBmZGE6IGZkYSwKICAgICAgICAgICAgICAgICAgICAgIGNuY25tOiBkYXRhLmNuY25tLAogICAgICAgICAgICAgICAgICAgICAgdHlwZXBybzogZGF0YS50eXBlcHJvLAogICAgICAgICAgICAgICAgICAgICAgbGNubm86IGRhdGEubGNubm8sCiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0aGE6IGRhdGEucHJvZHVjdGhhLAogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjZW5nOiBkYXRhLnByb2R1Y2VuZywKICAgICAgICAgICAgICAgICAgICAgIGxpY2VuOiBkYXRhLmxpY2VuLAogICAgICAgICAgICAgICAgICAgICAgQWRkcjogZGF0YS5BZGRyLAogICAgICAgICAgICAgICAgICAgICAgTmV3Y29kZTogZGF0YS5OZXdjb2RlLAogICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBwcm9kdWN0X3N0YXR1cywKICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiByZXMuZGF0YS50b2tlbiwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2NoZWNrLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgZmRhOiBmZGEsCiAgICAgICAgICAgICAgICAgICAgICBtYXBmZGE6IGRhdGEubGNubm8sCiAgICAgICAgICAgICAgICAgICAgICBjbmNubTogZGF0YS5jbmNubSwKICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RoYTogZGF0YS5wcm9kdWN0aGEsCiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWNlbmc6IGRhdGEucHJvZHVjZW5nLAogICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVzLmRhdGEubmFtZSwKICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3Rfc3RhdHVzOiBwcm9kdWN0X3N0YXR1cywKICAgICAgICAgICAgICAgICAgICAgIGNhdF9zdGF0dXM6IHJlcy5kYXRhLm1hcGNhdHN0YXR1cywKICAgICAgICAgICAgICAgICAgICAgIGZkYV9zdGF0dXM6IHByb2R1Y3Rfc3RhdHVzLAogICAgICAgICAgICAgICAgICAgICAgbmFtZV9zdGF0dXM6IHJlcy5kYXRhLm1hcG5hbWVzdGF0dXMsCiAgICAgICAgICAgICAgICAgICAgICB0eXBlcHJvOiBkYXRhLnR5cGVwcm8sCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiByZXMuZGF0YS5jYXRlZ29yeSwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1c3Byb2NoZWNrID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JjYXQgPSByZXMuZGF0YS5jb2xvcmNhdDsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9ybmFtZSA9IHJlcy5kYXRhLmNvbG9ybmFtZTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnByb2R1Y3QpOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucHJvY2hlY2spOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZmRhKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgLy8gdGhpcy5zdGF0dXMgPSB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKGVycj0+ewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgICAgICB0aGlzLnN0YXR1c3Byb2NoZWNrb25lID0gdHJ1ZQogICAgICAgICAgICB0aGlzLnByb2NoZWNrdGV4dCA9ICdBcGkgdGF3YWlmb3JoZWFsdGgg4LmE4Lih4LmI4Liq4Liy4Lih4Liy4Lij4LiW4LiX4Liz4LiH4Liy4LiZ4LmE4LiU4LmJJwogICAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5wcm9kdWN0LnB1c2goewogICAgICAgICAgbmFtZTogIi0iLAogICAgICAgICAgZGV0YWlsOiBjb250ZW50LAogICAgICAgICAgZmRhOiB0aGlzLmZkYSwKICAgICAgICAgIGNuY25tOiAiLSIsCiAgICAgICAgICB0eXBlcHJvOiAiLSIsCiAgICAgICAgICBsY25ubzogIi0iLAogICAgICAgICAgcHJvZHVjdGhhOiAiLSIsCiAgICAgICAgICBwcm9kdWNlbmc6ICItIiwKICAgICAgICAgIGxpY2VuOiAiLSIsCiAgICAgICAgICBBZGRyOiAiLSIsCiAgICAgICAgICBOZXdjb2RlOiAiLSIsCiAgICAgICAgICBzdGF0dXM6ICItIiwKICAgICAgICAgIHRva2VuOiAiIiwKICAgICAgICB9KTsKICAgICAgICB0aGlzLnN0YXR1c3Byb2R1Y3QgPSB0cnVlCiAgICAgICAgdGhpcy5wcm9jaGVjay5wdXNoKHsKICAgICAgICAgIGZkYTogdGhpcy5mZGEsCiAgICAgICAgICBtYXBmZGE6ICItIiwKICAgICAgICAgIGNuY25tOiAiLSIsCiAgICAgICAgICBwcm9kdWN0aGE6ICItIiwKICAgICAgICAgIHByb2R1Y2VuZzogIi0iLAogICAgICAgICAgbmFtZTogIi0iLAogICAgICAgICAgcHJvZHVjdF9zdGF0dXM6IDAsCiAgICAgICAgICBjYXRfc3RhdHVzOiAwLAogICAgICAgICAgZmRhX3N0YXR1czogMCwKICAgICAgICAgIG5hbWVfc3RhdHVzOiAwLAogICAgICAgICAgdHlwZXBybzogIi0iLAogICAgICAgICAgdHlwZTogIi0iLAogICAgICAgIH0pOwoKICAgICAgICAvLyB0aGlzLnN0YXR1cyA9IHRydWUKICAgICAgfQogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgfSwKICAgIGdldGZkYShjb250ZW50KXsKICAgICAgICB2YXIgdHQgPSBjb250ZW50LnNwbGl0KCcgJykKCiAgICAvLyBjb25zb2xlLmxvZyh0dCk7CiAgICB2YXIgYXJyID0gW10KICAgIGZvciAobGV0IGwgPSAwOyBsIDwgdHQubGVuZ3RoOyBsKyspIHsKICAgICAgdmFyIGZpbmRmZGEgPSB0dFtsXS5yZXBsYWNlQWxsKCctJywgJycpOwogICAgICBmaW5kZmRhID0gZmluZGZkYS5yZXBsYWNlQWxsKCLigJMiLCAiIik7CiAgICAgIGZpbmRmZGEgPSBmaW5kZmRhLnJlcGxhY2VBbGwoIi4iLCAiIik7CiAgICBmaW5kZmRhID0gZmluZGZkYS5yZXBsYWNlQWxsKC9bXlxkLi1dL2csICcnKTsKICAgIC8vIGNvbnNvbGUubG9nKGZpbmRmZGEpOwogICAgaWYgKGZpbmRmZGEpIHsKICAgICAgaWYgKGZpbmRmZGEubGVuZ3RoID09IDEzKSB7CiAgICAgIGFyci5wdXNoKGZpbmRmZGEpCiAgICAgIH0KICAgIH0KICAgICAgCiAgICB9CiAgICBjb25zb2xlLmxvZyhhcnIpOwogICAgcmV0dXJuIGFycjsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgLy8gY29uc29sZS5sb2codGhpcy4kcm91dGUucGFyYW1zLmlkKTsKICAgIHRoaXMuaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQKCiAgICBQcm9kdWN0c1NlcnZpY2UuZ2V0cHJvZHVjdHN0b2tlbigpLnRoZW4oYXN5bmMgKHJlcyk9PnsKICAgICAgdGhpcy5hbGxkYXRhID0gcmVzLmRhdGEKICAgICAgdGhpcy5iYWNrID0gcGFyc2VJbnQodGhpcy5pZCktMQogICAgdGhpcy5uZXh0ID0gcGFyc2VJbnQodGhpcy5pZCkrMQogICAgfSkKICAgIFByb2R1Y3RzU2VydmljZS5nZXRwcm9kdWN0dG9rZW4odGhpcy5pZCkudGhlbihhc3luYyAocmVzKT0+ewogICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CgogICAgICB0aGlzLmRldGFpbCA9IHJlcy5kYXRhCiAgICAgIC8vIHZhciBzcGVjID0gdGhpcy5maW5kc3BlY2lmaWMocmVzLmRhdGEuc2VudGVuY2VmdWxsKQogICAgICAvLyB0aGlzLmRldGFpbC5zcGVjID0gdGhpcy5maW5kc3BlY2lmaWNsaXN0KHNwZWMpCiAgICAgIHRoaXMuZGV0YWlsLnNwZWMgPSBhd2FpdCB0aGlzLmZpbmRzcGVjaWZpYyhyZXMuZGF0YS5zZW50ZW5jZWZ1bGwpCiAgICAgIHRoaXMuZGV0YWlsLmRlc2MgPSBhd2FpdCB0aGlzLmZpbmRkZXNjcmlwdGlvbihyZXMuZGF0YS5zZW50ZW5jZWZ1bGwpCiAgICAgIHRoaXMuZmRhID0gcmVzLmRhdGEuZmRhCiAgICBhd2FpdCB0aGlzLmdldGRldGFpbCgpCiAgICBhd2FpdCB0aGlzLmNoZWNrZmRhKHJlcy5kYXRhLnNlbnRlbmNlLCB0aGlzLmlkKTsKCiAgICB9KQogICAgLy8gdmFyIGYgPSB0aGlzLmZpbmRmZGEoJ+C4q+C4oeC4suC4ouC5gOC4peC4guC5g+C4muC4reC4meC4uOC4jeC4suC4lS/guK3guKIu4LmA4Lil4LiC4LiI4LiU4LmB4LiI4LmJ4LiHIDEzLTEtMS03NTYyLTItMDAwNicpCiAgICAvLyB2YXIgdGV4dCA9IFsi4Lir4Lih4Liy4Lii4LmA4Lil4LiC4LmD4Lia4Lit4LiZ4Li44LiN4Liy4LiVL+C4reC4oi4iLCLguK3guKIuIl07CiAgICAvLyB2YXIgc2VuID0gJ+C4reC4oi4xNC0xLTAyNjYyLTItMDAyMSDguK3guKIuIDEzLTEtMS03NTYyLTItMDAwNicKICAgIC8vIHZhciBsID0gc2VuLnNwbGl0KCcgJykKICAgIC8vIGNvbnNvbGUubG9nKGwpOwogICAgLy8gdmFyIGYgPSB0aGlzLmZpbmRmZGEoc2VuKQogICAgLy8gdmFyIHRleHQgPSBbIuC4q+C4oeC4suC4ouC5gOC4peC4guC5g+C4muC4reC4meC4uOC4jeC4suC4lS/guK3guKIuIiwi4Lit4LiiLiJdOwogICAgLy8gICAvLyB2YXIgZW5kID0gWycnXQogICAgLy8gICB2YXIgZmluZGZkYSA9IHNlbjsKICAgIC8vICAgZm9yIChsZXQgdCA9IDA7IHQgPCB0ZXh0Lmxlbmd0aDsgdCsrKSB7CiAgICAvLyAgICAgY29uc29sZS5sb2coZmluZGZkYS5pbmRleE9mKHRleHRbdF0pKTsKICAgICAgICAKICAgIC8vICAgICBjb25zb2xlLmxvZyh0aGlzLmdldEFsbEluZGV4ZXMobCx0ZXh0W3RdKSk7CiAgICAvLyAgIH0KICAgIC8vIGNvbnNvbGUubG9nKGYpOwovLyAgICAgdmFyIGJlc3QgPSB7Ci8vICAgICAiaWQiOiA2NywKLy8gICAgICJzZW50ZW5jZSI6IHsKLy8gICAgICAgICAibGVuZ3RoIjogMiwKLy8gICAgICAgICAiYWxsY291bnQiOiAxMDAsCi8vICAgICAgICAgInJ1bGUiOiBbCi8vICAgICAgICAgICAgIDg4OTksCi8vICAgICAgICAgICAgIDU3Ci8vICAgICAgICAgXSwKLy8gICAgICAgICAibmFtZSI6IFsKLy8gICAgICAgICAgICAgIuC4hOC4p+C4muC4hOC4uOC4oSIsCi8vICAgICAgICAgICAgICLguJnguYnguLPguKvguJnguLHguIEiCi8vICAgICAgICAgXSwKLy8gICAgICAgICAibWFwX2lkIjogNzUKLy8gICAgIH0KLy8gfQovLyAgICAgICAgICAgICAgICAgICBNYXBSdWxlQmFzZWRTZXJ2aWNlLmdldGJlc3RydWxlYmFzZWQoYmVzdCkudGhlbigKLy8gICAgICAgICAgICAgICAgICAgICAgKHJlcykgPT4gewovLyAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpOwovLyAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgLy8gdmFyIHRleHQgPSAn4Lir4Lih4Liy4Lii4LmA4Lil4LiC4LmD4Lia4Lit4LiZ4Li44LiN4Liy4LiVL+C4reC4oi4gMTMtMS0xMzQ2NS01LTAwNTIg4LiI4Liz4LiZ4Lin4LiZ4Liq4Li04LiZ4LiE4LmJ4LiyIDQxNSDguKrguYjguIfguIjguLLguIEnCiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmZpbmRmZGEodGV4dCkpOwogICAgLy8gdGhpcy5kYXRhLnVybCA9CiAgICAvLyAgICJodHRwczovL3Nob3BlZS5jby50aC8lRTIlOTklQTYlRUYlQjglOEYlRTAlQjklODIlRTAlQjglODklRTAlQjglQTElRTAlQjklODMlRTAlQjglQUIlRTAlQjglQTElRTAlQjklODgtJUUwJUI4JTgyJUUwJUI4JUFEJUUwJUI4JTg3JUUwJUI5JTgxJUUwJUI4JTk3JUUwJUI5JTg5JUUyJTk5JUE2JUVGJUI4JThGLSVFMCVCOCU4MiVFMCVCOCVCMiVFMCVCOCVBMiVFMCVCOCU5NCVFMCVCOCVCNSVFMCVCOCVBMSVFMCVCOCVCMiVFMCVCOCU4MS0lRTAlQjglODElRTAlQjglQjIlRTAlQjklODElRTAlQjglOUYtJUUwJUI4JUE1JUUwJUI4JUI0JUUwJUI5JTgyJUUwJUI4JThCJUUwJUI5JTg4LSVFMCVCOCU5RSVFMCVCOCVBNSVFMCVCOCVCMSVFMCVCOCVBQS0lRTIlODAlOEItY29mZmVlLWxpc2hvdS0lRTAlQjglODElRTAlQjglQjIlRTAlQjklODElRTAlQjglOUYlRTAlQjglODQlRTAlQjglQTclRTAlQjglOUElRTAlQjglODQlRTAlQjglQjglRTAlQjglQTElRTAlQjglOTklRTAlQjklODklRTAlQjglQjMlRTAlQjglQUIlRTAlQjglOTklRTAlQjglQjElRTAlQjglODEtJUUwJUI4JTgxJUUwJUI4JUIyJUUwJUI5JTgxJUUwJUI4JTlGJUUwJUI4JTg0JUUwJUI4JUI4JUUwJUI4JUExJUUwJUI4JUFCJUUwJUI4JUI0JUUwJUI4JUE3LSVFMCVCOCU4MSVFMCVCOCVCMiVFMCVCOSU4MSVFMCVCOCU5RiVFMCVCOCVBNSVFMCVCOCU5NCVFMCVCOCU5OSVFMCVCOSU4OSVFMCVCOCVCMyVFMCVCOCVBQiVFMCVCOCU5OSVFMCVCOCVCMSVFMCVCOCU4MS0lRTAlQjglODElRTAlQjglQjIlRTAlQjklODElRTAlQjglOUYlRTAlQjglQTUlRTAlQjglOTQlRTAlQjglODQlRTAlQjglQTclRTAlQjglQjIlRTAlQjglQTElRTAlQjglQUQlRTAlQjklODklRTAlQjglQTclRTAlQjglOTkiOwogICAgLy8gdGhpcy5kYXRhLmNvbnRlbnQgPQogICAgLy8gICAi77iP4LiW4LmJ4Liy4LmA4Lib4LmH4LiZ4Lil4Li54LiB4LiE4LmJ4Liy4Lie4Li04Lih4LmB4Lil4LmJ4LinIOC4lOC4ueC5geC4peC4iOC4meC4meC5ieC4s+C4q+C4meC4seC4geC4peC4lOC5gOC4peC4ouC4hOC5iOC4sCDguKrguLHguYjguIfguIvguLfguYnguK3guKrguLTguJnguITguYnguLLguYHguKXguYnguKcg4LiX4Lix4LiB4LmB4LiK4LiX4Lih4Liy4LiE4Li44Lii4LiB4Lix4LiZ4LmE4LiU4LmJ4LmA4Lil4Lii4LiE4LmI4LiwIjsKICAgIC8vIC8vIHZhciB1cmwgPSB0aGlzLmRhdGEudXJsLnNwbGl0KCctaS4nKQogICAgLy8gdmFyIGNvbnRlbnQgPSB0aGlzLmRhdGEuY29udGVudC5yZXBsYWNlQWxsKAogICAgLy8gICAvKFtcdUUwMDAtXHVGOEZGXXxcdUQ4M0NbXHVERjAwLVx1REZGRl18XHVEODNEW1x1REMwMC1cdURERkZdKS9nLAogICAgLy8gICAiIgogICAgLy8gKTsKICAgIC8vIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoCiAgICAvLyAgIC8oPzpbXHUyNzAwLVx1MjdiZl18KD86XHVkODNjW1x1ZGRlNi1cdWRkZmZdKXsyfXxbXHVkODAwLVx1ZGJmZl1bXHVkYzAwLVx1ZGZmZl18W1x1MDAyMy1cdTAwMzldXHVmZTBmP1x1MjBlM3xcdTMyOTl8XHUzMjk3fFx1MzAzZHxcdTMwMzB8XHUyNGMyfFx1ZDgzY1tcdWRkNzAtXHVkZDcxXXxcdWQ4M2NbXHVkZDdlLVx1ZGQ3Zl18XHVkODNjXHVkZDhlfFx1ZDgzY1tcdWRkOTEtXHVkZDlhXXxcdWQ4M2NbXHVkZGU2LVx1ZGRmZl18XHVkODNjW1x1ZGUwMS1cdWRlMDJdfFx1ZDgzY1x1ZGUxYXxcdWQ4M2NcdWRlMmZ8XHVkODNjW1x1ZGUzMi1cdWRlM2FdfFx1ZDgzY1tcdWRlNTAtXHVkZTUxXXxcdTIwM2N8XHUyMDQ5fFtcdTI1YWEtXHUyNWFiXXxcdTI1YjZ8XHUyNWMwfFtcdTI1ZmItXHUyNWZlXXxcdTAwYTl8XHUwMGFlfFx1MjEyMnxcdTIxMzl8XHVkODNjXHVkYzA0fFtcdTI2MDAtXHUyNkZGXXxcdTJiMDV8XHUyYjA2fFx1MmIwN3xcdTJiMWJ8XHUyYjFjfFx1MmI1MHxcdTJiNTV8XHUyMzFhfFx1MjMxYnxcdTIzMjh8XHUyM2NmfFtcdTIzZTktXHUyM2YzXXxbXHUyM2Y4LVx1MjNmYV18XHVkODNjXHVkY2NmfFx1MjkzNHxcdTI5MzV8W1x1MjE5MC1cdTIxZmZdKS9nLAogICAgLy8gICAiIgogICAgLy8gKTsKICAgIC8vIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoLyhcclxufFxufFxyKS9nbSwgIiIpOwogICAgLy8gY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiXyIsICIiKTsKICAgIC8vIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIiEiLCAiIik7CiAgICAvLyBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCIqIiwgIiIpOwogICAgLy8gY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiJiIsICIiKTsKICAgIC8vIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIiMiLCAiIik7CiAgICAvLyBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKGBfL2xcX2AsICIiKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgLy8gLy8gY29uc29sZS5sb2coTGlua1NlcnZpY2UuZ2V0cHl0aG9ubGluaygpKycvd29yZHRva2VuZGVzYz90ZXh0PScgKyBjb250ZW50KTsKICAgIC8vIC8vIGF4aW9zLmdldChMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkrJy93b3JkdG9rZW5kZXNjP3RleHQ9Jytjb250ZW50KS50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgIC8vIC8vICAgY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgLy8gLy8gfSkKICAgIC8vIGNvbnNvbGUubG9nKExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSArICIvY2hlY2trZXl3b3JkP3RleHQ9IiArIGNvbnRlbnQpOwogICAgLy8gdmFyIGNvbiA9IHsKICAgIC8vICAgY29udGVudDogY29udGVudCwKICAgIC8vIH07CiAgICAvLyBheGlvcwogICAgLy8gICAucG9zdChMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkgKyAiL2NoZWNra2V5d29yZD90ZXh0PSIgKyBjb250ZW50LCBjb24pCiAgICAvLyAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgIC8vICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAvLyAgICAgLy8gICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCByZXMuZGF0YS5sZW5ndGg7IHIrKykgewogICAgLy8gICAgIC8vICAgICAgICAgdmFyIGFkdmVydGlzZSA9IHsKICAgIC8vICAgICAvLyAgICAgICAgICAgcHJvZHVjdF90b2tlbl9pZDoxLAogICAgLy8gICAgIC8vICAgICAgICAgICBrZXl3b3JkX2RpY3RfaWQ6cmVzLmRhdGFbcl0ua2V5d29yZF9kaWN0X2lkLAogICAgLy8gICAgIC8vICAgICAgICAgICBkaWN0X2lkOnJlcy5kYXRhW3JdLmRpY3RfaWQsCiAgICAvLyAgICAgLy8gICAgICAgICAgIGRpY3RfbmFtZTpyZXMuZGF0YVtyXS5kaWN0X25hbWUsCiAgICAvLyAgICAgLy8gICAgICAgICAgIHNlbjpyZXMuZGF0YVtyXS5zZW4sCiAgICAvLyAgICAgLy8gICAgICAgICAgIHNlbnRlbnQ6cmVzLmRhdGFbcl0uc2VudGVudCwKICAgIC8vICAgICAvLyAgICAgICAgIH0KICAgIC8vICAgICAvLyAgICAgICAgIEFkdmVydGlzZVNlcnZpY2UuY3JlYXRlYWR2ZXJ0aXNlKGFkdmVydGlzZSkudGhlbigocmVzKT0+ewogICAgLy8gICAgIC8vICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAvLyAgICAgLy8gICAgICAgICB9KQogICAgLy8gICAgIC8vICAgICAgIH0KICAgIC8vICAgfSk7CiAgICAvLyAvLyAgY29uc29sZS5sb2codXJsKTsKICAgIC8vIC8vICAgICB2YXIgc2VsZWN0cHJvID0gewogICAgLy8gLy8gICAgICAgdXJsOnVybFswXQogICAgLy8gLy8gICAgICB9CiAgICAvLyAvLyAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuZ2V0cHJvZHVjdF90b2tlbihzZWxlY3Rwcm8pLnRoZW4oKHJlcyk9PnsKICAgIC8vIC8vICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgIC8vIC8vIHZhciBsaXN0ID0gcmVzLmRhdGEKICAgIC8vIC8vIHRoaXMudG9rZW5kYXRhKGxpc3QpCiAgICAvLyAvLyBmb3IgKGxldCBsID0gMDsgbCA8IGxpc3Qua2V5d29yZC5sZW5ndGg7IGwrKykgewogICAgLy8gLy8gICAvLyBjb25zb2xlLmxvZyh0aGlzLmxpc3Qua2V5d29yZFtsXS5tYXApOwogICAgLy8gLy8gICAvLyBmb3IgKGxldCBtID0gMDsgbSA8IHRoaXMubGlzdC5rZXl3b3JkW2xdLmxlbmd0aDsgbSsrKSB7CiAgICAvLyAvLyAgICAgaWYgKGxpc3Qua2V5d29yZFtsXS5tYXApIHsKICAgIC8vIC8vICAgICAgIHZhciBtYXAgPSB7CiAgICAvLyAvLyAgICAgdXJsOkpTT04uc3RyaW5naWZ5KGxpc3Qua2V5d29yZFtsXS5tYXApCiAgICAvLyAvLyAgICAgIH0KICAgIC8vIC8vICAgICAvLyAgY29uc29sZS5sb2cobWFwKTsKICAgIC8vIC8vICAgICAgTWFwUnVsZUJhc2VkU2VydmljZS5nZXRtYXBwcm9kdWN0KG1hcCkudGhlbigocmVzKT0+ewogICAgLy8gLy8gICAgICAgbGlzdC5rZXl3b3JkW2xdLnJ1bGViYXNlID0gcmVzLmRhdGEKICAgIC8vIC8vICAgICAgIGlmIChsKzEgPT0gbGlzdC5rZXl3b3JkLmxlbmd0aCkgewogICAgLy8gLy8gICAgICAgICB0aGlzLmNvbXBhcmUobGlzdCkKICAgIC8vIC8vICAgICAgIH0KICAgIC8vIC8vICAgICAgfSk7CiAgICAvLyAvLyAgICAgfQogICAgLy8gLy8gICB9CiAgICAvLyAvLyB9CiAgICAvLyAvLyBjb25zb2xlLmxvZyh0aGlzLmxpc3QpOwogICAgLy8gdGhpcy5zdGF0dXMgPSB0cnVlOwogICAgLy8gLy8gIH0pCiAgfSwKfTsK"},{"version":3,"sources":["product.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"product.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"row\">\n      <div v-if=\"status\">\n        <h5 class=\"mt-3\">\n        {{detail.url}}</h5>\n        <img :src=\"detail.img_path\" style=\"width:30%\" v-if=\"detail.img_path\">\n        <div class=\"card mt-3\">\n  <div class=\"card-body\">\n    <h5 class=\"card-title\">ข้อมูลจำเพาะของสินค้า</h5>\n    <p class=\"card-text\" v-html=\"detail.spec\">\n    </p>\n\n      <!-- <span v-for=\"(s,i) in detail.spec\" :key=\"i\">{{s}}<br/></span> -->\n  </div>\n</div>\n<div class=\"card mt-3\">\n  <div class=\"card-body\">\n    <h5 class=\"card-title\">รายละเอียดสินค้า</h5>\n    <p class=\"card-text\" v-html=\"detail.desc\"></p>\n  </div>\n</div>\n<!-- <div style=\"text-align:center\" class=\"mt-3\">\n<a :href=\"'/productcheck/'+id\"> <button type=\"submit\" class=\"mb-3 btn btn-success\">\n          Train และเพิ่ม keyword ที่ผิดกฎหมาย</button\n        ></a>&nbsp;\n        <a href=\"/products\"><button type=\"submit\" class=\"mb-3 btn btn-danger\">\n          ล้างข้อมูล\n        </button></a>\n      </div> -->\n      <div>\n      <clip-loader :loading=\"loading\" :color=\"color\" :size=\"size\"></clip-loader>\n    </div>\n      <div class=\"row\">\n      <table class=\"table table-bordered mt-5\" v-if=\"statusprocheck\">\n        <thead>\n          <tr>\n            <th\n              scope=\"col\"\n              style=\"\n                text-align: center;\n                vertical-align: middle;\n                background-color: #ffb454;\n              \"\n            >\n              เงื่อนไขการตรวจสอบข้อที่ 1\n            </th>\n            <th\n              scope=\"col\"\n              style=\"\n                text-align: center;\n                vertical-align: middle;\n                background-color: #ffb454;\n              \"\n            >\n              ข้อมูลจากฐานข้อมูลอย.\n            </th>\n            <th\n              scope=\"col\"\n              style=\"\n                text-align: center;\n                vertical-align: middle;\n                background-color: #ffb454;\n              \"\n            >\n              ข้อมูลจากเว็บไซต์\n            </th>\n            <th\n              scope=\"col\"\n              style=\"\n                text-align: center;\n                vertical-align: middle;\n                background-color: #ffb454;\n              \"\n            >\n              ผลการตรวจสอบ\n            </th>\n            <th\n              scope=\"col\"\n              style=\"\n                text-align: center;\n                vertical-align: middle;\n                background-color: #ffb454;\n              \"\n            >\n              ข้อสรุป\n            </th>\n          </tr>\n        </thead>\n        <!-- {{procheck}} -->\n        <tbody>\n          <tr v-for=\"(p,o) in procheck\" :key=\"o\">\n            <td :style=\"colorfda\">เลขที่อนุญาต</td>\n            <td :style=\"colorfda\">{{ p.mapfda }}</td>\n            <td :style=\"colorfda\">{{ p.fda }}</td>\n            <td :style=\"colorfda\">{{ p.cncnm }}</td>\n            <td\n              v-if=\"\n                p.cat_status &&\n                p.name_status &&\n                p.fda_status == 1\n              \"\n              rowspan=\"3\"\n              style=\"\n                text-align: center;\n                vertical-align: middle;\n                background-color: #a3e9a4;\n              \"\n            >\n              <span>ผ่าน</span>\n            </td>\n            <td\n              v-else\n              rowspan=\"3\"\n              style=\"\n                text-align: center;\n                vertical-align: middle;\n                background-color: #f9bdbb;\n              \"\n            >\n              <span>ไม่ผ่าน</span>\n            </td>\n          </tr>\n          <tr v-for=\"(pp,oo) in procheck\" :key=\"oo+10\">\n            <td :style=\"colorcat\">ประเภทผลิตภัณฑ์</td>\n            <td :style=\"colorcat\">{{ pp.typepro }}</td>\n            <td :style=\"colorcat\">\n              <span v-if=\"pp.typepro\">{{ pp.type }}</span\n              ><span v-else>-</span>\n            </td>\n            <td :style=\"colorcat\">\n              <span v-if=\"pp.cat_status\">ผ่าน</span\n              ><span v-else>ไม่ผ่าน</span>\n            </td>\n          </tr>\n          <tr v-for=\"(ppp,ooo) in procheck\" :key=\"ooo+20\">\n            <td :style=\"colorname\">ชื่อผลิตภัณฑ์</td>\n            <td :style=\"colorname\">\n              {{ ppp.productha }}<br />{{ ppp.produceng }}\n            </td>\n            <td :style=\"colorname\"><span v-html=\"ppp.name\"></span></td>\n            <td :style=\"colorname\">\n              <span v-if=\"ppp.name_status\">ผ่าน</span\n              ><span v-else>ไม่ผ่าน</span>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <div style=\"text-align:center\" v-if=\"statusprocheckone && statuslist\"><span> เงื่อนไขการตรวจสอบข้อที่ 1 ไม่สามารถตรวจสอบได้ เนื่องจาก {{prochecktext}}</span></div>\n      <table class=\"table table-bordered mt-3 mb-5\" v-if=\"statuslist\">\n        <tbody>\n          <tr>\n            <th style=\"background-color: #ffb454; vertical-align: middle\">\n              เงื่อนไขการตรวจสอบข้อที่ 2\n            </th>\n            <th style=\"background-color: #ffb454; vertical-align: top\">\n              ข้อความโฆษณา\n            </th>\n            <th style=\"background-color: #ffb454; vertical-align: middle\">\n              ข้อความโฆษณาเกินจริง<br>\n              <div style=\"text-align: right;\">\n                    <button\n                      data-bs-toggle=\"modal\"\n                      data-bs-target=\"#AddScopusToken\"\n                      type=\"submit\"\n                      class=\"mb-3 btn btn-success\"\n                    >\n                      <i class=\"fa fa-plus\" aria-hidden=\"true\">\n                        เพิ่ม keyword</i\n                      >\n                    </button>\n                  </div>\n            </th>\n          </tr>\n          <tr>\n            <td :style=\"colorkey\">รายละเอียดสินค้า</td>\n            <td :style=\"colorkey\" style=\"width: 40%\">\n              <span v-html=\"list.sentence_keyword\"></span>\n            </td>\n            <!-- <th :style=\"colorkey\">ข้อความโฆษณา</th> -->\n            <!-- {{list}} -->\n            \n            <td :style=\"colorkey\" v-if=\"list.keyword != 1\">\n             \n              <tr v-for=\"(k, i) in list.keyword\" :key=\"i\">\n                <td>\n                  <span v-html=\"k.sentence_rulebase\"></span><br /><br />\n                  <span v-html=\"getsentent(k.rule_based_name)\"></span>\n                  <!-- <span v-for=\"(s, idx) in k.rule_based_name\" :key=\"idx\">{{\n                    s\n                  }}</span> -->\n                  <br /><br />\n                  <!-- <span>{{getstatuscheck(k.statustrue,k.statusfalse)}}</span> -->\n                  <span>{{getstatuscheck(k.statustrue,k.statusfalse)}}</span>\n                  <span>ตรงกฎ</span>\n                  <span v-if=\"k.count_rulebased\"\n                    > {{ getpercentage(k) }}%</span\n                  ><br /><br />\n                  <!-- <div style=\"text-align: left\">\n                    <button\n                      data-bs-toggle=\"modal\"\n                      data-bs-target=\"#AddScopusToken\"\n                      type=\"submit\"\n                      class=\"mb-3 btn btn-success\"\n                    >\n                      <i class=\"fa fa-plus\" aria-hidden=\"true\">\n                        เพิ่ม keyword</i\n                      >\n                    </button>\n                  </div> -->\n                </td>\n                <td>\n                  \n                  <!-- <span>{{getstatuscheck(k.statustrue,k.statusfalse)}}</span> -->\n                  \n                  <span v-if=\"k.answer == 1\">เกินจริง</span\n                  ><span v-if=\"k.answer == 9\">ไม่เกินจริง</span\n                  ><span v-if=\"k.answer == 0\"></span>\n                </td>\n\n                <td>\n                  <button\n                    @click=\"savetorule_based(k, 1)\"\n                    type=\"submit\"\n                    class=\"mb-3 btn btn-success\"\n                  >\n                    <i class=\"fa fa-check\"></i></button\n                  >&nbsp;\n                  <button\n                    @click=\"savetorule_based(k, 9)\"\n                    type=\"submit\"\n                    class=\"mb-3 btn btn-danger\"\n                  >\n                    <i class=\"fa fa-times\"></i>\n                  </button>\n                </td>\n              </tr>\n            </td>\n            <td :style=\"colorkey\" v-else>\n              <!-- <div style=\"text-align: right;\">\n                    <button\n                      data-bs-toggle=\"modal\"\n                      data-bs-target=\"#AddScopusToken\"\n                      type=\"submit\"\n                      class=\"mb-3 btn btn-success\"\n                    >\n                      <i class=\"fa fa-plus\" aria-hidden=\"true\">\n                        เพิ่ม keyword</i\n                      >\n                    </button>\n                  </div> -->\n              <tr>\n                ไม่พบข้อความโฆษณาเกินจริง\n                <br /><br />\n                  <!-- <div style=\"text-align: left\">\n                    <button\n                      data-bs-toggle=\"modal\"\n                      data-bs-target=\"#AddScopusToken\"\n                      type=\"submit\"\n                      class=\"mb-3 btn btn-success\"\n                    >\n                      <i class=\"fa fa-plus\" aria-hidden=\"true\">\n                        เพิ่ม keyword</i\n                      >\n                    </button>\n                  </div> -->\n              </tr>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <table class=\"table mt-3\" v-if=\"statusproduct\">\n        <thead>\n          <tr>\n            <th scope=\"col\">สินค้า</th>\n            <th scope=\"col\">ข้อมูล</th>\n            <th scope=\"col\">FDA</th>\n            <th scope=\"col\">ตัดคำ</th>\n            <th scope=\"col\">ข้อมูลจากฐานข้อมูลอย.</th>\n            <!-- <th scope=\"col\"></th> -->\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"(l, i) in product\" :key=\"i\">\n            <td :style=\"l.bg\">{{ l.name }}</td>\n            <td :style=\"l.bg\">{{ l.detail }}</td>\n            <!-- <td :style=\"l.bg\">\n              <div class=\"row\">\n          <div class=\"col-md-2\" v-for=\"(im ,i) in imagelists\" :key=\"i\">\n            <img :src=\"im\" width=\"100%\"/>\n          </div>\n        </div>\n            </td> -->\n            <td :style=\"l.bg\" style=\"width: 300px\">\n              <div>\n                เลขที่อนุญาต : {{ l.fda }}<br />\n                <!-- ชื่อผลิตภัณฑ์: <span v-html=\"matchname\"></span> -->\n                <!-- ชื่อผลิตภัณฑ์: {{l.productha}} -->\n              </div>\n            </td>\n            <td :style=\"l.bg\">{{ cut(l.token) }}</td>\n            <td\n              style=\"background-color: #bdedff\"\n              v-if=\"l.status == 1 || l.status == 3\"\n            >\n              <p class=\"card-text\">สถานะ : {{ l.cncnm || \"\" }}</p>\n              <p class=\"card-text\">\n                ประเภทผลิตภัณฑ์ :<span> {{ l.typepro }}</span>\n              </p>\n              <p class=\"card-text\">\n                ใบสำคัญ/เลขที่อนุญาต : <span> {{ l.lcnno }}</span>\n              </p>\n              <p class=\"card-text\">\n                ชื่อผลิตภัณฑ์ (TH) : <span> {{ l.productha }}</span>\n              </p>\n              <p class=\"card-text\">\n                ชื่อผลิตภัณฑ์ (EN) : <span> {{ l.produceng }}</span>\n              </p>\n              <p class=\"card-text\">ชื่อผู้รับอนุญาต : {{ l.licen }}</p>\n              <p class=\"card-text\">สถานที่ผลิต : {{ l.Addr }}</p>\n              <p class=\"card-text\">Newcode : {{ l.Newcode }}</p>\n            </td>\n            <td :style=\"l.bg\" v-else>ไม่พบข้อมูล</td>\n            <!-- <td :style=\"l.bg\">\n            <i class=\"fa fa-circle\" :style=\"l.icon\" aria-hidden=\"true\"></i>\n          </td> -->\n          </tr>\n        </tbody>\n      </table>\n      <div class=\"row\" v-if=\"id\">\n      <div class=\"col-md-6\">\n        <a :href=\"'/product/'+back\"> <button type=\"submit\" class=\"mb-3 btn btn-info\" v-if=\"id !=1\">\n          <i class=\"fa fa-arrow-left\" aria-hidden=\"true\"></i>\n            </button></a>\n      </div>\n      <div class=\"col-md-6\" style=\"text-align: right;\" v-if=\"id < alldata.length\">\n        <a :href=\"'/product/'+next\"><button type=\"submit\" class=\"mb-3 btn btn-info\" >\n              <i class=\"fa fa-arrow-right\" aria-hidden=\"true\"></i>\n            </button></a></div>\n    </div>\n      <!-- Modal -->\n      <div\n        class=\"modal fade\"\n        id=\"AddScopusToken\"\n        tabindex=\"-1\"\n        aria-labelledby=\"exampleModalLabel\"\n        aria-hidden=\"true\"\n      >\n        <div class=\"modal-dialog\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h5 class=\"modal-title\" id=\"exampleModalLabel\">{{ title }}</h5>\n            </div>\n            <div class=\"modal-body\">\n              <form>\n                <div class=\"card-body mt-3\">\n                  <div class=\"form-group mt-3\">\n                    <label>ข้อความ</label>\n                    <input\n                      v-model=\"key.name\"\n                      type=\"text\"\n                      min=\"1\"\n                      class=\"form-control form-control-sm\"\n                    />\n                  </div>\n                </div>\n              </form>\n            </div>\n            <div class=\"modal-footer mt-3\">\n              <button type=\"button\" class=\"btn btn-success\" @click=\"save()\">\n                บันทึก\n              </button>\n              <button\n                id=\"closedcategory\"\n                type=\"button\"\n                class=\"btn btn-secondary\"\n                data-bs-dismiss=\"modal\"\n              >\n                ปิด\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n// import ProductsService from '../services/ProductsService.js'\nimport DictService from \"../services/DictService\";\nimport RuleBasedService from \"../services/RuleBasedService\";\nimport MapRuleBasedService from \"../services/MapRuleBasedService\";\nimport LinkService from \"../services/LinkService\";\nimport AdvertiseService from \"../services/AdvertiseService\";\nimport KeywordService from \"../services/KeywordService\";\nimport FDATypesService from \"../services/FDATypesService\";\nimport ProductsService from \"../services/ProductsService\";\nimport ClipLoader from 'vue-spinner/src/ClipLoader.vue'\nimport MapRuleBasedUserService from \"../services/MapRuleBasedUserService\";\n\nexport default {\n  name: \"App\",\n  components: {\n    ClipLoader\n  },\n  data() {\n    return {\n      statusprocheck:false,\n      statuslist:false,\n      statusproduct:false,\n      statusprocheckone:false,\n      color: '#5bc0de',\n      size: '50px',\n      margin: '2px',\n      radius: '2px',\n      loading:true,\n      list: [],\n      url: \"\",\n      file: \"\",\n      status: false,\n      urlPath: \"\",\n      imagelists: \"\",\n      tokenize: \"\",\n      matchname: \"\",\n      matchcategory: \"\",\n      type: \"\",\n      matchnamesum: \"\",\n      statusname: 0,\n      statuscat: 0,\n      statusfda: 0,\n      colorname: \"background-color:#f9bdbb\",\n      colorfda: \"background-color:#f9bdbb\",\n      colorcat: \"background-color:#f9bdbb\",\n      id: \"\",\n      keyword: [],\n      colorkey: \"background-color:#f9bdbb\",\n      desc: \"\",\n      arrList: [],\n      alldata: 0,\n      back: 0,\n      next: 0,\n      data: {},\n      product_token: 0,\n      title: \"เพิ่ม keyword\",\n      key: {},\n      fda: \"\",\n      product: [],\n      procheck: [],\n      answer:'',\n      typeId:0,\n      prochecktext:'',\n      detail:{}\n    };\n  },\n  computed: {\n    currentUser() {\n      return this.$store.state.auth.user;\n    },\n  },\n  methods: {\n    getsentent(data){\n      data = JSON.parse(data)\n      // var text = ''\n      var arr =[]\n      for (let d = 0; d < data.length; d++) {\n        // text += data[d]\n        arr.push(data[d])\n      }\n      // console.log(arr);\n      var arrtxt = String(arr)\n      // console.log(arrtxt);\n      arrtxt = arrtxt.replaceAll(\",\",\"<span style='color:red;'> | </span>\")\n      // console.log(arrtxt);\nreturn arrtxt\n    },\n    getstatuscheck(t,f){\n      // console.log(t,f);\n      var text = ''\nif (t == f) {\n  text = 'เกินจริง'\n}else if (t > f) {\n  text = 'เกินจริง'\n}else if (f > t) {\n  text = 'ไม่เกินจริง'\n}\nreturn text\n    },\n    clear() {\n      this.data = [];\n      this.product = [];\n      this.procheck = [];\n      this.loading = false;\n      this.status = false\n    },\n    cut(data) {\n      // console.log(data);\n      var mapname = ''\n      if (data != '-' && data != '') {\n        data = data.filter((letter) => letter !== \" \");\n      mapname = data.toString();\n\n      mapname = mapname.replaceAll(\",\", \" | \");\n      }else{\n        mapname = data\n      }\n      \n      return mapname;\n    },\n    save() {\n      //console.log(this.key);\n      if (this.key.name == null || this.key.name == \"\") {\n        alert(\"กรุณากรอกข้อความ\");\n      } else {\n        var prodata = {\n          name: this.key.name,\n          status: 1,\n        };\n        //console.log(prodata);\n        KeywordService.createkeyword(prodata).then((res) => {\n          //console.log(res.data);\n          if (res.data.err == 1062) {\n            alert(\"มีคำนี้ในระบบแล้ว\");\n          } else {\n            DictService.createdict(prodata).then(() => {\n              //console.log(res.data );\n              // RuleBasedService.createdcolumnrule_based(res.data.id).then(() => {\n\n              document.getElementById(\"closedcategory\").click();\n              alert(\"บันทึกสำเร็จ\");\n              // })\n            });\n          }\n        });\n      }\n    },\n    getpercentage(data) {\n      // var dict = JSON.parse(data.dict_id)\n      // var rule_based_id = JSON.parse(data.rule_based_id)\n      // var re = (100 * data.count_rulebased)/ (rule_based_id.length)\n      return data.count_rulebased;\n    },\n    savetorule(sen, answer) {\n      // console.log(answer);\n      var iddata = [];\n\n      for (let d = 0; d < sen.length; d++) {\n        // console.log(datasplit[d]);\n        DictService.getdicts(\"\", sen[d]).then(async (res) => {\n          if (res.data.length > 0) {\n            // console.log(res.data[0].id);\n            iddata.push(res.data[0].id);\n          }\n          // console.log(d+1 , sen.length);\n          // console.log(iddata);\n          if (d + 1 == sen.length) {\n            var sql = `SELECT r.* FROM map_rule_based m join rule_based r on m.rule_based_id = r.id WHERE m.status = 1 and dict_id = '[${iddata}]'`;\n            // console.log(sql);\n\n            await RuleBasedService.getbydict(sql).then((res) => {\n              if (res.data.length == 0) {\n                let text = \"\";\n                text += \"{\";\n                for (let i = 0; i < iddata.length; i++) {\n                  // console.log(iddata[i]);\n                  text += '\"dict' + iddata[i] + '\"' + \":\" + 1 + \",\";\n                }\n                text += '\"answer' + '\"' + \":\" + answer + \",\";\n                text = text.slice(0, -1);\n                text += \"}\";\n                // console.log(text);\n                let jsonData = JSON.parse(text);\n                // console.log(jsonData);\n                RuleBasedService.createrule_based(jsonData).then((res) => {\n                  var maprule = {\n                    rule_based_id: res.data.id,\n                    dict_id: iddata,\n                    status: 1,\n                  };\n                  MapRuleBasedService.createmap_rule_based(maprule).then(() => {\n                    // console.log(res.data);\n                    // var pro = {\n                    //   map_rule_based:res.data.id\n                    // }\n                    // ProductsService.map_rule_based(id,pro).then(() => {\n                    alert(\"บันทึกสำเร็จ\");\n\n                    this.getdata();\n                    //               setTimeout(function () {\n                    //   location.reload();\n                    // }, 500);\n                    // });\n                  });\n                });\n              } else {\n                // console.log(res.data);\n                var updatemaprule = {\n                  answer: answer,\n                };\n                RuleBasedService.updaterule_based(\n                  res.data[0].id,\n                  updatemaprule\n                ).then(() => {\n                  alert(\"บันทึกสำเร็จ\");\n\n                  this.getdata();\n                });\n              }\n            });\n          }\n        });\n      }\n    },\n    async savetorule_based(data, answer) {\n      this.answer = answer\n      // console.log(sen.length);\n      // console.log('answer',answer);\n      // console.log(data);\n      var datas = {\n        name :data.rule_based_id,\n        typeId:this.typeId,\n        advertiseId:data.id\n      }\n      \n      // if (!data.mapId) {\n        await MapRuleBasedService.checkintb(data.dict_id).then(async (check) => {\n          // console.log(check.data);\n          var statusfalse = 0\n          var statustrue = 0\n          var weight = 0\n          var advertise_id = []\n          if (check.data) {\n            advertise_id = JSON.parse(check.data.map_advertise)\n          statusfalse = check.data.statusfalse\n          statustrue = check.data.statustrue\n          datas.rulebasedId = check.data.id\n          }\n          if (answer == 1) {\n            statustrue = statustrue+ parseInt(1)\n          }\n          if (answer == 9) {\n            statusfalse = statusfalse + parseInt(1)\n          }\n          // console.log(advertise_id);\n          advertise_id.push(data.id)\n          // console.log(advertise_id);\n          weight = statusfalse+statustrue\n          var maprule = {\n        keyword_id: 1,\n        advertise_id: data.id,\n        status: 9,\n        answer: answer,\n        user: this.currentUser.id,\n        map_dict: JSON.parse(data.dict_id),\n        statusfalse:statusfalse,\n        statustrue:statustrue,\n        weight:weight,\n        map_advertise: advertise_id,\n      };\n      var mapruleuser = {\n        advertiseId: data.id,\n        map_rule_basedId: check.data.id,\n        answer: answer,\n        userId: this.currentUser.id,\n      };\n          if (check.data) {\n            if (data.map_rule_based_userId) {\n  MapRuleBasedUserService.updatemap_rule_based_user(data.map_rule_based_userId,mapruleuser).then(\n          async () => {\n            // await this.getdetail();\n            // alert(\"บันทึกสำเร็จ\");\n          });\n}else{\n  MapRuleBasedUserService.createmap_rule_based_user(mapruleuser).then(\n          async () => {\n           \n          });\n}\nawait MapRuleBasedService.updateanswer(check.data.id, maprule).then(\n          async () => {\n     await KeywordService.updateweight(1,datas).then(async ()=>{\n            // console.log(res);\n            await this.getdetail();\n            alert(\"บันทึกสำเร็จ\");\n          })\n        });\n          } else {\n            MapRuleBasedService.createmap_rule_based(maprule).then(\n              async (res) => {\n                // console.log(res.data);\n                var map_id = res.data.id;\n                var mapruleusercreate = {\n        advertiseId: data.id,\n        map_rule_basedId: map_id,\n        answer: answer,\n        userId: this.currentUser.id,\n      };\n                MapRuleBasedUserService.createmap_rule_based_user(mapruleusercreate).then(\n          async () => {\n                datas.rulebasedId = map_id\n                var sendata = JSON.parse(data.dict_id);\n                // console.log(sendata);\n                // console.log(dict_name);\n                for (let d = 0; d < sendata.length; d++) {\n                  // console.log(sendata[d]);\n                  if (sendata[d]) {\n                    await DictService.getdict(sendata[d]).then(async (sen) => {\n                    // console.log(sen.data);\n                    var rule = {\n                      map_rule_based_id: map_id,\n                      dict_id: sendata[d],\n                      dict_name: sen.data.name,\n                      no: d + 1,\n                    };\n                    // console.log(rule);\n                    await RuleBasedService.createrule_based(rule).then(async () => {\n                      if (d + 1 == sendata.length) {\n                        await KeywordService.updateweight(1,datas).then(async (res)=>{\n            console.log(res);\n            await this.getdetail();\n            alert(\"บันทึกสำเร็จ\");\n          })\n                      }\n                      \n                    });\n                  });\n                  \n                  }\n                }\n              });\n              }\n            \n            );\n          }\n          \n          \n        });\n     \n        // } else {\n      //   MapRuleBasedService.deletemap_rule_based(data.mapId, maprule).then(\n      //     async () => {\n      //       // console.log(res.data);\n      //       this.getdetail();\n      //       alert(\"บันทึกสำเร็จ\");\n      //     }\n      //   );\n      // }\n    },\n    checkkeyword(name) {\n      // console.log(name);\n      //   axios.get('http://localhost:8081/api/keyword_dicts?name=1').then((res) => {\n      //     console.log(res.data);\n      // for (let r = 0; r < res.data.length; r++) {\n      // name = name.replaceAll(/([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g, '')\n      //       name = name.replaceAll(/(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g, '');\n      //       name = name.replaceAll(/(\\r\\n|\\n|\\r)/gm, \"\");\n      //       name = name.replaceAll(\"_\", \"\");\n      //       name = name.replaceAll(\"!\", \"\");\n      //       name = name.replaceAll(\"*\", \"\");\n      // name = name.replaceAll(`_/l\\_`, \"\");// eslint-disable-line\n      // console.log('http://127.0.0.1:5000/checkkeyword?text=' + name);\n      var desc = this.finddescription(name);\n      // console.log('http://127.0.0.1:5000/worktokendesc?text='+desc);\n      axios\n        .get(LinkService.getpythonlink() + \"/worktokendesc?text=\" + desc)\n        .then((res) => {\n          // console.log(res.data);\n          this.desc = res.data;\n        });\n      // name = 'ข้อมูลจำเพาะของสินค้า หมวดหมู่ Shopee กลุ่มผลิตภัณฑ์เพื่อสุขภาพ อาหารเสริมเพื่อความงาม ผิว ยี่ห้อ Bluebird(บลูเบิร์ด) Storage Condition Normal ประเภทสารอาหาร สารต้านอนุมูลอิสระ, วิตามินซี ประเทศต้นกำเนิดสินค้า ไทย หน้าที่ของอาหารเสริมสำหรับความงาม ดูแลสิว, ป้องกันริ้วรอย ประเภทการห่อ ห่อรวมกัน เพศ ทั้งสองเพศ อายุการเก็บรักษา 12 เดือน ประเภทของผลิตภัณฑ์ยา แคปซูล หมายเลขใบอนุญาต/อย. 30-1-26764-5-0051 จำนวนสินค้า 17901 ส่งจาก จังหวัดนครราชสีมา รายละเอียดสินค้า วิตามินซี พลัส ตรา บลูเบิร์ด ตรา บลูเบิร์ด ขนาด 1000 มิลลิกรัม 60 แคปซูล เรทขายส่ง ช่วงราคาที่ 1 สั่งซื้อตั้งแต่ 5 กระปุกขึ้นไป ถึง 20 กระปุก ราคากระปุกละ 93 บาท ช่วงราคาที่ 2 สั่งซื้อตั้งแต่ 21 กระปุกขึ้นไป ถึง 50 กระปุก ราคากระปุกละ 90 บาท ช่วงราคาที่ 3 สั่งซื้อตั้งแต่ 51 กระปุกขึ้นไป ถึง 100 กระปุก ราคากระปุกละ 87 บาท ช่วงราคาที่ 4 สั่งซื้อตั้งแต่ 100 กระปุกขึ้นไป ..................... ราคากระปุกละ 85 บาท Vitamin C Plus Dietary Supplement Product Bluebird Brand ผลิตภัณฑ์เสริมอาหารวิตามินซี พลัส ตรา บลูเบิร์ด ส่วนประกอบทั้งหมดใน 1 แคปซูล ส่วนประกอบที่สำคัญ (Active Ingredient) VITAMIN C (100%) - 60 มิลลิกรัม CITRUS BIOFLAVONOID POWDER - 630 มิลลิกรัม BARBADOSCHERRY POWDER/ACEROLA CHERRY POWDER (ผงบาร์เบโดสเชอร์รี/ผงอะเซโรลาเชอร์รี) (MALPIGHIA GLABRA L.) ผล - 60 มิลลิกรัม ROSEHIP POWDER (ผงโรสฮิปส์) (ROSA CANINA L.) ผล - 60 มิลลิกรัม Rutin - 30 มิลลิกรัม INDIAN GOOSEBERRY POWDER (ผงมะขามป้อม) (PHYLLANTHUS EMBLICA L. ) ผล - 60 มิลลิกรัม ส่วนประกอบที่ไม่สำคัญ (Inactive Ingredient) EDIBLE GELATIN 428 - 98.5 มิลลิกรัม TITANIUM DIOXIDE 171 -1.95 มิลลิกรัม วิธีรับประทาน ครั้งละ 1-2 แคปซูล หลังอาหารเช้า เลขที่ อ.ย. 30-1-26764-5-0051 คำเตือน ควรเก็บให้พ้นแสงแดงและความชื้น เด็ก สตรีมีครรภ์ และสตรีให้นมบุตรไม่ควรรับประทาน ควรกินอาหารหลากหลายให้ครบ 5 หมู่ ในสัดส่วนที่เหมาะสมเป็นประจำ ไม่มีผลในการป้องกันหรือรักษาโรค สรรพคุณ ประโยชน์ของการกินวิตามินซี ️ทำให้หน้าไม่โทรม หน้าตาสดใส ️ช่วยฟื้นฟูผิวหน้า สิว ฝ้า กระ ริ้วรอย ดูจางลง ️ผิวพรรณนุ่มเรียบเนียบ ชุ่มชื่น ️หน้าตาดูเด็กและเด้งขึ้น ️ผิวหน้าขาวอมชมพู สินค้าตัดรอบทุกวันเวลา ตัดรอบเวลา 12.00 น ของทุกวัน แจ้งโอนเกินเวลา ส่งรอบวันถัดไปนะจ๊ะ ส่งพัสดุทุกวัน เว้นวันอาทิตย์ และวันหยุดนักขัตฤกษ์ ขอบพระคุณลูกค้าทุกท่าน ที่ไว้วางใจผลิตภัณฑ์ของเราเสมอมา_/l\\_'\n      // console.log('http://127.0.0.1:5000/checkkeyword?text=' + desc);\n      var con = {\n        content: desc,\n      };\n      axios\n        .post(LinkService.getpythonlink() + \"/checkkeyword?text=\", con)\n        .then((res) => {\n          // console.log(res.data);\n          if (res.data.length > 0) {\n            // this.keyword.push(res.data)\n            this.keyword = res.data;\n          }\n        });\n      //     }\n\n      // });\n      //       var listkeywords = []\n      //       var namesplit = name.split(\" \")\n      //       // console.log(namesplit);\n      //       axios.get('http://localhost:8081/api/keyword_dicts?name=1').then((res) => {\n      //         console.log(res.data);\n      //         var keylist = []\n      //         for (let r = 0; r < res.data.length; r++) {\n      //           res.data[r].name = res.data[r].name.replaceAll(\".\",\"\")\n      //           var kk = res.data[r].name.split(\" \")\n      //           for (let k = 0; k < kk.length; k++) {\n      //             keylist.push(kk[k])\n      //           }\n      //         }\n      //         for (let key = 0; key < keylist.length; key++) {\n      //           for (let n = 0; n < namesplit.length; n++) {\n      //             if (namesplit[n] == keylist[key] && keylist[key] != '' && isNaN(keylist[key])) {\n      //               listkeywords.push(keylist[key])\n      //             }\n\n      //           }\n      //         }\n      //         // console.log(keylist);\n      //         // console.log(listkeywords);\n\n      //       console.log(listkeywords.length);\n      //         if (listkeywords.length == 0) {\n\n      //           this.colorkey = \"background-color:#a3e9a4\"\n      //         }\n      //         var result = [];\n      //         listkeywords.forEach(function(item) {\n      //      if(result.indexOf(item) < 0) {\n      //          result.push(item);\n      //      }\n      // });\n      // console.log(result);\n      // listkeywords = result\n      //         for (let l = 0; l < listkeywords.length; l++) {\n      //           // console.log('http://127.0.0.1:5000/checkkeyword?name=' + name+'&&name_real=');\n      //           axios.get('http://127.0.0.1:5000/checkkeyword?name=' + name+'&&name_real=' + listkeywords[l]).then((res) => {\n      //             // console.log(res.data);\n      //         this.keyword.push(res.data)\n      //       });\n\n      //         }\n      //       });\n    },\n    find(){\nvar type = this.findtypeproduct(this.data.content)\nconsole.log(type);\nvar split = type.split(\"\\n\")\nconsole.log(split[3]);\n      var content = \"\";\n        content = this.data.content.replaceAll(\n          /([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g,\n          \"\"\n        );\n        content = content.replaceAll(\n          /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g,\n          \" \"\n        );\n\n        content = content.replaceAll(/\\ud83d[\\ude00-\\ude4f]/g, \" \");\n        content = content.replaceAll(/(\\r\\n|\\n|\\r)/gm, \" \");\n        content = content.replaceAll(\"_\", \"\");\n        content = content.replaceAll(\"!\", \"\");\n        content = content.replaceAll(\"*\", \"\");\n        content = content.replaceAll(\"&\", \"\");\n        content = content.replaceAll(\"#\", \"\");\n        content = content.replaceAll(\"•\", \"\");\n        content = content.replaceAll(\"+\", \"\");\n        content = content.replaceAll(`_/l\\_`, \"\"); // eslint-disable-line\n        content = content.replaceAll(\n          /([\\u2700-\\u27BF]|[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2011-\\u26FF]|\\uD83E[\\uDD10-\\uDDFF])/g,\n          \" \"\n        );\nconsole.log(this.finddescription(content));\n    },\n    async checkkey(){\n      await this.loaddict();\n      var content = \"\";\n        content = this.data.content.replaceAll(\n          /([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g,\n          \"\"\n        );\n        content = content.replaceAll(\n          /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g,\n          \" \"\n        );\n\n        content = content.replaceAll(/\\ud83d[\\ude00-\\ude4f]/g, \" \");\n        content = content.replaceAll(/(\\r\\n|\\n|\\r)/gm, \" \");\n        content = content.replaceAll(\"_\", \"\");\n        content = content.replaceAll(\"!\", \"\");\n        content = content.replaceAll(\"*\", \"\");\n        content = content.replaceAll(\"&\", \"\");\n        content = content.replaceAll(\"#\", \"\");\n        content = content.replaceAll(\"•\", \"\");\n        content = content.replaceAll(\"+\", \"\");\n        content = content.replaceAll(`_/l\\_`, \"\"); // eslint-disable-line\n        content = content.replaceAll(\n          /([\\u2700-\\u27BF]|[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2011-\\u26FF]|\\uD83E[\\uDD10-\\uDDFF])/g,\n          \" \"\n        );\n        var desc = this.finddescription(content)\nconsole.log(desc);\nvar con = {\n                      content: desc,\n                    };\n       axios\n                      .post(LinkService.getpythonlink() + \"/checkkeyword\", con)\n                      .then(async (res) => {\n                        console.log(res.data);\n                      });\n    },\n    findtypeproduct(data) {\n      // console.log(data);\n      var text = [\"หมวดหมู่\"];\n      var findfda = data;\n      for (let t = 0; t < text.length; t++) {\n        if (findfda.indexOf(text[t]) != -1) {\n          findfda = findfda.substring(findfda.indexOf(text[t]));\n        }\n      }\n      // if (findfda == 'อาหาร') {\n      //   findfda = findfda+ findfda+'เสริม'\n      // }\n      // console.log(findfda);\n      return findfda;\n    },\n    finddescription(data) {\n      // console.log(data);\n      var text = [\"รายละเอียดสินค้า\"];\n      var findfda = data;\n      for (let t = 0; t < text.length; t++) {\n        if (findfda.indexOf(text[t]) != -1) {\n          findfda = findfda.substring(findfda.indexOf(text[t]));\n        }\n      }\n      // if (findfda == 'อาหาร') {\n      //   findfda = findfda+ findfda+'เสริม'\n      // }\n      // console.log(findfda);\n      findfda = findfda.replace('รายละเอียดสินค้า','')\n      return findfda;\n    },\n    \n    findspecific(data) {\n      // console.log(data);\n      var text = [\"ข้อมูลจำเพาะของสินค้า\"];\n      var end = [\"รายละเอียดสินค้า\"];\n      var findfda = data;\n      var endindex = findfda.indexOf(end);\n      // console.log(endindex);\n      for (let t = 0; t < text.length; t++) {\n        if (findfda.indexOf(text[t]) != -1) {\n          findfda = findfda.substring(findfda.indexOf(text[t]),endindex);\n        }\n      }\n      // if (findfda == 'อาหาร') {\n      //   findfda = findfda+ findfda+'เสริม'\n      // }\n      // console.log(findfda);\n      findfda = findfda.replace('ข้อมูลจำเพาะของสินค้า','')\n      return findfda;\n    },\n    findspecificlist(data) {\n      var list = []\n      // console.log(data);\n      var text = [\"หมวดหมู่\",\"เพศ\",\"หน้าที่ของอาหารเสริมควบคุมน้ำหนัก\",\"รสชาติ\",\"หมายเลขใบอนุญาต/อย.\",\"ส่วนประกอบ\",\"จำนวนสินค้า\",\"ส่งจาก\"];\n\n      // var findfda = data.split('หมวดหมู่')\n      // console.log(findfda);\n      // var end = [\"รายละเอียดสินค้า\"];\n      // var endindex = findfda.indexOf(end);\n      // // console.log(endindex);\n      for (let t = 0; t < text.length; t++) {\n\n      var findfda = data;\n        if (findfda.indexOf(text[t]) != -1) {\n          var split = ''\n          if (t+1 != text.length) {\n            var endindex = findfda.indexOf(text[t+1]);\n            split = findfda.substring(findfda.indexOf(text[t]),endindex);\n          }else{\n            split = findfda.substring(findfda.indexOf(text[t]));\n          }\n          console.log(findfda);\n          console.log(split);\n          console.log(text[t]);\n          console.log(endindex);\n          list.push(split)\n        }\n      }\n      return list;\n    },\n    loaddict() {\n      axios.get(LinkService.getpythonlink() + \"/loaddict\").then(async () => {});\n    },\n    getdetail() {\n      // var url = this.data.url.split(\"-i.\");\n      // var url = this.data.url.split(\"-i.\");\n      // this.data.url = url[0];\n      // console.log(this.product_token);\n      var selectpro = {\n        // url: this.data.url,\n        id: this.id,\n        fda_status: this.currentUser.id\n      };\n      MapRuleBasedService.getproduct_token(selectpro).then(async (res) => {\n        // console.log(res.data);\n        // var best = this.getMax(res.data.keyword,'count_rulebased')\n        //console.log(best);\n        this.list = res.data;\n        this.statuslist = true\n        this.status = true;\n        // this.loading = false\n        // var data = {\n        //   advertise_id: res.data.keyword[0].product_token_id,\n        // };\n        // MapRuleBasedService.updateweight(\n        //   res.data.keyword[0].map_rule_based_id,\n        //   data\n        // ).then(() => {});\n        // this.list.keyword = [best]\n        // this.status = true\n      });\n    },\n    async search() {\n      // var url = this.data.url.replaceAll(\".\",'');\n      // url = url.split(\"-i\");\n      // this.data.url = url[0];\n      // console.log(this.data.url);\n      this.product = [];\n      this.procheck = [];\n      this.loading = false;\n      this.status = false\n      this.statusprocheck = false\n      this.statusproduct = false\n      this.statuslist = false\n      this.product_token = 0;\n      var con = {};\n      await this.loaddict();\n      // if (this.data.url == null || this.data.url == \"\") {\n      //   alert(\"กรุณากรอก URL\");\n      // } else \n      if (this.data.content == null || this.data.content == \"\") {\n        alert(\"กรุณากรอกข้อความโฆษณา\");\n      } else {\n\n        this.loading = true\n        var findtype = this.findtypeproduct(this.data.content)\n// console.log(type);\nvar split = findtype.split(\"\\n\")\nvar type = split[3]\n// console.log(type);\nawait FDATypesService.getfdatypes(type).then(async (res)=>{\n  // console.log(res.data);\n  if (res.data.length > 0) {\n    this.typeId = res.data[0].id\n  }else{\n    var name = {\n      name : type\n    }\n    await FDATypesService.createfdatype(name).then((res)=>{\n      this.typeId = res.data.id\n    });\n  }\n})\n// console.log(this.typeId);\n        var content = \"\";\n        content = this.data.content.replaceAll(\n          /([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g,\n          \"\"\n        );\n        content = content.replaceAll(\n          /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g,\n          \" \"\n        );\n\n        content = content.replaceAll(/\\ud83d[\\ude00-\\ude4f]/g, \" \");\n        content = content.replaceAll(/(\\r\\n|\\n|\\r)/gm, \" \");\n        content = content.replaceAll(\"_\", \"\");\n        content = content.replaceAll(\"!\", \"\");\n        content = content.replaceAll(\"*\", \"\");\n        content = content.replaceAll(\"&\", \"\");\n        content = content.replaceAll(\"#\", \"\");\n        content = content.replaceAll(\"•\", \"\");\n        content = content.replaceAll(\"+\", \"\");\n        content = content.replaceAll(`_/l\\_`, \"\"); // eslint-disable-line\n        content = content.replaceAll(\n          /([\\u2700-\\u27BF]|[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2011-\\u26FF]|\\uD83E[\\uDD10-\\uDDFF])/g,\n          \" \"\n        );\n\n        // this.fda = await this.findfda(content);\n\nvar desc = this.finddescription(content)\n        this.fda = await this.getfda(content)[0]\n        console.log(this.fda);\n          con = {\n            content: desc,\n          };\n          await axios\n            .post(LinkService.getpythonlink() + \"/wordtokendesc\", con)\n            .then(async (res) => {\n              // console.log(res.data);\n              // var sentence = res.data.sentent.replaceAll(\"<spanstyle\", \"<span style\");\n              var des = {\n                url: this.data.url,\n                sentence: desc,\n                sentence_keyword: res.data.sentent,\n                keyword_id: res.data.keywordId,\n                status: 1,\n              };\n              // console.log(des);\n              if (this.product_token == 0) {\n                await MapRuleBasedService.createproduct_token(des).then(\n                  async (producttoken) => {\n                    // console.log(producttoken);\n                    this.product_token = producttoken.data.id;\n                    this.checkfda(content, this.product_token);\n                    // console.log(producttoken);\n                    this.product_token = producttoken.data.id;\n                    con = {\n                      content: desc,\n                    };\n                    //console.log(con);\n                    await axios\n                      .post(LinkService.getpythonlink() + \"/checkkeyword\", con)\n                      .then(async (res) => {\n                        // console.log(res.data);\n                        if (res.data.length > 0) {\n                          for (let r = 0; r < res.data.length; r++) {\n                            var sentencetoken = res.data[r].sentent.replaceAll(\n                              '\"',\n                              \"\"\n                            ); // eslint-disable-line\n                            sentencetoken = sentencetoken.replaceAll(\n                              \"<spanstyle\",\n                              \"<span style\"\n                            );\n\n                            // sentencetoken = sentencetoken.replaceAll('\"color:red\\\"','\"color:red\"')\n                            var advertise = {\n                              product_token_id: this.product_token,\n                              keyword_dict_id: res.data[r].keyword_dict_id,\n                              dict_id: res.data[r].dict_id,\n                              dict_name: res.data[r].dict_name,\n                              sentent: sentencetoken,\n                              sen: res.data[r].sen,\n                            };\n                            // console.log(this.product_token);\n                            await AdvertiseService.createadvertise(advertise).then(\n                              async () => {\n                                if (r + 1 == res.data.length) {\n                                  var getprotoken = {\n                                    url: this.product_token,\n                                  };\n                                  await MapRuleBasedService.getproductkeyword(\n                                    getprotoken\n                                  ).then(async (pro) => {\n                                    // console.log(pro.data);\n                                   await this.tokendata(pro.data);\n                                  });\n                                }\n                              }\n                            );\n                          }\n                        } else {\n                          await this.getdetail();\n                        }\n                      });\n                  }\n                );\n              } else {\n                await AdvertiseService.deleteadvertise(this.product_token).then(\n                  async () => {\n                    await MapRuleBasedService.updatproduct_token(\n                      this.product_token,\n                      des\n                    ).then(async () => {\n                      // await AdvertiseService.deleteadvertise(this.product_token).then(async ()=>{\n                      // console.log(del);\n                      this.checkfda(content, this.product_token);\n                      con = {\n                        content: desc,\n                      };\n                      //console.log(con);\n                      axios\n                        .post(\n                          LinkService.getpythonlink() + \"/checkkeyword\",\n                          con\n                        )\n                        .then(async (res) => {\n                          //console.log(res.data);\n                          if (res.data.length > 0) {\n                            for (let r = 0; r < res.data.length; r++) {\n                              var sentencetoken = res.data[\n                                r\n                              ].sentent.replaceAll('\"', \"\"); // eslint-disable-line\n                              sentencetoken = sentencetoken.replaceAll(\n                                \"<spanstyle\",\n                                \"<span style\"\n                              );\n\n                              // sentencetoken = sentencetoken.replaceAll('\"color:red\\\"','\"color:red\"')\n                              var advertise = {\n                                product_token_id: this.product_token,\n                                keyword_dict_id: res.data[r].keyword_dict_id,\n                                dict_id: res.data[r].dict_id,\n                                dict_name: res.data[r].dict_name,\n                                sentent: sentencetoken,\n                                sen: res.data[r].sen,\n                                status: 1,\n                              };\n                              // console.log(this.product_token);\n                              AdvertiseService.createadvertise(advertise).then(\n                                () => {\n                                  if (r + 1 == res.data.length) {\n                                    var getprotoken = {\n                                      url: this.product_token,\n                                    };\n                                    MapRuleBasedService.getproductkeyword(\n                                      getprotoken\n                                    ).then((pro) => {\n                                      // console.log(pro.data);\n                                      this.tokendata(pro.data);\n                                    });\n                                  }\n                                }\n                              );\n                            }\n                          }\n                        });\n                    });\n                  }\n                );\n              }\n            });\n        // });\n      }\n    },\n    getMax(arr, prop) {\n      var max;\n      for (var i = 0; i < arr.length; i++) {\n        if (max == null || parseInt(arr[i][prop]) > parseInt(max[prop]))\n          max = arr[i];\n      }\n      return max;\n    },\n    getMaxlength(arr, prop) {\n      var max;\n      for (var i = 0; i < arr.length; i++) {\n        if (max == null || parseInt(arr[i][prop]) > parseInt(max[prop]))\n          max = arr[i];\n      }\n      return max;\n    },\n    getAllMaxArray(arr, value) {\n      var array = [];\n      arr.map(function (num, idx) {\n        if (num.allcount == value) {\n          array.push(arr[idx]);\n        }\n      });\n      return array;\n    },\n    async tokendata(list) {\n      //console.log(list);\n      if (list.keyword.length > 0) {\n        for (let l = 0; l < list.keyword.length; l++) {\n          //console.log(list.keyword[l].keyword_dict_id);\n          if (list.keyword[l].keyword_dict_id) {\n            var map = {\n              id: list.keyword[l].id,\n              url: list.keyword[l].keyword_dict_id,\n              keyword_id: list.keyword[l].dict_id,\n            };\n            // console.log(map);\n            await MapRuleBasedService.getmapproduct(map).then(async (res) => {\n              // console.log(res.data);\n              var maxvalue = this.getMax(res.data, \"allcount\");\n              // console.log(maxvalue.allcount);\n              var i = this.getAllMaxArray(res.data, maxvalue.allcount);\n              // console.log(i);\n              var bestdata = this.getMax(i, \"length\");\n              // console.log(bestdata);\n              // getAllIndexes\n              // console.log(bestdata);\n              var best = {\n                id: list.keyword[l].id,\n                sentence: bestdata,\n              };\n              // console.log(best);\n              var rule_based_name = bestdata.name.toString();\n              rule_based_name = rule_based_name.replaceAll(\",\", \"\");\n              // console.log(rule_based_name);\n              await axios\n                .get(\n                  LinkService.getpythonlink() +\n                    \"/loaddict?word=\" +\n                    rule_based_name\n                )\n                .then(async () => {\n                  await MapRuleBasedService.getbestrulebased(best).then(\n                    async (res) => {\n                      // console.log(res.data);\n\n                      var rulebased = {\n                        count_rulebased: res.data.count,\n                        sentence_rulebase: res.data.sentence,\n                        rule_based_id: res.data.rule_based_id,\n                        rule_based_name: res.data.rule_based_name,\n                        map_rule_based_id: res.data.map_id,\n                      };\n                      // console.log(rulebased);\n                      // console.log(list.keyword[l].id);\n                      await MapRuleBasedService.updaterulebased(\n                        list.keyword[l].id,\n                        rulebased\n                      ).then(async () => {\n                        if (l + 1 == list.keyword.length) {\n                          await this.getdetail();\n                        }\n                      });\n                    }\n                  );\n                });\n              // list.keyword[l].rulebase = res.data;\n              // if (l + 1 == list.keyword.length) {\n              //   this.compare(list);\n              // }\n            });\n          }\n\n          // }\n        }\n      } else {\n        await this.getdetail();\n      }\n    },\n    compare(list) {\n      for (let k = 0; k < list.keyword.length; k++) {\n        // console.log(list.keyword[k]);\n        var dict_id = JSON.parse(list.keyword[k].dict_id);\n        // var rulebased = JSON.parse(list.keyword[k].rulebase)\n        // console.log(list.keyword[k].rulebased);\n        if (list.keyword[k].rulebase) {\n          let uniqueCharsrule = list.keyword[k].rulebase.filter((c, index) => {\n            return list.keyword[k].rulebase.indexOf(c) === index;\n          });\n          var filteredArray = dict_id.filter(function (n) {\n            return uniqueCharsrule.indexOf(n) !== -1;\n          });\n          // console.log(filteredArray);\n          // console.log('filteredArray',filteredArray);\n          // console.log('dict_id',dict_id.length);\n          // console.log(sumdictId.length);\n          var percentage =\n            (100 * parseInt(filteredArray.length)) / parseInt(dict_id.length);\n          // console.log(percentage);\n          list.keyword[k].percentage = percentage;\n        } else {\n          list.keyword[k].percentage = 0;\n        }\n        if (k + 1 == list.keyword.length) {\n          this.list = list;\n          // this.status = true;\n        }\n      }\n    },\n    getAllIndexes(arr, val) {\n      var indexes = [],\n        i = -1;\n      while ((i = arr.indexOf(val, i + 1)) != -1) {\n        indexes.push(i);\n      }\n      return indexes;\n    },\n    findfda(data) {\n      var text = [\"หมายเลขใบอนุญาต/อย.\",\"อย.\"];\n      // var end = ['']\n      var findfda = data;\n      for (let t = 0; t < text.length; t++) {\n        findfda = findfda.substring(findfda.indexOf(text[t]), data.length);\n        var endindex = this.getAllIndexes(findfda, \" \");\n        findfda = findfda.substring(findfda.indexOf(text[t]), endindex[1]);\n      }\n      // console.log(findfda);\n\n      for (let v = 0; v < text.length; v++) {\n      findfda = findfda.replaceAll(text[v], \"\");\n      }\n      findfda = findfda.replaceAll(/[^\\d.-]/g, '');\n      findfda = findfda.replaceAll(\"-\", \"\");\n      findfda = findfda.replaceAll(\"–\", \"\");\n      findfda = findfda.replaceAll(\" \", \"\");\n      // console.log(findfda);\n      // var regex = /\\d+/g;\n      // var matches = findfda.match(regex);  // creates array from matches\n      // console.log(matches[0]);\n      return findfda;\n    },\n    async checkfda(content, id) {\n      // console.log(this.fda);\n      if (this.fda) {\n        var fda = this.fda;\n        var product_status = 0;\n        const url = \"https://tawaiforhealth.org/api/oryor/check-product\";\n        const data = { number_src: fda };\n        // console.log(data);\n        const options = {\n          method: \"POST\",\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json;charset=UTF-8\",\n          },\n          body: JSON.stringify(data),\n        };\n\n        await fetch(url, options)\n          .then((response) => response.json())\n          .then(async (data) => {\n            // console.log(data);\n            if (data.message || data.length > 1) {\n              this.product.push({\n                name: \"-\",\n                detail: content,\n                fda: this.fda,\n                cncnm: \"-\",\n                typepro: \"-\",\n                lcnno: \"-\",\n                productha: \"-\",\n                produceng: \"-\",\n                licen: \"-\",\n                Addr: \"-\",\n                Newcode: \"-\",\n                status: \"-\",\n                token: \"-\",\n              });\n              this.procheck.push({\n                fda: this.fda,\n                mapfda: \"-\",\n                cncnm: \"-\",\n                productha: \"-\",\n                produceng: \"-\",\n                name: \"-\",\n                product_status: 0,\n                cat_status: 0,\n                fda_status: 0,\n                name_status: 0,\n                typepro: \"-\",\n                type: \"-\",\n              });\n              this.statusprocheck = true\n              // this.status = true\n            } else {\n              // console.log(data);\n              // console.log(data.cncnm.includes(\"คงอยู่\"))\n              if (data.cncnm.includes(\"ยกเลิก\") || data.cncnm.includes(\"เพิกถอน\")) {\n                product_status = 3;\n              } else {\n                product_status = 1;\n                this.colorfda = \"background-color:#a3e9a4\";\n              }\n              // console.log(this.colorfda);\n              var con = {\n                fda: fda,\n                productha: data.productha,\n                produceng: data.produceng,\n                typepro: data.typepro,\n                content: content,\n              };\n              await axios\n                .post(LinkService.getpythonlink() + \"/checkfda\", con)\n                .then(async (res) => {\n                  // console.log(res.data);\n                  var pro = {\n                    name: res.data.name,\n                    fda: fda,\n                    product_status: product_status,\n                    cat_status: res.data.mapcatstatus,\n                    fda_status: product_status,\n                    name_status: res.data.mapnamestatus,\n                  };\n                  // console.log(pro);\n                  await MapRuleBasedService.updatemap(id, pro).then(() => {\n                    // console.log(res.data);\n                    this.product.push({\n                      name: data.productha + \" \" + data.produceng,\n                      detail: content,\n                      fda: fda,\n                      cncnm: data.cncnm,\n                      typepro: data.typepro,\n                      lcnno: data.lcnno,\n                      productha: data.productha,\n                      produceng: data.produceng,\n                      licen: data.licen,\n                      Addr: data.Addr,\n                      Newcode: data.Newcode,\n                      status: product_status,\n                      token: res.data.token,\n                    });\n                    this.procheck.push({\n                      fda: fda,\n                      mapfda: data.lcnno,\n                      cncnm: data.cncnm,\n                      productha: data.productha,\n                      produceng: data.produceng,\n                      name: res.data.name,\n                      product_status: product_status,\n                      cat_status: res.data.mapcatstatus,\n                      fda_status: product_status,\n                      name_status: res.data.mapnamestatus,\n                      typepro: data.typepro,\n                      type: res.data.category,\n                    });\n                    this.statusprocheck = true\n                    this.colorcat = res.data.colorcat;\n                    this.colorname = res.data.colorname;\n                    // console.log(this.product);\n                    // console.log(this.procheck);\n                    // console.log(this.fda);\n                  });\n                });\n\n              // this.status = true\n            }\n          }).catch(err=>{\n            console.log(err);\n            this.statusprocheckone = true\n            this.prochecktext = 'Api tawaiforhealth ไม่สามารถทำงานได้'\n          });\n      } else {\n        this.product.push({\n          name: \"-\",\n          detail: content,\n          fda: this.fda,\n          cncnm: \"-\",\n          typepro: \"-\",\n          lcnno: \"-\",\n          productha: \"-\",\n          produceng: \"-\",\n          licen: \"-\",\n          Addr: \"-\",\n          Newcode: \"-\",\n          status: \"-\",\n          token: \"\",\n        });\n        this.statusproduct = true\n        this.procheck.push({\n          fda: this.fda,\n          mapfda: \"-\",\n          cncnm: \"-\",\n          productha: \"-\",\n          produceng: \"-\",\n          name: \"-\",\n          product_status: 0,\n          cat_status: 0,\n          fda_status: 0,\n          name_status: 0,\n          typepro: \"-\",\n          type: \"-\",\n        });\n\n        // this.status = true\n      }\n      this.loading = false\n    },\n    getfda(content){\n        var tt = content.split(' ')\n\n    // console.log(tt);\n    var arr = []\n    for (let l = 0; l < tt.length; l++) {\n      var findfda = tt[l].replaceAll('-', '');\n      findfda = findfda.replaceAll(\"–\", \"\");\n      findfda = findfda.replaceAll(\".\", \"\");\n    findfda = findfda.replaceAll(/[^\\d.-]/g, '');\n    // console.log(findfda);\n    if (findfda) {\n      if (findfda.length == 13) {\n      arr.push(findfda)\n      }\n    }\n      \n    }\n    console.log(arr);\n    return arr;\n    },\n  },\n  mounted() {\n    // console.log(this.$route.params.id);\n    this.id = this.$route.params.id\n\n    ProductsService.getproductstoken().then(async (res)=>{\n      this.alldata = res.data\n      this.back = parseInt(this.id)-1\n    this.next = parseInt(this.id)+1\n    })\n    ProductsService.getproducttoken(this.id).then(async (res)=>{\n      // console.log(res.data);\n\n      this.detail = res.data\n      // var spec = this.findspecific(res.data.sentencefull)\n      // this.detail.spec = this.findspecificlist(spec)\n      this.detail.spec = await this.findspecific(res.data.sentencefull)\n      this.detail.desc = await this.finddescription(res.data.sentencefull)\n      this.fda = res.data.fda\n    await this.getdetail()\n    await this.checkfda(res.data.sentence, this.id);\n\n    })\n    // var f = this.findfda('หมายเลขใบอนุญาต/อย.เลขจดแจ้ง 13-1-1-7562-2-0006')\n    // var text = [\"หมายเลขใบอนุญาต/อย.\",\"อย.\"];\n    // var sen = 'อย.14-1-02662-2-0021 อย. 13-1-1-7562-2-0006'\n    // var l = sen.split(' ')\n    // console.log(l);\n    // var f = this.findfda(sen)\n    // var text = [\"หมายเลขใบอนุญาต/อย.\",\"อย.\"];\n    //   // var end = ['']\n    //   var findfda = sen;\n    //   for (let t = 0; t < text.length; t++) {\n    //     console.log(findfda.indexOf(text[t]));\n        \n    //     console.log(this.getAllIndexes(l,text[t]));\n    //   }\n    // console.log(f);\n//     var best = {\n//     \"id\": 67,\n//     \"sentence\": {\n//         \"length\": 2,\n//         \"allcount\": 100,\n//         \"rule\": [\n//             8899,\n//             57\n//         ],\n//         \"name\": [\n//             \"ควบคุม\",\n//             \"น้ำหนัก\"\n//         ],\n//         \"map_id\": 75\n//     }\n// }\n//                   MapRuleBasedService.getbestrulebased(best).then(\n//                      (res) => {\n//                       console.log(res.data);\n//                     });\n    // var text = 'หมายเลขใบอนุญาต/อย. 13-1-13465-5-0052 จำนวนสินค้า 415 ส่งจาก'\n    // console.log(this.findfda(text));\n    // this.data.url =\n    //   \"https://shopee.co.th/%E2%99%A6%EF%B8%8F%E0%B9%82%E0%B8%89%E0%B8%A1%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88-%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B9%81%E0%B8%97%E0%B9%89%E2%99%A6%EF%B8%8F-%E0%B8%82%E0%B8%B2%E0%B8%A2%E0%B8%94%E0%B8%B5%E0%B8%A1%E0%B8%B2%E0%B8%81-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F-%E0%B8%A5%E0%B8%B4%E0%B9%82%E0%B8%8B%E0%B9%88-%E0%B8%9E%E0%B8%A5%E0%B8%B1%E0%B8%AA-%E2%80%8B-coffee-lishou-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%84%E0%B8%A7%E0%B8%9A%E0%B8%84%E0%B8%B8%E0%B8%A1%E0%B8%99%E0%B9%89%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%81-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%84%E0%B8%B8%E0%B8%A1%E0%B8%AB%E0%B8%B4%E0%B8%A7-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%A5%E0%B8%94%E0%B8%99%E0%B9%89%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%81-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%A5%E0%B8%94%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%AD%E0%B9%89%E0%B8%A7%E0%B8%99\";\n    // this.data.content =\n    //   \"️ถ้าเป็นลูกค้าพิมแล้ว ดูแลจนน้ำหนักลดเลยค่ะ สั่งซื้อสินค้าแล้ว ทักแชทมาคุยกันได้เลยค่ะ\";\n    // // var url = this.data.url.split('-i.')\n    // var content = this.data.content.replaceAll(\n    //   /([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g,\n    //   \"\"\n    // );\n    // content = content.replaceAll(\n    //   /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g,\n    //   \"\"\n    // );\n    // content = content.replaceAll(/(\\r\\n|\\n|\\r)/gm, \"\");\n    // content = content.replaceAll(\"_\", \"\");\n    // content = content.replaceAll(\"!\", \"\");\n    // content = content.replaceAll(\"*\", \"\");\n    // content = content.replaceAll(\"&\", \"\");\n    // content = content.replaceAll(\"#\", \"\");\n    // content = content.replaceAll(`_/l\\_`, \"\"); // eslint-disable-line\n    // // console.log(LinkService.getpythonlink()+'/wordtokendesc?text=' + content);\n    // // axios.get(LinkService.getpythonlink()+'/wordtokendesc?text='+content).then(async (res) => {\n    // //   console.log(res.data);\n    // // })\n    // console.log(LinkService.getpythonlink() + \"/checkkeyword?text=\" + content);\n    // var con = {\n    //   content: content,\n    // };\n    // axios\n    //   .post(LinkService.getpythonlink() + \"/checkkeyword?text=\" + content, con)\n    //   .then(async (res) => {\n    //     console.log(res.data);\n    //     //       for (let r = 0; r < res.data.length; r++) {\n    //     //         var advertise = {\n    //     //           product_token_id:1,\n    //     //           keyword_dict_id:res.data[r].keyword_dict_id,\n    //     //           dict_id:res.data[r].dict_id,\n    //     //           dict_name:res.data[r].dict_name,\n    //     //           sen:res.data[r].sen,\n    //     //           sentent:res.data[r].sentent,\n    //     //         }\n    //     //         AdvertiseService.createadvertise(advertise).then((res)=>{\n    //     //           console.log(res.data);\n    //     //         })\n    //     //       }\n    //   });\n    // //  console.log(url);\n    // //     var selectpro = {\n    // //       url:url[0]\n    // //      }\n    // //      MapRuleBasedService.getproduct_token(selectpro).then((res)=>{\n    // //       console.log(res.data);\n    // // var list = res.data\n    // // this.tokendata(list)\n    // // for (let l = 0; l < list.keyword.length; l++) {\n    // //   // console.log(this.list.keyword[l].map);\n    // //   // for (let m = 0; m < this.list.keyword[l].length; m++) {\n    // //     if (list.keyword[l].map) {\n    // //       var map = {\n    // //     url:JSON.stringify(list.keyword[l].map)\n    // //      }\n    // //     //  console.log(map);\n    // //      MapRuleBasedService.getmapproduct(map).then((res)=>{\n    // //       list.keyword[l].rulebase = res.data\n    // //       if (l+1 == list.keyword.length) {\n    // //         this.compare(list)\n    // //       }\n    // //      });\n    // //     }\n    // //   }\n    // // }\n    // // console.log(this.list);\n    // this.status = true;\n    // //  })\n  },\n};\n</script>\n\n<style>\nhtml,\nbody {\n  height: 100%;\n  margin: 0px;\n}\n</style>\n"]}]}