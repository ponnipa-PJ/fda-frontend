{"remainingRequest":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/babel-loader/lib/index.js!/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ponnipa/Documents/GitHub/fda-frontend/src/components/producttoken.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/src/components/producttoken.vue","mtime":1697798459764},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/babel.config.js","mtime":1677654957527},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1687492401267},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/babel-loader/lib/index.js","mtime":1687492401655},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1687492401267},{"path":"/Users/ponnipa/Documents/GitHub/fda-frontend/node_modules/vue-loader/lib/index.js","mtime":1687492401738}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9wb25uaXBhL0RvY3VtZW50cy9HaXRIdWIvZmRhLWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UtYWxsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7IC8vIGltcG9ydCBQcm9kdWN0c1NlcnZpY2UgZnJvbSAnLi4vc2VydmljZXMvUHJvZHVjdHNTZXJ2aWNlLmpzJwoKaW1wb3J0IERpY3RTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL0RpY3RTZXJ2aWNlIjsKaW1wb3J0IFJ1bGVCYXNlZFNlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvUnVsZUJhc2VkU2VydmljZSI7CmltcG9ydCBNYXBSdWxlQmFzZWRTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL01hcFJ1bGVCYXNlZFNlcnZpY2UiOwppbXBvcnQgTGlua1NlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvTGlua1NlcnZpY2UiOwppbXBvcnQgQWR2ZXJ0aXNlU2VydmljZSBmcm9tICIuLi9zZXJ2aWNlcy9BZHZlcnRpc2VTZXJ2aWNlIjsKaW1wb3J0IEtleXdvcmRTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL0tleXdvcmRTZXJ2aWNlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBcHAiLAogIGNvbXBvbmVudHM6IHt9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0OiBbXSwKICAgICAgdXJsOiAiIiwKICAgICAgZmlsZTogIiIsCiAgICAgIHN0YXR1czogZmFsc2UsCiAgICAgIHVybFBhdGg6ICIiLAogICAgICBpbWFnZWxpc3RzOiAiIiwKICAgICAgdG9rZW5pemU6ICIiLAogICAgICBtYXRjaG5hbWU6ICIiLAogICAgICBtYXRjaGNhdGVnb3J5OiAiIiwKICAgICAgdHlwZTogIiIsCiAgICAgIG1hdGNobmFtZXN1bTogIiIsCiAgICAgIHN0YXR1c25hbWU6IDAsCiAgICAgIHN0YXR1c2NhdDogMCwKICAgICAgc3RhdHVzZmRhOiAwLAogICAgICBjb2xvcm5hbWU6ICJiYWNrZ3JvdW5kLWNvbG9yOiNmOWJkYmIiLAogICAgICBjb2xvcmZkYTogImJhY2tncm91bmQtY29sb3I6I2Y5YmRiYiIsCiAgICAgIGNvbG9yY2F0OiAiYmFja2dyb3VuZC1jb2xvcjojZjliZGJiIiwKICAgICAgaWQ6ICIiLAogICAgICBrZXl3b3JkOiBbXSwKICAgICAgY29sb3JrZXk6ICJiYWNrZ3JvdW5kLWNvbG9yOiNmOWJkYmIiLAogICAgICBkZXNjOiAiIiwKICAgICAgYXJyTGlzdDogW10sCiAgICAgIGFsbGRhdGE6IDAsCiAgICAgIGJhY2s6IDAsCiAgICAgIG5leHQ6IDAsCiAgICAgIGRhdGE6IHt9LAogICAgICBwcm9kdWN0X3Rva2VuOiAwLAogICAgICB0aXRsZTogJ+C5gOC4nuC4tOC5iOC4oSBrZXl3b3JkJywKICAgICAga2V5OiB7fQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBjdXJyZW50VXNlcjogZnVuY3Rpb24gY3VycmVudFVzZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnVzZXI7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBzYXZlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICAvL2NvbnNvbGUubG9nKHRoaXMua2V5KTsKICAgICAgaWYgKHRoaXMua2V5Lm5hbWUgPT0gbnVsbCB8fCB0aGlzLmtleS5uYW1lID09ICIiKSB7CiAgICAgICAgYWxlcnQoIuC4geC4o+C4uOC4k+C4suC4geC4o+C4reC4geC4guC5ieC4reC4hOC4p+C4suC4oSIpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBwcm9kYXRhID0gewogICAgICAgICAgbmFtZTogdGhpcy5rZXkubmFtZSwKICAgICAgICAgIHN0YXR1czogMQogICAgICAgIH07IC8vY29uc29sZS5sb2cocHJvZGF0YSk7IAoKICAgICAgICBLZXl3b3JkU2VydmljZS5jcmVhdGVrZXl3b3JkKHByb2RhdGEpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICBpZiAocmVzLmRhdGEuZXJyID09IDEwNjIpIHsKICAgICAgICAgICAgYWxlcnQoJ+C4oeC4teC4hOC4s+C4meC4teC5ieC5g+C4meC4o+C4sOC4muC4muC5geC4peC5ieC4pycpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgRGljdFNlcnZpY2UuY3JlYXRlZGljdChwcm9kYXRhKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHJlcy5kYXRhICk7CiAgICAgICAgICAgICAgLy8gUnVsZUJhc2VkU2VydmljZS5jcmVhdGVkY29sdW1ucnVsZV9iYXNlZChyZXMuZGF0YS5pZCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNsb3NlZGNhdGVnb3J5IikuY2xpY2soKTsKICAgICAgICAgICAgICBhbGVydCgn4Lia4Lix4LiZ4LiX4Li24LiB4Liq4Liz4LmA4Lij4LmH4LiIJyk7IC8vIH0pCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZ2V0cGVyY2VudGFnZTogZnVuY3Rpb24gZ2V0cGVyY2VudGFnZShkYXRhKSB7CiAgICAgIC8vIHZhciBkaWN0ID0gSlNPTi5wYXJzZShkYXRhLmRpY3RfaWQpCiAgICAgIC8vIHZhciBydWxlX2Jhc2VkX2lkID0gSlNPTi5wYXJzZShkYXRhLnJ1bGVfYmFzZWRfaWQpCiAgICAgIC8vIHZhciByZSA9ICgxMDAgKiBkYXRhLmNvdW50X3J1bGViYXNlZCkvIChydWxlX2Jhc2VkX2lkLmxlbmd0aCkKICAgICAgcmV0dXJuIGRhdGEuY291bnRfcnVsZWJhc2VkOwogICAgfSwKICAgIHNhdmV0b3J1bGU6IGZ1bmN0aW9uIHNhdmV0b3J1bGUoc2VuLCBhbnN3ZXIpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vIGNvbnNvbGUubG9nKGFuc3dlcik7CiAgICAgIHZhciBpZGRhdGEgPSBbXTsKCiAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGQpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhc3BsaXRbZF0pOwogICAgICAgIERpY3RTZXJ2aWNlLmdldGRpY3RzKCIiLCBzZW5bZF0pLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXMpIHsKICAgICAgICAgICAgdmFyIHNxbDsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YVswXS5pZCk7CiAgICAgICAgICAgICAgICAgICAgICBpZGRhdGEucHVzaChyZXMuZGF0YVswXS5pZCk7CiAgICAgICAgICAgICAgICAgICAgfSAvLyBjb25zb2xlLmxvZyhkKzEgLCBzZW4ubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpZGRhdGEpOwoKCiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZCArIDEgPT0gc2VuLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBzcWwgPSAiU0VMRUNUIHIuKiBGUk9NIG1hcF9ydWxlX2Jhc2VkIG0gam9pbiBydWxlX2Jhc2VkIHIgb24gbS5ydWxlX2Jhc2VkX2lkID0gci5pZCBXSEVSRSBtLnN0YXR1cyA9IDEgYW5kIGRpY3RfaWQgPSAnWyIuY29uY2F0KGlkZGF0YSwgIl0nIik7IC8vIGNvbnNvbGUubG9nKHNxbCk7CgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBSdWxlQmFzZWRTZXJ2aWNlLmdldGJ5ZGljdChzcWwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gInsiOwoKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpZGRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpZGRhdGFbaV0pOwogICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyJkaWN0JyArIGlkZGF0YVtpXSArICciJyArICI6IiArIDEgKyAiLCI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyJhbnN3ZXInICsgJyInICsgIjoiICsgYW5zd2VyICsgIiwiOwogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZSgwLCAtMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gIn0iOyAvLyBjb25zb2xlLmxvZyh0ZXh0KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbkRhdGEgPSBKU09OLnBhcnNlKHRleHQpOyAvLyBjb25zb2xlLmxvZyhqc29uRGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhqc29uRGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVCYXNlZFNlcnZpY2UuY3JlYXRlcnVsZV9iYXNlZChqc29uRGF0YSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcHJ1bGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlX2Jhc2VkX2lkOiByZXMuZGF0YS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpY3RfaWQ6IGlkZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogMQogICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgTWFwUnVsZUJhc2VkU2VydmljZS5jcmVhdGVtYXBfcnVsZV9iYXNlZChtYXBydWxlKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhciBwcm8gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIG1hcF9ydWxlX2Jhc2VkOnJlcy5kYXRhLmlkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9kdWN0c1NlcnZpY2UubWFwX3J1bGVfYmFzZWQoaWQscHJvKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLguJrguLHguJnguJfguLbguIHguKrguLPguYDguKPguYfguIgiKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5nZXRkYXRhKCk7IC8vICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSwgNTAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVtYXBydWxlID0gewogICAgICAgICAgICAgICAgICAgICAgICAgIGFuc3dlcjogYW5zd2VyCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIFJ1bGVCYXNlZFNlcnZpY2UudXBkYXRlcnVsZV9iYXNlZChyZXMuZGF0YVswXS5pZCwgdXBkYXRlbWFwcnVsZSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIuC4muC4seC4meC4l+C4tuC4geC4quC4s+C5gOC4o+C5h+C4iCIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5nZXRkYXRhKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgICAgIH0pKTsKCiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9OwogICAgICAgIH0oKSk7CiAgICAgIH07CgogICAgICBmb3IgKHZhciBkID0gMDsgZCA8IHNlbi5sZW5ndGg7IGQrKykgewogICAgICAgIF9sb29wKGQpOwogICAgICB9CiAgICB9LAogICAgc2F2ZXRvcnVsZV9iYXNlZDogZnVuY3Rpb24gc2F2ZXRvcnVsZV9iYXNlZChkYXRhLCBhbnN3ZXIpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICAvLyBjb25zb2xlLmxvZyhzZW4ubGVuZ3RoKTsKICAgICAgLy8gY29uc29sZS5sb2coJ2Fuc3dlcicsYW5zd2VyKTsKICAgICAgLy9jb25zb2xlLmxvZyhkYXRhKTsKICAgICAgdmFyIG1hcHJ1bGUgPSB7CiAgICAgICAga2V5d29yZF9pZDogMSwKICAgICAgICBhZHZlcnRpc2VfaWQ6IGRhdGEuaWQsCiAgICAgICAgc3RhdHVzOiAxLAogICAgICAgIGFuc3dlcjogYW5zd2VyLAogICAgICAgIHVzZXI6IHRoaXMuY3VycmVudFVzZXIuaWQKICAgICAgfTsKCiAgICAgIGlmICghZGF0YS5tYXBJZCkgewogICAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuY3JlYXRlbWFwX3J1bGVfYmFzZWQobWFwcnVsZSkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIocmVzKSB7CiAgICAgICAgICAgIHZhciBtYXBfaWQsIHNlbmRhdGEsIGRpY3RfbmFtZSwgX2xvb3AyLCBkLCBydWxlOwoKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgbWFwX2lkID0gcmVzLmRhdGEuaWQ7CiAgICAgICAgICAgICAgICAgICAgc2VuZGF0YSA9IEpTT04ucGFyc2UoZGF0YS5kaWN0X2lkKTsKICAgICAgICAgICAgICAgICAgICBkaWN0X25hbWUgPSBKU09OLnBhcnNlKGRhdGEuZGljdF9uYW1lKTsKCiAgICAgICAgICAgICAgICAgICAgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKGQpIHsKICAgICAgICAgICAgICAgICAgICAgIHJ1bGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1hcF9ydWxlX2Jhc2VkX2lkOiBtYXBfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGRpY3RfaWQ6IHNlbmRhdGFbZF0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRpY3RfbmFtZTogZGljdF9uYW1lW2RdLAogICAgICAgICAgICAgICAgICAgICAgICBubzogZCArIDEKICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICBSdWxlQmFzZWRTZXJ2aWNlLmNyZWF0ZXJ1bGVfYmFzZWQocnVsZSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkICsgMSA9PSBzZW5kYXRhLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMi5nZXRkZXRhaWwoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIuC4muC4seC4meC4l+C4tuC4geC4quC4s+C5gOC4o+C5h+C4iCIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgICBmb3IgKGQgPSAwOyBkIDwgc2VuZGF0YS5sZW5ndGg7IGQrKykgewogICAgICAgICAgICAgICAgICAgICAgX2xvb3AyKGQpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgICAgIH0pKTsKCiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICAgICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH07CiAgICAgICAgfSgpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBNYXBSdWxlQmFzZWRTZXJ2aWNlLmRlbGV0ZW1hcF9ydWxlX2Jhc2VkKGRhdGEubWFwSWQsIG1hcHJ1bGUpLnRoZW4oIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgICAgICAgICAgICBfdGhpczIuZ2V0ZGV0YWlsKCk7CgogICAgICAgICAgICAgICAgICBhbGVydCgi4Lia4Lix4LiZ4LiX4Li24LiB4Liq4Liz4LmA4Lij4LmH4LiIIik7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgICAgfSkpKTsKICAgICAgfQogICAgfSwKICAgIGNoZWNra2V5d29yZDogZnVuY3Rpb24gY2hlY2trZXl3b3JkKG5hbWUpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICAvLyBjb25zb2xlLmxvZyhuYW1lKTsKICAgICAgLy8gICBheGlvcy5nZXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9hcGkva2V5d29yZF9kaWN0cz9uYW1lPTEnKS50aGVuKChyZXMpID0+IHsKICAgICAgLy8gICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgLy8gZm9yIChsZXQgciA9IDA7IHIgPCByZXMuZGF0YS5sZW5ndGg7IHIrKykgewogICAgICAvLyBuYW1lID0gbmFtZS5yZXBsYWNlQWxsKC8oW1x1RTAwMC1cdUY4RkZdfFx1RDgzQ1tcdURGMDAtXHVERkZGXXxcdUQ4M0RbXHVEQzAwLVx1RERGRl0pL2csICcnKQogICAgICAvLyAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlQWxsKC8oPzpbXHUyNzAwLVx1MjdiZl18KD86XHVkODNjW1x1ZGRlNi1cdWRkZmZdKXsyfXxbXHVkODAwLVx1ZGJmZl1bXHVkYzAwLVx1ZGZmZl18W1x1MDAyMy1cdTAwMzldXHVmZTBmP1x1MjBlM3xcdTMyOTl8XHUzMjk3fFx1MzAzZHxcdTMwMzB8XHUyNGMyfFx1ZDgzY1tcdWRkNzAtXHVkZDcxXXxcdWQ4M2NbXHVkZDdlLVx1ZGQ3Zl18XHVkODNjXHVkZDhlfFx1ZDgzY1tcdWRkOTEtXHVkZDlhXXxcdWQ4M2NbXHVkZGU2LVx1ZGRmZl18XHVkODNjW1x1ZGUwMS1cdWRlMDJdfFx1ZDgzY1x1ZGUxYXxcdWQ4M2NcdWRlMmZ8XHVkODNjW1x1ZGUzMi1cdWRlM2FdfFx1ZDgzY1tcdWRlNTAtXHVkZTUxXXxcdTIwM2N8XHUyMDQ5fFtcdTI1YWEtXHUyNWFiXXxcdTI1YjZ8XHUyNWMwfFtcdTI1ZmItXHUyNWZlXXxcdTAwYTl8XHUwMGFlfFx1MjEyMnxcdTIxMzl8XHVkODNjXHVkYzA0fFtcdTI2MDAtXHUyNkZGXXxcdTJiMDV8XHUyYjA2fFx1MmIwN3xcdTJiMWJ8XHUyYjFjfFx1MmI1MHxcdTJiNTV8XHUyMzFhfFx1MjMxYnxcdTIzMjh8XHUyM2NmfFtcdTIzZTktXHUyM2YzXXxbXHUyM2Y4LVx1MjNmYV18XHVkODNjXHVkY2NmfFx1MjkzNHxcdTI5MzV8W1x1MjE5MC1cdTIxZmZdKS9nLCAnJyk7CiAgICAgIC8vICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2VBbGwoLyhcclxufFxufFxyKS9nbSwgIiIpOwogICAgICAvLyAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlQWxsKCJfIiwgIiIpOwogICAgICAvLyAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlQWxsKCIhIiwgIiIpOwogICAgICAvLyAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlQWxsKCIqIiwgIiIpOwogICAgICAvLyBuYW1lID0gbmFtZS5yZXBsYWNlQWxsKGBfL2xcX2AsICIiKTsvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgIC8vIGNvbnNvbGUubG9nKCdodHRwOi8vMTI3LjAuMC4xOjUwMDAvY2hlY2trZXl3b3JkP3RleHQ9JyArIG5hbWUpOwogICAgICB2YXIgZGVzYyA9IHRoaXMuZmluZGRlc2NyaXB0aW9uKG5hbWUpOyAvLyBjb25zb2xlLmxvZygnaHR0cDovLzEyNy4wLjAuMTo1MDAwL3dvcmt0b2tlbmRlc2M/dGV4dD0nK2Rlc2MpOwoKICAgICAgYXhpb3MuZ2V0KExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSArICIvd29ya3Rva2VuZGVzYz90ZXh0PSIgKyBkZXNjKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgX3RoaXMzLmRlc2MgPSByZXMuZGF0YTsKICAgICAgfSk7IC8vIG5hbWUgPSAn4LiC4LmJ4Lit4Lih4Li54Lil4LiI4Liz4LmA4Lie4Liy4Liw4LiC4Lit4LiH4Liq4Li04LiZ4LiE4LmJ4LiyIOC4q+C4oeC4p+C4lOC4q+C4oeC4ueC5iCBTaG9wZWUg4LiB4Lil4Li44LmI4Lih4Lic4Lil4Li04LiV4Lig4Lix4LiT4LiR4LmM4LmA4Lie4Li34LmI4Lit4Liq4Li44LiC4Lig4Liy4LieIOC4reC4suC4q+C4suC4o+C5gOC4quC4o+C4tOC4oeC5gOC4nuC4t+C5iOC4reC4hOC4p+C4suC4oeC4h+C4suC4oSDguJzguLTguKcg4Lii4Li14LmI4Lir4LmJ4LitIEJsdWViaXJkKOC4muC4peC4ueC5gOC4muC4tOC4o+C5jOC4lCkgU3RvcmFnZSBDb25kaXRpb24gTm9ybWFsIOC4m+C4o+C4sOC5gOC4oOC4l+C4quC4suC4o+C4reC4suC4q+C4suC4oyDguKrguLLguKPguJXguYnguLLguJnguK3guJnguLjguKHguLnguKXguK3guLTguKrguKPguLAsIOC4p+C4tOC4leC4suC4oeC4tOC4meC4i+C4tSDguJvguKPguLDguYDguJfguKjguJXguYnguJnguIHguLPguYDguJnguLTguJTguKrguLTguJnguITguYnguLIg4LmE4LiX4LiiIOC4q+C4meC5ieC4suC4l+C4teC5iOC4guC4reC4h+C4reC4suC4q+C4suC4o+C5gOC4quC4o+C4tOC4oeC4quC4s+C4q+C4o+C4seC4muC4hOC4p+C4suC4oeC4h+C4suC4oSDguJTguLnguYHguKXguKrguLTguKcsIOC4m+C5ieC4reC4h+C4geC4seC4meC4o+C4tOC5ieC4p+C4o+C4reC4oiDguJvguKPguLDguYDguKDguJfguIHguLLguKPguKvguYjguK0g4Lir4LmI4Lit4Lij4Lin4Lih4LiB4Lix4LiZIOC5gOC4nuC4qCDguJfguLHguYnguIfguKrguK3guIfguYDguJ7guKgg4Lit4Liy4Lii4Li44LiB4Liy4Lij4LmA4LiB4LmH4Lia4Lij4Lix4LiB4Lip4LiyIDEyIOC5gOC4lOC4t+C4reC4mSDguJvguKPguLDguYDguKDguJfguILguK3guIfguJzguKXguLTguJXguKDguLHguJPguJHguYzguKLguLIg4LmB4LiE4Lib4LiL4Li54LilIOC4q+C4oeC4suC4ouC5gOC4peC4guC5g+C4muC4reC4meC4uOC4jeC4suC4lS/guK3guKIuIDMwLTEtMjY3NjQtNS0wMDUxIOC4iOC4s+C4meC4p+C4meC4quC4tOC4meC4hOC5ieC4siAxNzkwMSDguKrguYjguIfguIjguLLguIEg4LiI4Lix4LiH4Lir4Lin4Lix4LiU4LiZ4LiE4Lij4Lij4Liy4LiK4Liq4Li14Lih4LiyIOC4o+C4suC4ouC4peC4sOC5gOC4reC4teC4ouC4lOC4quC4tOC4meC4hOC5ieC4siDguKfguLTguJXguLLguKHguLTguJnguIvguLUg4Lie4Lil4Lix4LiqIOC4leC4o+C4siDguJrguKXguLnguYDguJrguLTguKPguYzguJQg4LiV4Lij4LiyIOC4muC4peC4ueC5gOC4muC4tOC4o+C5jOC4lCDguILguJnguLLguJQgMTAwMCDguKHguLTguKXguKXguLTguIHguKPguLHguKEgNjAg4LmB4LiE4Lib4LiL4Li54LilIOC5gOC4o+C4l+C4guC4suC4ouC4quC5iOC4hyDguIrguYjguKfguIfguKPguLLguITguLLguJfguLXguYggMSDguKrguLHguYjguIfguIvguLfguYnguK3guJXguLHguYnguIfguYHguJXguYggNSDguIHguKPguLDguJvguLjguIHguILguLbguYnguJnguYTguJsg4LiW4Li24LiHIDIwIOC4geC4o+C4sOC4m+C4uOC4gSDguKPguLLguITguLLguIHguKPguLDguJvguLjguIHguKXguLAgOTMg4Lia4Liy4LiXIOC4iuC5iOC4p+C4h+C4o+C4suC4hOC4suC4l+C4teC5iCAyIOC4quC4seC5iOC4h+C4i+C4t+C5ieC4reC4leC4seC5ieC4h+C5geC4leC5iCAyMSDguIHguKPguLDguJvguLjguIHguILguLbguYnguJnguYTguJsg4LiW4Li24LiHIDUwIOC4geC4o+C4sOC4m+C4uOC4gSDguKPguLLguITguLLguIHguKPguLDguJvguLjguIHguKXguLAgOTAg4Lia4Liy4LiXIOC4iuC5iOC4p+C4h+C4o+C4suC4hOC4suC4l+C4teC5iCAzIOC4quC4seC5iOC4h+C4i+C4t+C5ieC4reC4leC4seC5ieC4h+C5geC4leC5iCA1MSDguIHguKPguLDguJvguLjguIHguILguLbguYnguJnguYTguJsg4LiW4Li24LiHIDEwMCDguIHguKPguLDguJvguLjguIEg4Lij4Liy4LiE4Liy4LiB4Lij4Liw4Lib4Li44LiB4Lil4LiwIDg3IOC4muC4suC4lyDguIrguYjguKfguIfguKPguLLguITguLLguJfguLXguYggNCDguKrguLHguYjguIfguIvguLfguYnguK3guJXguLHguYnguIfguYHguJXguYggMTAwIOC4geC4o+C4sOC4m+C4uOC4geC4guC4tuC5ieC4meC5hOC4myAuLi4uLi4uLi4uLi4uLi4uLi4uLi4g4Lij4Liy4LiE4Liy4LiB4Lij4Liw4Lib4Li44LiB4Lil4LiwIDg1IOC4muC4suC4lyBWaXRhbWluIEMgUGx1cyBEaWV0YXJ5IFN1cHBsZW1lbnQgUHJvZHVjdCBCbHVlYmlyZCBCcmFuZCDguJzguKXguLTguJXguKDguLHguJPguJHguYzguYDguKrguKPguLTguKHguK3guLLguKvguLLguKPguKfguLTguJXguLLguKHguLTguJnguIvguLUg4Lie4Lil4Lix4LiqIOC4leC4o+C4siDguJrguKXguLnguYDguJrguLTguKPguYzguJQg4Liq4LmI4Lin4LiZ4Lib4Lij4Liw4LiB4Lit4Lia4LiX4Lix4LmJ4LiH4Lir4Lih4LiU4LmD4LiZIDEg4LmB4LiE4Lib4LiL4Li54LilIOC4quC5iOC4p+C4meC4m+C4o+C4sOC4geC4reC4muC4l+C4teC5iOC4quC4s+C4hOC4seC4jSAoQWN0aXZlIEluZ3JlZGllbnQpIFZJVEFNSU4gQyAoMTAwJSkgLSA2MCDguKHguLTguKXguKXguLTguIHguKPguLHguKEgQ0lUUlVTIEJJT0ZMQVZPTk9JRCBQT1dERVIgLSA2MzAg4Lih4Li04Lil4Lil4Li04LiB4Lij4Lix4LihIEJBUkJBRE9TQ0hFUlJZIFBPV0RFUi9BQ0VST0xBIENIRVJSWSBQT1dERVIgKOC4nOC4h+C4muC4suC4o+C5jOC5gOC4muC5guC4lOC4quC5gOC4iuC4reC4o+C5jOC4o+C4tS/guJzguIfguK3guLDguYDguIvguYLguKPguKXguLLguYDguIrguK3guKPguYzguKPguLUpIChNQUxQSUdISUEgR0xBQlJBIEwuKSDguJzguKUgLSA2MCDguKHguLTguKXguKXguLTguIHguKPguLHguKEgUk9TRUhJUCBQT1dERVIgKOC4nOC4h+C5guC4o+C4quC4ruC4tOC4m+C4quC5jCkgKFJPU0EgQ0FOSU5BIEwuKSDguJzguKUgLSA2MCDguKHguLTguKXguKXguLTguIHguKPguLHguKEgUnV0aW4gLSAzMCDguKHguLTguKXguKXguLTguIHguKPguLHguKEgSU5ESUFOIEdPT1NFQkVSUlkgUE9XREVSICjguJzguIfguKHguLDguILguLLguKHguJvguYnguK3guKEpIChQSFlMTEFOVEhVUyBFTUJMSUNBIEwuICkg4Lic4LilIC0gNjAg4Lih4Li04Lil4Lil4Li04LiB4Lij4Lix4LihIOC4quC5iOC4p+C4meC4m+C4o+C4sOC4geC4reC4muC4l+C4teC5iOC5hOC4oeC5iOC4quC4s+C4hOC4seC4jSAoSW5hY3RpdmUgSW5ncmVkaWVudCkgRURJQkxFIEdFTEFUSU4gNDI4IC0gOTguNSDguKHguLTguKXguKXguLTguIHguKPguLHguKEgVElUQU5JVU0gRElPWElERSAxNzEgLTEuOTUg4Lih4Li04Lil4Lil4Li04LiB4Lij4Lix4LihIOC4p+C4tOC4mOC4teC4o+C4seC4muC4m+C4o+C4sOC4l+C4suC4mSDguITguKPguLHguYnguIfguKXguLAgMS0yIOC5geC4hOC4m+C4i+C4ueC4pSDguKvguKXguLHguIfguK3guLLguKvguLLguKPguYDguIrguYnguLIg4LmA4Lil4LiC4LiX4Li14LmIIOC4rS7guKIuIDMwLTEtMjY3NjQtNS0wMDUxIOC4hOC4s+C5gOC4leC4t+C4reC4mSDguITguKfguKPguYDguIHguYfguJrguYPguKvguYnguJ7guYnguJnguYHguKrguIfguYHguJTguIfguYHguKXguLDguITguKfguLLguKHguIrguLfguYnguJkg4LmA4LiU4LmH4LiBIOC4quC4leC4o+C4teC4oeC4teC4hOC4o+C4o+C4oOC5jCDguYHguKXguLDguKrguJXguKPguLXguYPguKvguYnguJnguKHguJrguLjguJXguKPguYTguKHguYjguITguKfguKPguKPguLHguJrguJvguKPguLDguJfguLLguJkg4LiE4Lin4Lij4LiB4Li04LiZ4Lit4Liy4Lir4Liy4Lij4Lir4Lil4Liy4LiB4Lir4Lil4Liy4Lii4LmD4Lir4LmJ4LiE4Lij4LiaIDUg4Lir4Lih4Li54LmIIOC5g+C4meC4quC4seC4lOC4quC5iOC4p+C4meC4l+C4teC5iOC5gOC4q+C4oeC4suC4sOC4quC4oeC5gOC4m+C5h+C4meC4m+C4o+C4sOC4iOC4syDguYTguKHguYjguKHguLXguJzguKXguYPguJnguIHguLLguKPguJvguYnguK3guIfguIHguLHguJnguKvguKPguLfguK3guKPguLHguIHguKnguLLguYLguKPguIQg4Liq4Lij4Lij4Lie4LiE4Li44LiTIOC4m+C4o+C4sOC5guC4ouC4iuC4meC5jOC4guC4reC4h+C4geC4suC4o+C4geC4tOC4meC4p+C4tOC4leC4suC4oeC4tOC4meC4i+C4tSDvuI/guJfguLPguYPguKvguYnguKvguJnguYnguLLguYTguKHguYjguYLguJfguKPguKEg4Lir4LiZ4LmJ4Liy4LiV4Liy4Liq4LiU4LmD4LiqIO+4j+C4iuC5iOC4p+C4ouC4n+C4t+C5ieC4meC4n+C4ueC4nOC4tOC4p+C4q+C4meC5ieC4siDguKrguLTguKcg4Lid4LmJ4LiyIOC4geC4o+C4sCDguKPguLTguYnguKfguKPguK3guKIg4LiU4Li54LiI4Liy4LiH4Lil4LiHIO+4j+C4nOC4tOC4p+C4nuC4o+C4o+C4k+C4meC4uOC5iOC4oeC5gOC4o+C4teC4ouC4muC5gOC4meC4teC4ouC4miDguIrguLjguYjguKHguIrguLfguYjguJkg77iP4Lir4LiZ4LmJ4Liy4LiV4Liy4LiU4Li54LmA4LiU4LmH4LiB4LmB4Lil4Liw4LmA4LiU4LmJ4LiH4LiC4Li24LmJ4LiZIO+4j+C4nOC4tOC4p+C4q+C4meC5ieC4suC4guC4suC4p+C4reC4oeC4iuC4oeC4nuC4uSDguKrguLTguJnguITguYnguLLguJXguLHguJTguKPguK3guJrguJfguLjguIHguKfguLHguJnguYDguKfguKXguLIg4LiV4Lix4LiU4Lij4Lit4Lia4LmA4Lin4Lil4LiyIDEyLjAwIOC4mSDguILguK3guIfguJfguLjguIHguKfguLHguJkg4LmB4LiI4LmJ4LiH4LmC4Lit4LiZ4LmA4LiB4Li04LiZ4LmA4Lin4Lil4LiyIOC4quC5iOC4h+C4o+C4reC4muC4p+C4seC4meC4luC4seC4lOC5hOC4m+C4meC4sOC4iOC5iuC4sCDguKrguYjguIfguJ7guLHguKrguJTguLjguJfguLjguIHguKfguLHguJkg4LmA4Lin4LmJ4LiZ4Lin4Lix4LiZ4Lit4Liy4LiX4Li04LiV4Lii4LmMIOC5geC4peC4sOC4p+C4seC4meC4q+C4ouC4uOC4lOC4meC4seC4geC4guC4seC4leC4pOC4geC4qeC5jCDguILguK3guJrguJ7guKPguLDguITguLjguJPguKXguLnguIHguITguYnguLLguJfguLjguIHguJfguYjguLLguJkg4LiX4Li14LmI4LmE4Lin4LmJ4Lin4Liy4LiH4LmD4LiI4Lic4Lil4Li04LiV4Lig4Lix4LiT4LiR4LmM4LiC4Lit4LiH4LmA4Lij4Liy4LmA4Liq4Lih4Lit4Lih4LiyXy9sXF8nCiAgICAgIC8vIGNvbnNvbGUubG9nKCdodHRwOi8vMTI3LjAuMC4xOjUwMDAvY2hlY2trZXl3b3JkP3RleHQ9JyArIGRlc2MpOwoKICAgICAgdmFyIGNvbiA9IHsKICAgICAgICBjb250ZW50OiBkZXNjCiAgICAgIH07CiAgICAgIGF4aW9zLnBvc3QoTGlua1NlcnZpY2UuZ2V0cHl0aG9ubGluaygpICsgIi9jaGVja2tleXdvcmQ/dGV4dD0iLCBjb24pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgICBpZiAocmVzLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgLy8gdGhpcy5rZXl3b3JkLnB1c2gocmVzLmRhdGEpCiAgICAgICAgICBfdGhpczMua2V5d29yZCA9IHJlcy5kYXRhOwogICAgICAgIH0KICAgICAgfSk7IC8vICAgICB9CiAgICAgIC8vIH0pOwogICAgICAvLyAgICAgICB2YXIgbGlzdGtleXdvcmRzID0gW10KICAgICAgLy8gICAgICAgdmFyIG5hbWVzcGxpdCA9IG5hbWUuc3BsaXQoIiAiKQogICAgICAvLyAgICAgICAvLyBjb25zb2xlLmxvZyhuYW1lc3BsaXQpOwogICAgICAvLyAgICAgICBheGlvcy5nZXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9hcGkva2V5d29yZF9kaWN0cz9uYW1lPTEnKS50aGVuKChyZXMpID0+IHsKICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgIC8vICAgICAgICAgdmFyIGtleWxpc3QgPSBbXQogICAgICAvLyAgICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgcmVzLmRhdGEubGVuZ3RoOyByKyspIHsKICAgICAgLy8gICAgICAgICAgIHJlcy5kYXRhW3JdLm5hbWUgPSByZXMuZGF0YVtyXS5uYW1lLnJlcGxhY2VBbGwoIi4iLCIiKQogICAgICAvLyAgICAgICAgICAgdmFyIGtrID0gcmVzLmRhdGFbcl0ubmFtZS5zcGxpdCgiICIpCiAgICAgIC8vICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IGtrLmxlbmd0aDsgaysrKSB7CiAgICAgIC8vICAgICAgICAgICAgIGtleWxpc3QucHVzaChra1trXSkKICAgICAgLy8gICAgICAgICAgIH0KICAgICAgLy8gICAgICAgICB9CiAgICAgIC8vICAgICAgICAgZm9yIChsZXQga2V5ID0gMDsga2V5IDwga2V5bGlzdC5sZW5ndGg7IGtleSsrKSB7CiAgICAgIC8vICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IG5hbWVzcGxpdC5sZW5ndGg7IG4rKykgewogICAgICAvLyAgICAgICAgICAgICBpZiAobmFtZXNwbGl0W25dID09IGtleWxpc3Rba2V5XSAmJiBrZXlsaXN0W2tleV0gIT0gJycgJiYgaXNOYU4oa2V5bGlzdFtrZXldKSkgewogICAgICAvLyAgICAgICAgICAgICAgIGxpc3RrZXl3b3Jkcy5wdXNoKGtleWxpc3Rba2V5XSkKICAgICAgLy8gICAgICAgICAgICAgfQogICAgICAvLyAgICAgICAgICAgfQogICAgICAvLyAgICAgICAgIH0KICAgICAgLy8gICAgICAgICAvLyBjb25zb2xlLmxvZyhrZXlsaXN0KTsKICAgICAgLy8gICAgICAgICAvLyBjb25zb2xlLmxvZyhsaXN0a2V5d29yZHMpOwogICAgICAvLyAgICAgICBjb25zb2xlLmxvZyhsaXN0a2V5d29yZHMubGVuZ3RoKTsKICAgICAgLy8gICAgICAgICBpZiAobGlzdGtleXdvcmRzLmxlbmd0aCA9PSAwKSB7CiAgICAgIC8vICAgICAgICAgICB0aGlzLmNvbG9ya2V5ID0gImJhY2tncm91bmQtY29sb3I6I2EzZTlhNCIKICAgICAgLy8gICAgICAgICB9CiAgICAgIC8vICAgICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICAvLyAgICAgICAgIGxpc3RrZXl3b3Jkcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgLy8gICAgICBpZihyZXN1bHQuaW5kZXhPZihpdGVtKSA8IDApIHsKICAgICAgLy8gICAgICAgICAgcmVzdWx0LnB1c2goaXRlbSk7CiAgICAgIC8vICAgICAgfQogICAgICAvLyB9KTsKICAgICAgLy8gY29uc29sZS5sb2cocmVzdWx0KTsKICAgICAgLy8gbGlzdGtleXdvcmRzID0gcmVzdWx0CiAgICAgIC8vICAgICAgICAgZm9yIChsZXQgbCA9IDA7IGwgPCBsaXN0a2V5d29yZHMubGVuZ3RoOyBsKyspIHsKICAgICAgLy8gICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdodHRwOi8vMTI3LjAuMC4xOjUwMDAvY2hlY2trZXl3b3JkP25hbWU9JyArIG5hbWUrJyYmbmFtZV9yZWFsPScpOwogICAgICAvLyAgICAgICAgICAgYXhpb3MuZ2V0KCdodHRwOi8vMTI3LjAuMC4xOjUwMDAvY2hlY2trZXl3b3JkP25hbWU9JyArIG5hbWUrJyYmbmFtZV9yZWFsPScgKyBsaXN0a2V5d29yZHNbbF0pLnRoZW4oKHJlcykgPT4gewogICAgICAvLyAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgIC8vICAgICAgICAgdGhpcy5rZXl3b3JkLnB1c2gocmVzLmRhdGEpCiAgICAgIC8vICAgICAgIH0pOwogICAgICAvLyAgICAgICAgIH0KICAgICAgLy8gICAgICAgfSk7CiAgICB9LAogICAgZmluZGRlc2NyaXB0aW9uOiBmdW5jdGlvbiBmaW5kZGVzY3JpcHRpb24oZGF0YSkgewogICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgdmFyIHRleHQgPSBbIuC4o+C4suC4ouC4peC4sOC5gOC4reC4teC4ouC4lCJdOwogICAgICB2YXIgZmluZGZkYSA9IGRhdGE7CgogICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IHRleHQubGVuZ3RoOyB0KyspIHsKICAgICAgICBpZiAoZmluZGZkYS5pbmRleE9mKHRleHRbdF0pICE9IC0xKSB7CiAgICAgICAgICBmaW5kZmRhID0gZmluZGZkYS5zdWJzdHJpbmcoZmluZGZkYS5pbmRleE9mKHRleHRbdF0pKTsKICAgICAgICB9CiAgICAgIH0gLy8gaWYgKGZpbmRmZGEgPT0gJ+C4reC4suC4q+C4suC4oycpIHsKICAgICAgLy8gICBmaW5kZmRhID0gZmluZGZkYSsgZmluZGZkYSsn4LmA4Liq4Lij4Li04LihJwogICAgICAvLyB9CiAgICAgIC8vIGNvbnNvbGUubG9nKGZpbmRmZGEpOwoKCiAgICAgIHJldHVybiBmaW5kZmRhOwogICAgfSwKICAgIGxvYWRkaWN0OiBmdW5jdGlvbiBsb2FkZGljdCgpIHsKICAgICAgYXhpb3MuZ2V0KExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSArICIvbG9hZGRpY3QiKS50aGVuKCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpKTsKICAgIH0sCiAgICBnZXRkZXRhaWw6IGZ1bmN0aW9uIGdldGRldGFpbCgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICAvLyB2YXIgdXJsID0gdGhpcy5kYXRhLnVybC5zcGxpdCgiLWkuIik7CiAgICAgIHZhciBzZWxlY3Rwcm8gPSB7CiAgICAgICAgdXJsOiB0aGlzLmRhdGEudXJsLAogICAgICAgIGlkOiB0aGlzLmN1cnJlbnRVc2VyLmlkCiAgICAgIH07CiAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuZ2V0cHJvZHVjdF90b2tlbihzZWxlY3Rwcm8pLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9yZWY1ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShyZXMpIHsKICAgICAgICAgIHZhciBiZXN0OwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgIGJlc3QgPSBfdGhpczQuZ2V0TWF4KHJlcy5kYXRhLmtleXdvcmQsICdjb3VudF9ydWxlYmFzZWQnKTsgLy9jb25zb2xlLmxvZyhiZXN0KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNC5saXN0ID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgICAgIF90aGlzNC5saXN0LmtleXdvcmQgPSBbYmVzdF07CiAgICAgICAgICAgICAgICAgIF90aGlzNC5zdGF0dXMgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICAgIH0pKTsKCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDMpIHsKICAgICAgICAgIHJldHVybiBfcmVmNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH0oKSk7CiAgICB9LAogICAgc2VhcmNoOiBmdW5jdGlvbiBzZWFyY2goKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgICAgdmFyIGNvbiwgY29udGVudCwgc2VsZWN0cHJvOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb24gPSB7fTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczUubG9hZGRpY3QoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3RoaXM1LnN0YXR1cyA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczUuZGF0YS51cmwgPT0gbnVsbCB8fCBfdGhpczUuZGF0YS51cmwgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgYWxlcnQoIuC4geC4o+C4uOC4k+C4suC4geC4o+C4reC4gSBVUkwiKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXM1LmRhdGEuY29udGVudCA9PSBudWxsIHx8IF90aGlzNS5kYXRhLmNvbnRlbnQgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgYWxlcnQoIuC4geC4o+C4uOC4k+C4suC4geC4o+C4reC4geC4guC5ieC4reC4hOC4p+C4suC4oeC5guC4huC4qeC4k+C4siIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY29udGVudCA9ICIiOwogICAgICAgICAgICAgICAgICBjb250ZW50ID0gX3RoaXM1LmRhdGEuY29udGVudC5yZXBsYWNlQWxsKC8oW1x1RTAwMC1cdUY4RkZdfFx1RDgzQ1tcdURGMDAtXHVERkZGXXxcdUQ4M0RbXHVEQzAwLVx1RERGRl0pL2csICIiKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvKD86W1x1MjcwMC1cdTI3YmZdfCg/Olx1ZDgzY1tcdWRkZTYtXHVkZGZmXSl7Mn18W1x1ZDgwMC1cdWRiZmZdW1x1ZGMwMC1cdWRmZmZdfFtcdTAwMjMtXHUwMDM5XVx1ZmUwZj9cdTIwZTN8XHUzMjk5fFx1MzI5N3xcdTMwM2R8XHUzMDMwfFx1MjRjMnxcdWQ4M2NbXHVkZDcwLVx1ZGQ3MV18XHVkODNjW1x1ZGQ3ZS1cdWRkN2ZdfFx1ZDgzY1x1ZGQ4ZXxcdWQ4M2NbXHVkZDkxLVx1ZGQ5YV18XHVkODNjW1x1ZGRlNi1cdWRkZmZdfFx1ZDgzY1tcdWRlMDEtXHVkZTAyXXxcdWQ4M2NcdWRlMWF8XHVkODNjXHVkZTJmfFx1ZDgzY1tcdWRlMzItXHVkZTNhXXxcdWQ4M2NbXHVkZTUwLVx1ZGU1MV18XHUyMDNjfFx1MjA0OXxbXHUyNWFhLVx1MjVhYl18XHUyNWI2fFx1MjVjMHxbXHUyNWZiLVx1MjVmZV18XHUwMGE5fFx1MDBhZXxcdTIxMjJ8XHUyMTM5fFx1ZDgzY1x1ZGMwNHxbXHUyNjAwLVx1MjZGRl18XHUyYjA1fFx1MmIwNnxcdTJiMDd8XHUyYjFifFx1MmIxY3xcdTJiNTB8XHUyYjU1fFx1MjMxYXxcdTIzMWJ8XHUyMzI4fFx1MjNjZnxbXHUyM2U5LVx1MjNmM118W1x1MjNmOC1cdTIzZmFdfFx1ZDgzY1x1ZGNjZnxcdTI5MzR8XHUyOTM1fFtcdTIxOTAtXHUyMWZmXSkvZywgIiAiKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXHVkODNkW1x1ZGUwMC1cdWRlNGZdL2csICIgIik7CiAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoLyhcclxufFxufFxyKS9nbSwgJyAnKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiXyIsICIiKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiISIsICIiKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiKiIsICIiKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiJiIsICIiKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiIyIsICIiKTsKICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgi4oCiIiwgIiIpOwogICAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCIrIiwgIiIpOwogICAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCJfL2xfIiwgIiIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCgogICAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKC8oW1x1MjcwMC1cdTI3QkZdfFtcdUUwMDAtXHVGOEZGXXxcdUQ4M0NbXHVEQzAwLVx1REZGRl18XHVEODNEW1x1REMwMC1cdURGRkZdfFtcdTIwMTEtXHUyNkZGXXxcdUQ4M0VbXHVERDEwLVx1RERGRl0pL2csICcgJyk7IC8vIHZhciB1cmwgPSB0aGlzLmRhdGEudXJsLnNwbGl0KCItaS4iKTsKICAgICAgICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKHVybCk7CgogICAgICAgICAgICAgICAgICBzZWxlY3Rwcm8gPSB7CiAgICAgICAgICAgICAgICAgICAgdXJsOiBfdGhpczUuZGF0YS51cmwsCiAgICAgICAgICAgICAgICAgICAgaWQ6IF90aGlzNS5jdXJyZW50VXNlci5pZAogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICBNYXBSdWxlQmFzZWRTZXJ2aWNlLmdldHByb2R1Y3RfdG9rZW4oc2VsZWN0cHJvKS50aGVuKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBfcmVmNiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuZGF0YS5sZW5ndGggPT0gMCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSsnL3dvcmt0b2tlbmRlc2M/dGV4dD0nICsgY29udGVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbiA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QoTGlua1NlcnZpY2UuZ2V0cHl0aG9ubGluaygpICsgIi93b3JkdG9rZW5kZXNjIiwgY29uKS50aGVuKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmNyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhciBzZW50ZW5jZSA9IHJlcy5kYXRhLnNlbnRlbnQucmVwbGFjZUFsbCgiPHNwYW5zdHlsZSIsICI8c3BhbiBzdHlsZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBfdGhpczUuZGF0YS51cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2U6IGNvbnRlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2Vfa2V5d29yZDogcmVzLmRhdGEuc2VudGVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXl3b3JkX2lkOiByZXMuZGF0YS5rZXl3b3JkSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07IC8vY29uc29sZS5sb2coZGVzKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hcFJ1bGVCYXNlZFNlcnZpY2UuY3JlYXRlcHJvZHVjdF90b2tlbihkZXMpLnRoZW4oZnVuY3Rpb24gKHByb2R1Y3R0b2tlbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2R1Y3R0b2tlbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LnByb2R1Y3RfdG9rZW4gPSBwcm9kdWN0dG9rZW4uZGF0YS5pZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb24gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsgLy9jb25zb2xlLmxvZyhjb24pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGNvbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpb3MucG9zdChMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkgKyAiL2NoZWNra2V5d29yZCIsIGNvbikudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmOCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfbG9vcDMsIHIsIHNlbnRlbmNldG9rZW4sIGFkdmVydGlzZTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb29wMyA9IGZ1bmN0aW9uIF9sb29wMyhyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRlbmNldG9rZW4gPSByZXMuZGF0YVtyXS5zZW50ZW50LnJlcGxhY2VBbGwoJyInLCAiIik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2V0b2tlbiA9IHNlbnRlbmNldG9rZW4ucmVwbGFjZUFsbCgiPHNwYW5zdHlsZSIsICI8c3BhbiBzdHlsZSIpOyAvLyBzZW50ZW5jZXRva2VuID0gc2VudGVuY2V0b2tlbi5yZXBsYWNlQWxsKCciY29sb3I6cmVkXCInLCciY29sb3I6cmVkIicpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW50ZW5jZXRva2VuID0gc2VudGVuY2V0b2tlbi5yZXBsYWNlQWxsKCciY29sb3I6cmVkXCInLCciY29sb3I6cmVkIicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkdmVydGlzZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3Rva2VuX2lkOiBfdGhpczUucHJvZHVjdF90b2tlbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXl3b3JkX2RpY3RfaWQ6IHJlcy5kYXRhW3JdLmtleXdvcmRfZGljdF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWN0X2lkOiByZXMuZGF0YVtyXS5kaWN0X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpY3RfbmFtZTogcmVzLmRhdGFbcl0uZGljdF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRlbnQ6IHNlbnRlbmNldG9rZW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuOiByZXMuZGF0YVtyXS5zZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsgLy9jb25zb2xlLmxvZyh0aGlzLnByb2R1Y3RfdG9rZW4pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnByb2R1Y3RfdG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZHZlcnRpc2VTZXJ2aWNlLmNyZWF0ZWFkdmVydGlzZShhZHZlcnRpc2UpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyICsgMSA9PSByZXMuZGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuZ2V0cHJvZHVjdGtleXdvcmQoc2VsZWN0cHJvKS50aGVuKGZ1bmN0aW9uIChwcm8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LnByb2R1Y3RfdG9rZW4gPSBwcm8uZGF0YS5pZDsgLy8gdGhpcy5saXN0ID0gcmVzLmRhdGEKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMubGlzdCA9IHJlcy5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS50b2tlbmRhdGEocHJvLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChyID0gMDsgciA8IHJlcy5kYXRhLmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb29wMyhyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmdldGRldGFpbCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gLy8gaWYgKGtleXMuZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICByZXMuZGF0YVtsXS5rZXl3b3JkID0ga2V5cy5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIHJlcy5kYXRhW2xdLmtleXdvcmQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIChsICsgMSA9PSByZXMuZGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIHRoaXMubGlzdCA9IHJlcy5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfQoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94NikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94NSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWY3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSgpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmdldGRldGFpbCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS50b2tlbmRhdGEocmVzLmRhdGEpOyAvLyB0aGlzLmxpc3QgPSByZXMuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnByb2R1Y3RfdG9rZW4gPSByZXMuZGF0YS5pZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAvLyBjb25zb2xlLmxvZyh0aGlzLmxpc3QpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnN0YXR1cyA9IHRydWUKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlOCk7CiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94NCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWY2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfSgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZ2V0TWF4OiBmdW5jdGlvbiBnZXRNYXgoYXJyLCBwcm9wKSB7CiAgICAgIHZhciBtYXg7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChtYXggPT0gbnVsbCB8fCBwYXJzZUludChhcnJbaV1bcHJvcF0pID4gcGFyc2VJbnQobWF4W3Byb3BdKSkgbWF4ID0gYXJyW2ldOwogICAgICB9CgogICAgICByZXR1cm4gbWF4OwogICAgfSwKICAgIHRva2VuZGF0YTogZnVuY3Rpb24gdG9rZW5kYXRhKGxpc3QpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICAvL2NvbnNvbGUubG9nKGxpc3QpOwogICAgICBpZiAobGlzdC5rZXl3b3JkLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgX2xvb3A0ID0gZnVuY3Rpb24gX2xvb3A0KGwpIHsKICAgICAgICAgIC8vY29uc29sZS5sb2cobGlzdC5rZXl3b3JkW2xdLmtleXdvcmRfZGljdF9pZCk7CiAgICAgICAgICBpZiAobGlzdC5rZXl3b3JkW2xdLmtleXdvcmRfZGljdF9pZCkgewogICAgICAgICAgICBtYXAgPSB7CiAgICAgICAgICAgICAgaWQ6IGxpc3Qua2V5d29yZFtsXS5pZCwKICAgICAgICAgICAgICB1cmw6IGxpc3Qua2V5d29yZFtsXS5rZXl3b3JkX2RpY3RfaWQsCiAgICAgICAgICAgICAga2V5d29yZF9pZDogbGlzdC5rZXl3b3JkW2xdLmRpY3RfaWQKICAgICAgICAgICAgfTsgLy8gY29uc29sZS5sb2cobWFwKTsKCiAgICAgICAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UuZ2V0bWFwcHJvZHVjdChtYXApLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgICAgICAgIHZhciBiZXN0ZGF0YSA9IF90aGlzNi5nZXRNYXgocmVzLmRhdGEsICdhbGxjb3VudCcpOyAvL2NvbnNvbGUubG9nKGJlc3RkYXRhKTsKCgogICAgICAgICAgICAgIHZhciBiZXN0ID0gewogICAgICAgICAgICAgICAgaWQ6IGxpc3Qua2V5d29yZFtsXS5pZCwKICAgICAgICAgICAgICAgIHNlbnRlbmNlOiBiZXN0ZGF0YQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgTWFwUnVsZUJhc2VkU2VydmljZS5nZXRiZXN0cnVsZWJhc2VkKGJlc3QpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICB2YXIgcnVsZWJhc2VkID0gewogICAgICAgICAgICAgICAgICBjb3VudF9ydWxlYmFzZWQ6IHJlcy5kYXRhLmNvdW50LAogICAgICAgICAgICAgICAgICBzZW50ZW5jZV9ydWxlYmFzZTogcmVzLmRhdGEuc2VudGVuY2UsCiAgICAgICAgICAgICAgICAgIHJ1bGVfYmFzZWRfaWQ6IHJlcy5kYXRhLnJ1bGVfYmFzZWRfaWQsCiAgICAgICAgICAgICAgICAgIHJ1bGVfYmFzZWRfbmFtZTogcmVzLmRhdGEucnVsZV9iYXNlZF9uYW1lCiAgICAgICAgICAgICAgICB9OyAvLyBjb25zb2xlLmxvZyhsaXN0LmtleXdvcmRbbF0uaWQpOwoKICAgICAgICAgICAgICAgIE1hcFJ1bGVCYXNlZFNlcnZpY2UudXBkYXRlcnVsZWJhc2VkKGxpc3Qua2V5d29yZFtsXS5pZCwgcnVsZWJhc2VkKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgaWYgKGwgKyAxID09IGxpc3Qua2V5d29yZC5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczYuZ2V0ZGV0YWlsKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pOyAvLyBsaXN0LmtleXdvcmRbbF0ucnVsZWJhc2UgPSByZXMuZGF0YTsKICAgICAgICAgICAgICAvLyBpZiAobCArIDEgPT0gbGlzdC5rZXl3b3JkLmxlbmd0aCkgewogICAgICAgICAgICAgIC8vICAgdGhpcy5jb21wYXJlKGxpc3QpOwogICAgICAgICAgICAgIC8vIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IC8vIH0KCiAgICAgICAgfTsKCiAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBsaXN0LmtleXdvcmQubGVuZ3RoOyBsKyspIHsKICAgICAgICAgIHZhciBtYXA7CgogICAgICAgICAgX2xvb3A0KGwpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmdldGRldGFpbCgpOwogICAgICB9CiAgICB9LAogICAgY29tcGFyZTogZnVuY3Rpb24gY29tcGFyZShsaXN0KSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdmFyIF9sb29wNSA9IGZ1bmN0aW9uIF9sb29wNShrKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2cobGlzdC5rZXl3b3JkW2tdKTsKICAgICAgICBkaWN0X2lkID0gSlNPTi5wYXJzZShsaXN0LmtleXdvcmRba10uZGljdF9pZCk7IC8vIHZhciBydWxlYmFzZWQgPSBKU09OLnBhcnNlKGxpc3Qua2V5d29yZFtrXS5ydWxlYmFzZSkKICAgICAgICAvLyBjb25zb2xlLmxvZyhsaXN0LmtleXdvcmRba10ucnVsZWJhc2VkKTsKCiAgICAgICAgaWYgKGxpc3Qua2V5d29yZFtrXS5ydWxlYmFzZSkgewogICAgICAgICAgdmFyIHVuaXF1ZUNoYXJzcnVsZSA9IGxpc3Qua2V5d29yZFtrXS5ydWxlYmFzZS5maWx0ZXIoZnVuY3Rpb24gKGMsIGluZGV4KSB7CiAgICAgICAgICAgIHJldHVybiBsaXN0LmtleXdvcmRba10ucnVsZWJhc2UuaW5kZXhPZihjKSA9PT0gaW5kZXg7CiAgICAgICAgICB9KTsKICAgICAgICAgIGZpbHRlcmVkQXJyYXkgPSBkaWN0X2lkLmZpbHRlcihmdW5jdGlvbiAobikgewogICAgICAgICAgICByZXR1cm4gdW5pcXVlQ2hhcnNydWxlLmluZGV4T2YobikgIT09IC0xOwogICAgICAgICAgfSk7IC8vIGNvbnNvbGUubG9nKGZpbHRlcmVkQXJyYXkpOwogICAgICAgICAgLy8gY29uc29sZS5sb2coJ2ZpbHRlcmVkQXJyYXknLGZpbHRlcmVkQXJyYXkpOwogICAgICAgICAgLy8gY29uc29sZS5sb2coJ2RpY3RfaWQnLGRpY3RfaWQubGVuZ3RoKTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHN1bWRpY3RJZC5sZW5ndGgpOwoKICAgICAgICAgIHBlcmNlbnRhZ2UgPSAxMDAgKiBwYXJzZUludChmaWx0ZXJlZEFycmF5Lmxlbmd0aCkgLyBwYXJzZUludChkaWN0X2lkLmxlbmd0aCk7IC8vIGNvbnNvbGUubG9nKHBlcmNlbnRhZ2UpOwoKICAgICAgICAgIGxpc3Qua2V5d29yZFtrXS5wZXJjZW50YWdlID0gcGVyY2VudGFnZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGlzdC5rZXl3b3JkW2tdLnBlcmNlbnRhZ2UgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKGsgKyAxID09IGxpc3Qua2V5d29yZC5sZW5ndGgpIHsKICAgICAgICAgIF90aGlzNy5saXN0ID0gbGlzdDsKICAgICAgICAgIF90aGlzNy5zdGF0dXMgPSB0cnVlOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgbGlzdC5rZXl3b3JkLmxlbmd0aDsgaysrKSB7CiAgICAgICAgdmFyIGRpY3RfaWQ7CiAgICAgICAgdmFyIGZpbHRlcmVkQXJyYXk7CiAgICAgICAgdmFyIHBlcmNlbnRhZ2U7CgogICAgICAgIF9sb29wNShrKTsKICAgICAgfQogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsvLyB0aGlzLmRhdGEudXJsID0KICAgIC8vICAgImh0dHBzOi8vc2hvcGVlLmNvLnRoLyVFMiU5OSVBNiVFRiVCOCU4RiVFMCVCOSU4MiVFMCVCOCU4OSVFMCVCOCVBMSVFMCVCOSU4MyVFMCVCOCVBQiVFMCVCOCVBMSVFMCVCOSU4OC0lRTAlQjglODIlRTAlQjglQUQlRTAlQjglODclRTAlQjklODElRTAlQjglOTclRTAlQjklODklRTIlOTklQTYlRUYlQjglOEYtJUUwJUI4JTgyJUUwJUI4JUIyJUUwJUI4JUEyJUUwJUI4JTk0JUUwJUI4JUI1JUUwJUI4JUExJUUwJUI4JUIyJUUwJUI4JTgxLSVFMCVCOCU4MSVFMCVCOCVCMiVFMCVCOSU4MSVFMCVCOCU5Ri0lRTAlQjglQTUlRTAlQjglQjQlRTAlQjklODIlRTAlQjglOEIlRTAlQjklODgtJUUwJUI4JTlFJUUwJUI4JUE1JUUwJUI4JUIxJUUwJUI4JUFBLSVFMiU4MCU4Qi1jb2ZmZWUtbGlzaG91LSVFMCVCOCU4MSVFMCVCOCVCMiVFMCVCOSU4MSVFMCVCOCU5RiVFMCVCOCU4NCVFMCVCOCVBNyVFMCVCOCU5QSVFMCVCOCU4NCVFMCVCOCVCOCVFMCVCOCVBMSVFMCVCOCU5OSVFMCVCOSU4OSVFMCVCOCVCMyVFMCVCOCVBQiVFMCVCOCU5OSVFMCVCOCVCMSVFMCVCOCU4MS0lRTAlQjglODElRTAlQjglQjIlRTAlQjklODElRTAlQjglOUYlRTAlQjglODQlRTAlQjglQjglRTAlQjglQTElRTAlQjglQUIlRTAlQjglQjQlRTAlQjglQTctJUUwJUI4JTgxJUUwJUI4JUIyJUUwJUI5JTgxJUUwJUI4JTlGJUUwJUI4JUE1JUUwJUI4JTk0JUUwJUI4JTk5JUUwJUI5JTg5JUUwJUI4JUIzJUUwJUI4JUFCJUUwJUI4JTk5JUUwJUI4JUIxJUUwJUI4JTgxLSVFMCVCOCU4MSVFMCVCOCVCMiVFMCVCOSU4MSVFMCVCOCU5RiVFMCVCOCVBNSVFMCVCOCU5NCVFMCVCOCU4NCVFMCVCOCVBNyVFMCVCOCVCMiVFMCVCOCVBMSVFMCVCOCVBRCVFMCVCOSU4OSVFMCVCOCVBNyVFMCVCOCU5OSI7CiAgICAvLyB0aGlzLmRhdGEuY29udGVudCA9CiAgICAvLyAgICLvuI/guJbguYnguLLguYDguJvguYfguJnguKXguLnguIHguITguYnguLLguJ7guLTguKHguYHguKXguYnguKcg4LiU4Li54LmB4Lil4LiI4LiZ4LiZ4LmJ4Liz4Lir4LiZ4Lix4LiB4Lil4LiU4LmA4Lil4Lii4LiE4LmI4LiwIOC4quC4seC5iOC4h+C4i+C4t+C5ieC4reC4quC4tOC4meC4hOC5ieC4suC5geC4peC5ieC4pyDguJfguLHguIHguYHguIrguJfguKHguLLguITguLjguKLguIHguLHguJnguYTguJTguYnguYDguKXguKLguITguYjguLAiOwogICAgLy8gLy8gdmFyIHVybCA9IHRoaXMuZGF0YS51cmwuc3BsaXQoJy1pLicpCiAgICAvLyB2YXIgY29udGVudCA9IHRoaXMuZGF0YS5jb250ZW50LnJlcGxhY2VBbGwoCiAgICAvLyAgIC8oW1x1RTAwMC1cdUY4RkZdfFx1RDgzQ1tcdURGMDAtXHVERkZGXXxcdUQ4M0RbXHVEQzAwLVx1RERGRl0pL2csCiAgICAvLyAgICIiCiAgICAvLyApOwogICAgLy8gY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgKICAgIC8vICAgLyg/OltcdTI3MDAtXHUyN2JmXXwoPzpcdWQ4M2NbXHVkZGU2LVx1ZGRmZl0pezJ9fFtcdWQ4MDAtXHVkYmZmXVtcdWRjMDAtXHVkZmZmXXxbXHUwMDIzLVx1MDAzOV1cdWZlMGY/XHUyMGUzfFx1MzI5OXxcdTMyOTd8XHUzMDNkfFx1MzAzMHxcdTI0YzJ8XHVkODNjW1x1ZGQ3MC1cdWRkNzFdfFx1ZDgzY1tcdWRkN2UtXHVkZDdmXXxcdWQ4M2NcdWRkOGV8XHVkODNjW1x1ZGQ5MS1cdWRkOWFdfFx1ZDgzY1tcdWRkZTYtXHVkZGZmXXxcdWQ4M2NbXHVkZTAxLVx1ZGUwMl18XHVkODNjXHVkZTFhfFx1ZDgzY1x1ZGUyZnxcdWQ4M2NbXHVkZTMyLVx1ZGUzYV18XHVkODNjW1x1ZGU1MC1cdWRlNTFdfFx1MjAzY3xcdTIwNDl8W1x1MjVhYS1cdTI1YWJdfFx1MjViNnxcdTI1YzB8W1x1MjVmYi1cdTI1ZmVdfFx1MDBhOXxcdTAwYWV8XHUyMTIyfFx1MjEzOXxcdWQ4M2NcdWRjMDR8W1x1MjYwMC1cdTI2RkZdfFx1MmIwNXxcdTJiMDZ8XHUyYjA3fFx1MmIxYnxcdTJiMWN8XHUyYjUwfFx1MmI1NXxcdTIzMWF8XHUyMzFifFx1MjMyOHxcdTIzY2Z8W1x1MjNlOS1cdTIzZjNdfFtcdTIzZjgtXHUyM2ZhXXxcdWQ4M2NcdWRjY2Z8XHUyOTM0fFx1MjkzNXxbXHUyMTkwLVx1MjFmZl0pL2csCiAgICAvLyAgICIiCiAgICAvLyApOwogICAgLy8gY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvKFxyXG58XG58XHIpL2dtLCAiIik7CiAgICAvLyBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCJfIiwgIiIpOwogICAgLy8gY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiISIsICIiKTsKICAgIC8vIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoIioiLCAiIik7CiAgICAvLyBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKCImIiwgIiIpOwogICAgLy8gY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgiIyIsICIiKTsKICAgIC8vIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoYF8vbFxfYCwgIiIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAvLyAvLyBjb25zb2xlLmxvZyhMaW5rU2VydmljZS5nZXRweXRob25saW5rKCkrJy93b3JkdG9rZW5kZXNjP3RleHQ9JyArIGNvbnRlbnQpOwogICAgLy8gLy8gYXhpb3MuZ2V0KExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSsnL3dvcmR0b2tlbmRlc2M/dGV4dD0nK2NvbnRlbnQpLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgLy8gLy8gICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAvLyAvLyB9KQogICAgLy8gY29uc29sZS5sb2coTGlua1NlcnZpY2UuZ2V0cHl0aG9ubGluaygpICsgIi9jaGVja2tleXdvcmQ/dGV4dD0iICsgY29udGVudCk7CiAgICAvLyB2YXIgY29uID0gewogICAgLy8gICBjb250ZW50OiBjb250ZW50LAogICAgLy8gfTsKICAgIC8vIGF4aW9zCiAgICAvLyAgIC5wb3N0KExpbmtTZXJ2aWNlLmdldHB5dGhvbmxpbmsoKSArICIvY2hlY2trZXl3b3JkP3RleHQ9IiArIGNvbnRlbnQsIGNvbikKICAgIC8vICAgLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgLy8gICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgIC8vICAgICAvLyAgICAgICBmb3IgKGxldCByID0gMDsgciA8IHJlcy5kYXRhLmxlbmd0aDsgcisrKSB7CiAgICAvLyAgICAgLy8gICAgICAgICB2YXIgYWR2ZXJ0aXNlID0gewogICAgLy8gICAgIC8vICAgICAgICAgICBwcm9kdWN0X3Rva2VuX2lkOjEsCiAgICAvLyAgICAgLy8gICAgICAgICAgIGtleXdvcmRfZGljdF9pZDpyZXMuZGF0YVtyXS5rZXl3b3JkX2RpY3RfaWQsCiAgICAvLyAgICAgLy8gICAgICAgICAgIGRpY3RfaWQ6cmVzLmRhdGFbcl0uZGljdF9pZCwKICAgIC8vICAgICAvLyAgICAgICAgICAgZGljdF9uYW1lOnJlcy5kYXRhW3JdLmRpY3RfbmFtZSwKICAgIC8vICAgICAvLyAgICAgICAgICAgc2VuOnJlcy5kYXRhW3JdLnNlbiwKICAgIC8vICAgICAvLyAgICAgICAgICAgc2VudGVudDpyZXMuZGF0YVtyXS5zZW50ZW50LAogICAgLy8gICAgIC8vICAgICAgICAgfQogICAgLy8gICAgIC8vICAgICAgICAgQWR2ZXJ0aXNlU2VydmljZS5jcmVhdGVhZHZlcnRpc2UoYWR2ZXJ0aXNlKS50aGVuKChyZXMpPT57CiAgICAvLyAgICAgLy8gICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgIC8vICAgICAvLyAgICAgICAgIH0pCiAgICAvLyAgICAgLy8gICAgICAgfQogICAgLy8gICB9KTsKICAgIC8vIC8vICBjb25zb2xlLmxvZyh1cmwpOwogICAgLy8gLy8gICAgIHZhciBzZWxlY3Rwcm8gPSB7CiAgICAvLyAvLyAgICAgICB1cmw6dXJsWzBdCiAgICAvLyAvLyAgICAgIH0KICAgIC8vIC8vICAgICAgTWFwUnVsZUJhc2VkU2VydmljZS5nZXRwcm9kdWN0X3Rva2VuKHNlbGVjdHBybykudGhlbigocmVzKT0+ewogICAgLy8gLy8gICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgLy8gLy8gdmFyIGxpc3QgPSByZXMuZGF0YQogICAgLy8gLy8gdGhpcy50b2tlbmRhdGEobGlzdCkKICAgIC8vIC8vIGZvciAobGV0IGwgPSAwOyBsIDwgbGlzdC5rZXl3b3JkLmxlbmd0aDsgbCsrKSB7CiAgICAvLyAvLyAgIC8vIGNvbnNvbGUubG9nKHRoaXMubGlzdC5rZXl3b3JkW2xdLm1hcCk7CiAgICAvLyAvLyAgIC8vIGZvciAobGV0IG0gPSAwOyBtIDwgdGhpcy5saXN0LmtleXdvcmRbbF0ubGVuZ3RoOyBtKyspIHsKICAgIC8vIC8vICAgICBpZiAobGlzdC5rZXl3b3JkW2xdLm1hcCkgewogICAgLy8gLy8gICAgICAgdmFyIG1hcCA9IHsKICAgIC8vIC8vICAgICB1cmw6SlNPTi5zdHJpbmdpZnkobGlzdC5rZXl3b3JkW2xdLm1hcCkKICAgIC8vIC8vICAgICAgfQogICAgLy8gLy8gICAgIC8vICBjb25zb2xlLmxvZyhtYXApOwogICAgLy8gLy8gICAgICBNYXBSdWxlQmFzZWRTZXJ2aWNlLmdldG1hcHByb2R1Y3QobWFwKS50aGVuKChyZXMpPT57CiAgICAvLyAvLyAgICAgICBsaXN0LmtleXdvcmRbbF0ucnVsZWJhc2UgPSByZXMuZGF0YQogICAgLy8gLy8gICAgICAgaWYgKGwrMSA9PSBsaXN0LmtleXdvcmQubGVuZ3RoKSB7CiAgICAvLyAvLyAgICAgICAgIHRoaXMuY29tcGFyZShsaXN0KQogICAgLy8gLy8gICAgICAgfQogICAgLy8gLy8gICAgICB9KTsKICAgIC8vIC8vICAgICB9CiAgICAvLyAvLyAgIH0KICAgIC8vIC8vIH0KICAgIC8vIC8vIGNvbnNvbGUubG9nKHRoaXMubGlzdCk7CiAgICAvLyB0aGlzLnN0YXR1cyA9IHRydWU7CiAgICAvLyAvLyAgfSkKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsIA,0B,CACA;;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACAA,aADA;AAEAC,gBAFA;AAGAC,MAHA,kBAGA;AACA;AACAC,cADA;AAEAC,aAFA;AAGAC,cAHA;AAIAC,mBAJA;AAKAC,iBALA;AAMAC,oBANA;AAOAC,kBAPA;AAQAC,mBARA;AASAC,uBATA;AAUAC,cAVA;AAWAC,sBAXA;AAYAC,mBAZA;AAaAC,kBAbA;AAcAC,kBAdA;AAeAC,2CAfA;AAgBAC,0CAhBA;AAiBAC,0CAjBA;AAkBAC,YAlBA;AAmBAC,iBAnBA;AAoBAC,0CApBA;AAqBAC,cArBA;AAsBAC,iBAtBA;AAuBAC,gBAvBA;AAwBAC,aAxBA;AAyBAC,aAzBA;AA0BAzB,cA1BA;AA2BA0B,sBA3BA;AA4BAC,4BA5BA;AA6BAC;AA7BA;AA+BA,GAnCA;AAoCAC;AACAC,eADA,yBACA;AACA;AACA;AAHA,GApCA;AAyCAC;AAEAC,QAFA,kBAEA;AACA;AACA;AACAC;AACA,OAFA,MAEA;AACA;AACAnC,6BADA;AAEAM;AAFA,UADA,CAKA;;AACA8B;AACA;AACA;AACAD;AACA,WAFA,MAEA;AACAE;AACA;AACA;AAEAC;AACAH,oCALA,CAMA;AACA,aAPA;AAQA;AACA,SAdA;AAeA;AACA,KA5BA;AA6BAI,iBA7BA,yBA6BArC,IA7BA,EA6BA;AACA;AACA;AACA;AACA;AACA,KAlCA;AAmCAsC,cAnCA,sBAmCAC,GAnCA,EAmCAC,MAnCA,EAmCA;AAAA;;AACA;AACA;;AAFA,iCAIAC,CAJA;AAKA;AACAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACAO;AACA,qBAJA,CAKA;AACA;;;AANA,0BAOAD,mBAPA;AAAA;AAAA;AAAA;;AAQAE,uBARA,6HAQAD,MARA,SASA;;AATA;AAAA,2BAWAE;AACA;AACA;AACAC;;AACA;AACA;AACAA;AACA;;AACAA;AACAA;AACAA,oCATA,CAUA;;AAAA;AACA,wDAXA,CAYA;;AAAA;AACAD;AACA;AACAE,sDADA;AAEAC,2CAFA;AAGA3C;AAHA;AAKA4C;AACA;AACA;AACA;AACA;AACA;AACAf;;AAEA,4CARA,CASA;AACA;AACA;AACA;;AACA,2BAbA;AAcA,yBApBA;AAqBA,uBAlCA,MAkCA;AACA;AACA;AACAO;AADA;AAGAI,0DACAK,cADA,EAEAC,aAFA,EAGAC,IAHA,CAGA;AACAlB;;AAEA;AACA,yBAPA;AAQA;AACA,qBAjDA,CAXA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AANA;;AAIA;AAAA;AAiEA;AACA,KAzGA;AA0GAmB,oBA1GA,4BA0GApD,IA1GA,EA0GAwC,MA1GA,EA0GA;AAAA;;AACA;AACA;AACA;AAEA;AACAa,qBADA;AAEAC,6BAFA;AAGAlD,iBAHA;AAIAoC,sBAJA;AAKAe;AALA;;AAOA;AAEAP;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACA;AACAQ,0BAFA,GAEAP,WAFA;AAGAQ,2BAHA,GAGAC,wBAHA;AAIAC,6BAJA,GAIAD,0BAJA;;AAAA,6CAKAjB,CALA;AAMAmB;AACAC,iDADA;AAEAd,2CAFA;AAGAY,+CAHA;AAIAG;AAJA,uBANA;AAYAlB;AACA;AACA;;AAEAX;AACA;AACA,uBANA;AAZA;;AAKA;AAAA;AAcA;;AAnBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAsBA,OAxBA,MAwBA;AACAe;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AACAf;;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA,KArJA;AAsJA8B,gBAtJA,wBAsJAjE,IAtJA,EAsJA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAbA,CAcA;;AACAkE,YACAC,GADA,CACAC,2DADA,EAEAf,IAFA,CAEA;AACA;AACA;AACA,OALA,EAfA,CAqBA;AACA;;AACA;AACAgB;AADA;AAGAH,YACAI,IADA,CACAF,mDADA,EACAG,GADA,EAEAlB,IAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA,OARA,EA1BA,CAmCA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA,KA1OA;AA2OAmB,mBA3OA,2BA2OAtE,IA3OA,EA2OA;AACA;AACA;AACA;;AACA;AACA;AACAuE;AACA;AACA,OARA,CASA;AACA;AACA;AACA;;;AACA;AACA,KAzPA;AA0PAC,YA1PA,sBA0PA;AACAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,KA5PA;AA6PAS,aA7PA,uBA6PA;AAAA;;AACA;AACA;AACAvE,0BADA;AAEAgB;AAFA;AAIA8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA0B,sBAFA,GAEA,kDAFA,EAGA;;AACA;AACA;AACA;;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAQA,KA3QA;AA4QAC,UA5QA,oBA4QA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACAN,mBADA,GACA,EADA;AAAA;AAAA,uBAEA,iBAFA;;AAAA;AAGA;;AACA;AACApC;AACA,iBAFA,MAEA;AACAA;AACA,iBAFA,MAEA;AACAkC,yBADA,GACA,EADA;AAEAA,2DACA,gEADA,EAEA,EAFA;AAIAA,+CACA,gmBADA,EAEA,GAFA;AAKAA,+CACA,wBADA,EACA,GADA;AAGAA;AACAA;AACAA;AACAA;AACAA;AACAA;AACAA;AACAA;AACAA,2DAtBA,CAsBA;;AACAA,4KAvBA,CAyBA;AACA;;AACAS,2BA3BA,GA2BA;AACA1E,wCADA;AAEAgB;AAFA,mBA3BA;AA+BA8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAGAC,oBAHA;AAAA;AAAA;AAAA;;AAIA;AACAoB;AACAF;AADA;AALA;AAAA,qCAQAH,MACAI,IADA,CACAF,8CADA,EACAG,GADA,EAEAlB,IAFA;AAAA,oGAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA0B,6CAHA,GAGA;AACA3E,gEADA;AAEA4E,6DAFA;AAGAC,8EAHA;AAIA1B,0EAJA;AAKAjD;AALA,2CAHA,EAUA;;AAVA;AAAA,iDAWA4C,kDACA;AACA;AACA;AACAqB;AACAF;AADA,8CAHA,CAMA;;AAAA;AACAH,kDACAI,IADA,CACAF,6CADA,EACAG,GADA,EAEAlB,IAFA;AAAA,kHAEA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA,mFACA6B,CADA;AAEAC,2GACA,GADA,EAEA,EAFA,CAFA,EAKA;;AAAA;AACAA,qGACA,YADA,EAEA,aAFA,EANA,CAWA;;AAAA;AACAC;AACAC,oGADA;AAEAC,0GAFA;AAGArC,0FAHA;AAIAY,8FAJA;AAKA0B,oFALA;AAMA9C;AANA,6DAZA,EAoBA;;AAAA;AACA+C,6GACA;AACA;AACAtC,sGACA4B,SADA,EAEAzB,IAFA,CAEA;AACA,qGADA,CAEA;;AAAA;AACA;AACA,iEANA;AAOA;AACA,6DAXA;AArBA;;AACA;AAAA;AAiCA;AAEA,yDApCA,MAoCA;AACA;AACA,yDAxCA,CAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAhDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAFA;;AAAA;AAAA;AAAA;AAAA;AAoDA,2CA5DA,CAXA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAFA;;AAAA;AAAA;AAAA;AAAA,kCARA;;AAAA;AAAA;AAAA;;AAAA;AAqFA;AACA,yDAtFA,CAuFA;AACA;AACA;AACA;;;AA1FA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AA6FA;;AApIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqIA,KAjZA;AAkZAoC,UAlZA,kBAkZAC,GAlZA,EAkZAC,IAlZA,EAkZA;AACA;;AACA;AACA,yEACAC;AACA;;AACA;AACA,KAzZA;AA0ZAC,aA1ZA,qBA0ZA1F,IA1ZA,EA0ZA;AAAA;;AACA;AACA;AAAA,qCACA2F,CADA;AAEA;AACA;AACAC;AACA3E,oCADA;AAEAhB,kDAFA;AAGAmD;AAHA,aADA,EAMA;;AACAL;AACA;AACA,iEAFA,CAGA;;;AACA;AACA9B,sCADA;AAEA4D;AAFA;AAIA9B;AACA;AACA;AACA8C,iDADA;AAEAC,sDAFA;AAGAjD,uDAHA;AAIAkD;AAJA,kBAFA,CAQA;;AACAhD;AACA;AACA;AACA;AACA,iBAJA;AAKA,eAdA,EARA,CAuBA;AACA;AACA;AACA;AACA,aA3BA;AA4BA,WAtCA,CAwCA;;AAxCA;;AACA;AAAA,cAGA6C,GAHA;;AAAA;AAwCA;AAEA,OA3CA,MA2CA;AACA;AACA;AACA,KA1cA;AA2cAI,WA3cA,mBA2cAhG,IA3cA,EA2cA;AAAA;;AAAA,mCACAiG,CADA;AAEA;AACAnD,qDAHA,EAIA;AACA;;AACA;AACA;AACA;AACA,WAFA;AAGAoD;AACA;AACA,WAFA,CAJA,EAOA;AACA;AACA;AACA;;AACAC,uBACA,+DAZA,EAaA;;AACAnG;AACA,SAfA,MAeA;AACAA;AACA;;AACA;AACA;AACA;AACA;AA3BA;;AACA;AAAA,YAEA8C,OAFA;AAAA,YASAoD,aATA;AAAA,YAgBAC,UAhBA;;AAAA;AA2BA;AACA;AAxeA,GAzCA;AAmhBAC,SAnhBA,qBAmhBA,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9lBA","names":["name","components","data","list","url","file","status","urlPath","imagelists","tokenize","matchname","matchcategory","type","matchnamesum","statusname","statuscat","statusfda","colorname","colorfda","colorcat","id","keyword","colorkey","desc","arrList","alldata","back","next","product_token","title","key","computed","currentUser","methods","save","alert","KeywordService","DictService","document","getpercentage","savetorule","sen","answer","d","iddata","sql","RuleBasedService","text","rule_based_id","dict_id","MapRuleBasedService","res","updatemaprule","then","savetorule_based","keyword_id","advertise_id","user","map_id","sendata","JSON","dict_name","rule","map_rule_based_id","no","checkkeyword","axios","get","LinkService","content","post","con","finddescription","findfda","loaddict","getdetail","best","search","selectpro","des","sentence","sentence_keyword","r","sentencetoken","advertise","product_token_id","keyword_dict_id","sentent","AdvertiseService","getMax","arr","prop","max","tokendata","l","map","count_rulebased","sentence_rulebase","rule_based_name","compare","k","filteredArray","percentage","mounted"],"sourceRoot":"src/components","sources":["producttoken.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n   \n    <div class=\"row\">\n      <div>\n        <div class=\"form-group mt-5\">\n          <label for=\"exampleFormControlTextarea1\">URL</label>\n          <textarea\n            v-model=\"data.url\"\n            class=\"form-control\"\n            id=\"exampleFormControlTextarea1\"\n            rows=\"3\"\n          ></textarea>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"exampleFormControlTextarea1\">Content</label>\n          <textarea\n            v-model=\"data.content\"\n            class=\"form-control\"\n            id=\"exampleFormControlTextarea1\"\n            rows=\"7\"\n          ></textarea>\n        </div>\n        <button @click=\"search()\" type=\"submit\" class=\"mb-3 btn btn-success\">\n          \n        </button>\n      </div>\n      <table class=\"table table-bordered mt-3 mb-5\" v-if=\"status\">\n        <tbody>\n          <tr>\n            <th style=\"background-color: #ffb454\"></th>\n            <th style=\"background-color: #ffb454\"></th>\n          </tr>\n          <tr>\n            <td :style=\"colorkey\" style=\"width: 40%\">\n              <span v-html=\"list.sentence_keyword\"></span>\n            </td>\n            <!-- <th :style=\"colorkey\"></th> -->\n            <td :style=\"colorkey\" v-if=\"list.keyword != 0\">\n              <tr v-for=\"(k, i) in list.keyword\" :key=\"i\">\n                <td>\n                  <span v-html=\"k.sentence_rulebase\"></span><br><br>\n                  <span v-for=\"(s,idx) in k.rule_based_name\" :key=\"idx\">{{s}}</span>\n                  <br><br>\n<span v-if=\"k.count_rulebased\"> {{(getpercentage(k))}}%</span><br><br>\n<div style=\"text-align:left\"> <button\n          data-bs-toggle=\"modal\"\n          data-bs-target=\"#AddScopusToken\"\n           type=\"submit\" class=\"mb-3 btn btn-success\">\n      <i class=\"fa fa-plus\" aria-hidden=\"true\">  keyword</i>\n    </button></div>\n                </td>\n                <td>\n                  <span v-if=\"k.answer == 1\"></span\n                  ><span v-if=\"k.answer == 9\"></span\n                  ><span v-if=\"k.answer == 0\"></span>\n                </td>\n\n                <td>\n                  <button\n                    @click=\"savetorule_based(k, 1)\"\n                    type=\"submit\"\n                    class=\"mb-3 btn btn-success\"\n                  >\n                    <i class=\"fa fa-check\"></i></button\n                  >&nbsp;\n                  <button\n                    @click=\"savetorule_based(k, 9)\"\n                    type=\"submit\"\n                    class=\"mb-3 btn btn-danger\"\n                  >\n                    <i class=\"fa fa-times\"></i>\n                  </button>\n                </td>\n              </tr>\n            </td>\n            <td :style=\"colorkey\" v-else>\n              <tr>\n                \n              </tr>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n        <!-- Modal -->\n  <div\n      class=\"modal fade\"\n      id=\"AddScopusToken\"\n      tabindex=\"-1\"\n      aria-labelledby=\"exampleModalLabel\"\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">{{ title }}</h5>\n            \n          </div>\n          <div class=\"modal-body\">\n            <form>\n              <div class=\"card-body mt-3\">\n                <div class=\"form-group mt-3\">\n                  <label></label>\n                  <input\n                    v-model=\"key.name\"\n                    type=\"text\"\n                    min=\"1\"\n                    class=\"form-control form-control-sm\"\n                  />\n                </div>\n              </div>\n            </form>\n          </div>\n          <div class=\"modal-footer mt-3\">\n            <button type=\"button\" class=\"btn btn-success\" @click=\"save()\">\n              \n            </button>\n            <button\n            id=\"closedcategory\"\n              type=\"button\"\n              class=\"btn btn-secondary\"\n              data-bs-dismiss=\"modal\"\n            >\n              \n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n// import ProductsService from '../services/ProductsService.js'\nimport DictService from \"../services/DictService\";\nimport RuleBasedService from \"../services/RuleBasedService\";\nimport MapRuleBasedService from \"../services/MapRuleBasedService\";\nimport LinkService from \"../services/LinkService\";\nimport AdvertiseService from \"../services/AdvertiseService\";\nimport KeywordService from \"../services/KeywordService\";\n\nexport default {\n  name: \"App\",\n  components: {},\n  data() {\n    return {\n      list: [],\n      url: \"\",\n      file: \"\",\n      status: false,\n      urlPath: \"\",\n      imagelists: \"\",\n      tokenize: \"\",\n      matchname: \"\",\n      matchcategory: \"\",\n      type: \"\",\n      matchnamesum: \"\",\n      statusname: 0,\n      statuscat: 0,\n      statusfda: 0,\n      colorname: \"background-color:#f9bdbb\",\n      colorfda: \"background-color:#f9bdbb\",\n      colorcat: \"background-color:#f9bdbb\",\n      id: \"\",\n      keyword: [],\n      colorkey: \"background-color:#f9bdbb\",\n      desc: \"\",\n      arrList: [],\n      alldata: 0,\n      back: 0,\n      next: 0,\n      data: {},\n      product_token:0,\n      title:' keyword',\n      key:{}\n    };\n  },\n  computed: {\n    currentUser() {\n      return this.$store.state.auth.user;\n    },\n  },\n  methods: {\n\n    save() {\n      //console.log(this.key);\n      if (this.key.name == null || this.key.name == \"\") {\n        alert(\"\");\n      } else {\n        var prodata = {\n          name: this.key.name,\n          status:1,\n        };\n        //console.log(prodata); \n          KeywordService.createkeyword(prodata).then((res) => {\n            //console.log(res.data);\n            if (res.data.err == 1062) {\n              alert('')\n            }else{\n          DictService.createdict(prodata).then(() => {\n            //console.log(res.data );\n            // RuleBasedService.createdcolumnrule_based(res.data.id).then(() => {\n              \n            document.getElementById(\"closedcategory\").click();\n            alert('')\n          // })\n        })\n      }\n      })\n      }\n    },\n    getpercentage(data){\n// var dict = JSON.parse(data.dict_id)\n// var rule_based_id = JSON.parse(data.rule_based_id)\n// var re = (100 * data.count_rulebased)/ (rule_based_id.length)\nreturn data.count_rulebased\n    },\n    savetorule(sen, answer) {\n      // console.log(answer);\n      var iddata = [];\n\n      for (let d = 0; d < sen.length; d++) {\n        // console.log(datasplit[d]);\n        DictService.getdicts(\"\", sen[d]).then(async (res) => {\n          if (res.data.length > 0) {\n            // console.log(res.data[0].id);\n            iddata.push(res.data[0].id);\n          }\n          // console.log(d+1 , sen.length);\n          // console.log(iddata);\n          if (d + 1 == sen.length) {\n            var sql = `SELECT r.* FROM map_rule_based m join rule_based r on m.rule_based_id = r.id WHERE m.status = 1 and dict_id = '[${iddata}]'`;\n            // console.log(sql);\n\n            await RuleBasedService.getbydict(sql).then((res) => {\n              if (res.data.length == 0) {\n                let text = \"\";\n                text += \"{\";\n                for (let i = 0; i < iddata.length; i++) {\n                  // console.log(iddata[i]);\n                  text += '\"dict' + iddata[i] + '\"' + \":\" + 1 + \",\";\n                }\n                text += '\"answer' + '\"' + \":\" + answer + \",\";\n                text = text.slice(0, -1);\n                text += \"}\";\n                // console.log(text);\n                let jsonData = JSON.parse(text);\n                // console.log(jsonData);\n                RuleBasedService.createrule_based(jsonData).then((res) => {\n                  var maprule = {\n                    rule_based_id: res.data.id,\n                    dict_id: iddata,\n                    status: 1,\n                  };\n                  MapRuleBasedService.createmap_rule_based(maprule).then(() => {\n                    // console.log(res.data);\n                    // var pro = {\n                    //   map_rule_based:res.data.id\n                    // }\n                    // ProductsService.map_rule_based(id,pro).then(() => {\n                    alert(\"\");\n\n                    this.getdata();\n                    //               setTimeout(function () {\n                    //   location.reload();\n                    // }, 500);\n                    // });\n                  });\n                });\n              } else {\n                // console.log(res.data);\n                var updatemaprule = {\n                  answer: answer,\n                };\n                RuleBasedService.updaterule_based(\n                  res.data[0].id,\n                  updatemaprule\n                ).then(() => {\n                  alert(\"\");\n\n                  this.getdata();\n                });\n              }\n            });\n          }\n        });\n      }\n    },\n    savetorule_based(data, answer) {\n      // console.log(sen.length);\n      // console.log('answer',answer);\n      //console.log(data);\n\n      var maprule = {\n        keyword_id: 1,\n        advertise_id: data.id,\n        status: 1,\n        answer: answer,\n        user: this.currentUser.id,\n      };\n      if (!data.mapId) {\n        \n      MapRuleBasedService.createmap_rule_based(maprule).then(async (res) => {\n        // console.log(res.data);\n        var map_id = res.data.id;\n        var sendata = JSON.parse(data.dict_id);\n        var dict_name = JSON.parse(data.dict_name);\n        for (let d = 0; d < sendata.length; d++) {\n          var rule = {\n            map_rule_based_id: map_id,\n            dict_id: sendata[d],\n            dict_name: dict_name[d],\n            no: d + 1,\n          };\n          RuleBasedService.createrule_based(rule).then(() => {\n            if (d + 1 == sendata.length) {      \n               this.getdetail()\n\n              alert(\"\");\n            }\n          });\n        }\n      });\n\n      }else{\n      MapRuleBasedService.deletemap_rule_based(data.mapId,maprule).then(async () => {\n        // console.log(res.data);\n       this.getdetail()\n        alert(\"\");\n      });\n    }\n    },\n    checkkeyword(name) {\n      // console.log(name);\n      //   axios.get('http://localhost:8081/api/keyword_dicts?name=1').then((res) => {\n      //     console.log(res.data);\n      // for (let r = 0; r < res.data.length; r++) {\n      // name = name.replaceAll(/([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g, '')\n      //       name = name.replaceAll(/(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g, '');\n      //       name = name.replaceAll(/(\\r\\n|\\n|\\r)/gm, \"\");\n      //       name = name.replaceAll(\"_\", \"\");\n      //       name = name.replaceAll(\"!\", \"\");\n      //       name = name.replaceAll(\"*\", \"\");\n      // name = name.replaceAll(`_/l\\_`, \"\");// eslint-disable-line\n      // console.log('http://127.0.0.1:5000/checkkeyword?text=' + name);\n      var desc = this.finddescription(name);\n      // console.log('http://127.0.0.1:5000/worktokendesc?text='+desc);\n      axios\n        .get(LinkService.getpythonlink() + \"/worktokendesc?text=\" + desc)\n        .then((res) => {\n          // console.log(res.data);\n          this.desc = res.data;\n        });\n      // name = '  Shopee     Bluebird() Storage Condition Normal  ,     ,       12    /. 30-1-26764-5-0051  17901           1000  60    1  5   20   93   2  21   50   90   3  51   100   87   4  100  .....................  85  Vitamin C Plus Dietary Supplement Product Bluebird Brand      1   (Active Ingredient) VITAMIN C (100%) - 60  CITRUS BIOFLAVONOID POWDER - 630  BARBADOSCHERRY POWDER/ACEROLA CHERRY POWDER (/) (MALPIGHIA GLABRA L.)  - 60  ROSEHIP POWDER () (ROSA CANINA L.)  - 60  Rutin - 30  INDIAN GOOSEBERRY POWDER () (PHYLLANTHUS EMBLICA L. )  - 60   (Inactive Ingredient) EDIBLE GELATIN 428 - 98.5  TITANIUM DIOXIDE 171 -1.95    1-2    .. 30-1-26764-5-0051       5                    12.00         _/l\\_'\n      // console.log('http://127.0.0.1:5000/checkkeyword?text=' + desc);\n      var con = {\n        content: desc,\n      };\n      axios\n        .post(LinkService.getpythonlink() + \"/checkkeyword?text=\", con)\n        .then((res) => {\n          // console.log(res.data);\n          if (res.data.length > 0) {\n            // this.keyword.push(res.data)\n            this.keyword = res.data;\n          }\n        });\n      //     }\n\n      // });\n      //       var listkeywords = []\n      //       var namesplit = name.split(\" \")\n      //       // console.log(namesplit);\n      //       axios.get('http://localhost:8081/api/keyword_dicts?name=1').then((res) => {\n      //         console.log(res.data);\n      //         var keylist = []\n      //         for (let r = 0; r < res.data.length; r++) {\n      //           res.data[r].name = res.data[r].name.replaceAll(\".\",\"\")\n      //           var kk = res.data[r].name.split(\" \")\n      //           for (let k = 0; k < kk.length; k++) {\n      //             keylist.push(kk[k])\n      //           }\n      //         }\n      //         for (let key = 0; key < keylist.length; key++) {\n      //           for (let n = 0; n < namesplit.length; n++) {\n      //             if (namesplit[n] == keylist[key] && keylist[key] != '' && isNaN(keylist[key])) {\n      //               listkeywords.push(keylist[key])\n      //             }\n\n      //           }\n      //         }\n      //         // console.log(keylist);\n      //         // console.log(listkeywords);\n\n      //       console.log(listkeywords.length);\n      //         if (listkeywords.length == 0) {\n\n      //           this.colorkey = \"background-color:#a3e9a4\"\n      //         }\n      //         var result = [];\n      //         listkeywords.forEach(function(item) {\n      //      if(result.indexOf(item) < 0) {\n      //          result.push(item);\n      //      }\n      // });\n      // console.log(result);\n      // listkeywords = result\n      //         for (let l = 0; l < listkeywords.length; l++) {\n      //           // console.log('http://127.0.0.1:5000/checkkeyword?name=' + name+'&&name_real=');\n      //           axios.get('http://127.0.0.1:5000/checkkeyword?name=' + name+'&&name_real=' + listkeywords[l]).then((res) => {\n      //             // console.log(res.data);\n      //         this.keyword.push(res.data)\n      //       });\n\n      //         }\n      //       });\n    },\n    finddescription(data) {\n      // console.log(data);\n      var text = [\"\"];\n      var findfda = data;\n      for (let t = 0; t < text.length; t++) {\n        if (findfda.indexOf(text[t]) != -1) {\n          findfda = findfda.substring(findfda.indexOf(text[t]));\n        }\n      }\n      // if (findfda == '') {\n      //   findfda = findfda+ findfda+''\n      // }\n      // console.log(findfda);\n      return findfda;\n    },\n    loaddict() {\n      axios.get(LinkService.getpythonlink() + \"/loaddict\").then(async () => {});\n    },\n    getdetail(){\n      // var url = this.data.url.split(\"-i.\");\n      var selectpro = {\n          url: this.data.url,\n          id:this.currentUser.id\n        };\n        MapRuleBasedService.getproduct_token(selectpro).then(async (res) => {\n          //console.log(res.data);\n          var best = this.getMax(res.data.keyword,'count_rulebased')\n          //console.log(best);\n          this.list = res.data\n          this.list.keyword = [best]\n          this.status = true\n        })\n    },\n    async search() {\n      var con ={}\n      await this.loaddict();\n      this.status = false;\n      if (this.data.url == null || this.data.url == \"\") {\n        alert(\" URL\");\n      } else if (this.data.content == null || this.data.content == \"\") {\n        alert(\"\");\n      } else {\n        var content = \"\";\n        content = this.data.content.replaceAll(\n          /([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g,\n          \"\"\n        );\n        content = content.replaceAll(\n          /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g,\n          \" \"\n        );\n        \n        content = content.replaceAll(\n          /\\ud83d[\\ude00-\\ude4f]/g,\" \"\n        );\n        content = content.replaceAll(/(\\r\\n|\\n|\\r)/gm, ' ');\n        content = content.replaceAll(\"_\", \"\");\n        content = content.replaceAll(\"!\", \"\");\n        content = content.replaceAll(\"*\", \"\");\n        content = content.replaceAll(\"&\", \"\");\n        content = content.replaceAll(\"#\", \"\");\n        content = content.replaceAll(\"\", \"\");\n        content = content.replaceAll(\"+\", \"\");\n        content = content.replaceAll(`_/l\\_`, \"\"); // eslint-disable-line\n        content = content.replaceAll(/([\\u2700-\\u27BF]|[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2011-\\u26FF]|\\uD83E[\\uDD10-\\uDDFF])/g, ' ');\n\n        // var url = this.data.url.split(\"-i.\");\n        //  console.log(url);\n        var selectpro = {\n          url: this.data.url,\n          id:this.currentUser.id\n        };\n        MapRuleBasedService.getproduct_token(selectpro).then(async (res) => {\n          //console.log(res.data);\n          // console.log(content);\n          if (res.data.length == 0) {\n            // console.log(LinkService.getpythonlink()+'/worktokendesc?text=' + content);\n             con = {\n              content: content,\n            };\n            await axios\n              .post(LinkService.getpythonlink() + \"/wordtokendesc\", con)\n              .then(async (res) => {\n                //console.log(res.data);\n                // var sentence = res.data.sentent.replaceAll(\"<spanstyle\", \"<span style\");\n                var des = {\n                  url: this.data.url,\n                  sentence: content,\n                  sentence_keyword: res.data.sentent,\n                  keyword_id:res.data.keywordId,\n                  status: 1,\n                };\n                //console.log(des);\n                await MapRuleBasedService.createproduct_token(des).then(\n                   (producttoken) => {\n                    // console.log(producttoken);\n                    this.product_token = producttoken.data.id;\n                     con = {\n              content: content,\n            };\n            //console.log(con);\n                     axios\n                      .post(LinkService.getpythonlink() + \"/checkkeyword\", con)\n                      .then(async (res) => {\n                        //console.log(res.data);\n                        if (res.data.length > 0) {\n                        for (let r = 0; r < res.data.length; r++) {\n                          var sentencetoken = res.data[r].sentent.replaceAll(\n                            '\"',\n                            \"\"\n                          ); // eslint-disable-line\n                          sentencetoken = sentencetoken.replaceAll(\n                            \"<spanstyle\",\n                            \"<span style\"\n                          );\n\n                          // sentencetoken = sentencetoken.replaceAll('\"color:red\\\"','\"color:red\"')\n                          var advertise = {\n                            product_token_id: this.product_token,\n                            keyword_dict_id: res.data[r].keyword_dict_id,\n                            dict_id: res.data[r].dict_id,\n                            dict_name: res.data[r].dict_name,\n                            sentent: sentencetoken,\n                            sen: res.data[r].sen,\n                          };\n                          //console.log(this.product_token);\n                          AdvertiseService.createadvertise(advertise).then(\n                            () => {\n                              if (r + 1 == res.data.length) {\n                                MapRuleBasedService.getproductkeyword(\n                                  selectpro\n                                ).then((pro) => {\n                                  this.product_token = pro.data.id\n                                  // this.list = res.data\n                                  this.tokendata(pro.data);\n                                });\n                              }\n                            }\n                          );\n                        }\n                          \n                        }else{\n                        this.getdetail()\n                        }\n                        // if (keys.data.length > 0) {\n                        //   res.data[l].keyword = keys.data\n                        // } else {\n                        //   res.data[l].keyword = 0\n                        // }\n                        // if (l + 1 == res.data.length) {\n                        //   this.list = res.data\n                        // }\n                      });\n                  }\n                );\n              });\n          } else {\n            // this.getdetail()\n            this.tokendata(res.data)\n            // this.list = res.data\n            // this.product_token = res.data.id\n            // // console.log(this.list);\n            // this.status = true\n          }\n        });\n      }\n    },\n    getMax(arr, prop) {\n    var max;\n    for (var i=0 ; i< arr.length ; i++) {\n        if (max == null || parseInt(arr[i][prop]) > parseInt(max[prop]))\n            max = arr[i];\n    }\n    return max;\n},\n    tokendata(list) {\n      //console.log(list);\n      if (list.keyword.length > 0) {\n      for (let l = 0; l < list.keyword.length; l++) {\n        //console.log(list.keyword[l].keyword_dict_id);\n        if (list.keyword[l].keyword_dict_id) {\n          var map = {\n            id: list.keyword[l].id,\n            url: list.keyword[l].keyword_dict_id,\n            keyword_id:list.keyword[l].dict_id,\n          };\n          // console.log(map);\n          MapRuleBasedService.getmapproduct(map).then((res) => {\n            //console.log(res.data);\n            var bestdata = this.getMax(res.data,'allcount')\n            //console.log(bestdata);\n            var best = {\n            id: list.keyword[l].id,\n            sentence: bestdata,\n          };\n            MapRuleBasedService.getbestrulebased(best).then((res) => {\n              //console.log(res.data);\n              var rulebased = {\n            count_rulebased: res.data.count,\n            sentence_rulebase: res.data.sentence,\n            rule_based_id:res.data.rule_based_id,\n            rule_based_name:res.data.rule_based_name\n          };\n          // console.log(list.keyword[l].id);\n              MapRuleBasedService.updaterulebased(list.keyword[l].id,rulebased).then(() => {\n              if (l+1 == list.keyword.length) {\n                this.getdetail()\n              }\n              })\n            })\n            // list.keyword[l].rulebase = res.data;\n            // if (l + 1 == list.keyword.length) {\n            //   this.compare(list);\n            // }\n          });\n        }\n\n        // }\n      }\n        \n      }else{\n        this.getdetail()\n      }\n    },\n    compare(list) {\n      for (let k = 0; k < list.keyword.length; k++) {\n        // console.log(list.keyword[k]);\n        var dict_id = JSON.parse(list.keyword[k].dict_id);\n        // var rulebased = JSON.parse(list.keyword[k].rulebase)\n        // console.log(list.keyword[k].rulebased);\n        if (list.keyword[k].rulebase) {\n          let uniqueCharsrule = list.keyword[k].rulebase.filter((c, index) => {\n            return list.keyword[k].rulebase.indexOf(c) === index;\n          });\n          var filteredArray = dict_id.filter(function (n) {\n            return uniqueCharsrule.indexOf(n) !== -1;\n          });\n          // console.log(filteredArray);\n          // console.log('filteredArray',filteredArray);\n          // console.log('dict_id',dict_id.length);\n          // console.log(sumdictId.length);\n          var percentage =\n            (100 * parseInt(filteredArray.length)) / parseInt(dict_id.length);\n          // console.log(percentage);\n          list.keyword[k].percentage = percentage;\n        } else {\n          list.keyword[k].percentage = 0;\n        }\n        if (k + 1 == list.keyword.length) {\n          this.list = list;\n          this.status = true;\n        }\n      }\n    }\n  },\n  mounted() {\n    // this.data.url =\n    //   \"https://shopee.co.th/%E2%99%A6%EF%B8%8F%E0%B9%82%E0%B8%89%E0%B8%A1%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88-%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B9%81%E0%B8%97%E0%B9%89%E2%99%A6%EF%B8%8F-%E0%B8%82%E0%B8%B2%E0%B8%A2%E0%B8%94%E0%B8%B5%E0%B8%A1%E0%B8%B2%E0%B8%81-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F-%E0%B8%A5%E0%B8%B4%E0%B9%82%E0%B8%8B%E0%B9%88-%E0%B8%9E%E0%B8%A5%E0%B8%B1%E0%B8%AA-%E2%80%8B-coffee-lishou-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%84%E0%B8%A7%E0%B8%9A%E0%B8%84%E0%B8%B8%E0%B8%A1%E0%B8%99%E0%B9%89%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%81-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%84%E0%B8%B8%E0%B8%A1%E0%B8%AB%E0%B8%B4%E0%B8%A7-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%A5%E0%B8%94%E0%B8%99%E0%B9%89%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%81-%E0%B8%81%E0%B8%B2%E0%B9%81%E0%B8%9F%E0%B8%A5%E0%B8%94%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%AD%E0%B9%89%E0%B8%A7%E0%B8%99\";\n    // this.data.content =\n    //   \"   \";\n    // // var url = this.data.url.split('-i.')\n    // var content = this.data.content.replaceAll(\n    //   /([\\uE000-\\uF8FF]|\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDDFF])/g,\n    //   \"\"\n    // );\n    // content = content.replaceAll(\n    //   /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g,\n    //   \"\"\n    // );\n    // content = content.replaceAll(/(\\r\\n|\\n|\\r)/gm, \"\");\n    // content = content.replaceAll(\"_\", \"\");\n    // content = content.replaceAll(\"!\", \"\");\n    // content = content.replaceAll(\"*\", \"\");\n    // content = content.replaceAll(\"&\", \"\");\n    // content = content.replaceAll(\"#\", \"\");\n    // content = content.replaceAll(`_/l\\_`, \"\"); // eslint-disable-line\n    // // console.log(LinkService.getpythonlink()+'/wordtokendesc?text=' + content);\n    // // axios.get(LinkService.getpythonlink()+'/wordtokendesc?text='+content).then(async (res) => {\n    // //   console.log(res.data);\n    // // })\n    // console.log(LinkService.getpythonlink() + \"/checkkeyword?text=\" + content);\n    // var con = {\n    //   content: content,\n    // };\n    // axios\n    //   .post(LinkService.getpythonlink() + \"/checkkeyword?text=\" + content, con)\n    //   .then(async (res) => {\n    //     console.log(res.data);\n    //     //       for (let r = 0; r < res.data.length; r++) {\n    //     //         var advertise = {\n    //     //           product_token_id:1,\n    //     //           keyword_dict_id:res.data[r].keyword_dict_id,\n    //     //           dict_id:res.data[r].dict_id,\n    //     //           dict_name:res.data[r].dict_name,\n    //     //           sen:res.data[r].sen,\n    //     //           sentent:res.data[r].sentent,\n    //     //         }\n    //     //         AdvertiseService.createadvertise(advertise).then((res)=>{\n    //     //           console.log(res.data);\n    //     //         })\n    //     //       }\n    //   });\n    // //  console.log(url);\n    // //     var selectpro = {\n    // //       url:url[0]\n    // //      }\n    // //      MapRuleBasedService.getproduct_token(selectpro).then((res)=>{\n    // //       console.log(res.data);\n    // // var list = res.data\n    // // this.tokendata(list)\n    // // for (let l = 0; l < list.keyword.length; l++) {\n    // //   // console.log(this.list.keyword[l].map);\n    // //   // for (let m = 0; m < this.list.keyword[l].length; m++) {\n    // //     if (list.keyword[l].map) {\n    // //       var map = {\n    // //     url:JSON.stringify(list.keyword[l].map)\n    // //      }\n    // //     //  console.log(map);\n    // //      MapRuleBasedService.getmapproduct(map).then((res)=>{\n    // //       list.keyword[l].rulebase = res.data\n    // //       if (l+1 == list.keyword.length) {\n    // //         this.compare(list)\n    // //       }\n    // //      });\n    // //     }\n    // //   }\n    // // }\n    // // console.log(this.list);\n    // this.status = true;\n    // //  })\n  },\n};\n</script>\n\n<style>\nhtml,\nbody {\n  height: 100%;\n  margin: 0px;\n}\n</style>\n"]}]}